<!DOCTYPE html>
<html lang="en">

  <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="keywords" content="swift ios development apple watch iphone ipad swiftui macos uikit dev wwdc tutorial guide redux tea state container" />

  <!-- Begin Jekyll SEO tag v2.7.1 -->
<title>Styling custom SwiftUI views using environment | Code4You</title>
<meta name="generator" content="Jekyll v3.9.0" />
<meta property="og:title" content="Styling custom SwiftUI views using environment" />
<meta name="author" content="Code4You" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="One of my favorite features of SwiftUI is styling. I love the idea of style protocols provided by every view and sharing them using the environment. I have already covered most of the style protocols for SwiftUI provided views in my previous posts. But what about custom views? This week we will learn how to share styling using environment for our custom views." />
<meta property="og:description" content="One of my favorite features of SwiftUI is styling. I love the idea of style protocols provided by every view and sharing them using the environment. I have already covered most of the style protocols for SwiftUI provided views in my previous posts. But what about custom views? This week we will learn how to share styling using environment for our custom views." />
<link rel="canonical" href="http://localhost:4000/2020/12/09/styling-custom-swiftui-views-using-environment/" />
<meta property="og:url" content="http://localhost:4000/2020/12/09/styling-custom-swiftui-views-using-environment/" />
<meta property="og:site_name" content="Code4You" />
<meta property="og:image" content="http://localhost:4000/public/redacted.jpeg" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2020-12-09T00:00:00+08:00" />
<meta name="twitter:card" content="summary_large_image" />
<meta property="twitter:image" content="http://localhost:4000/public/redacted.jpeg" />
<meta property="twitter:title" content="Styling custom SwiftUI views using environment" />
<script type="application/ld+json">
{"@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/2020/12/09/styling-custom-swiftui-views-using-environment/"},"url":"http://localhost:4000/2020/12/09/styling-custom-swiftui-views-using-environment/","image":"http://localhost:4000/public/redacted.jpeg","author":{"@type":"Person","name":"Code4You"},"headline":"Styling custom SwiftUI views using environment","description":"One of my favorite features of SwiftUI is styling. I love the idea of style protocols provided by every view and sharing them using the environment. I have already covered most of the style protocols for SwiftUI provided views in my previous posts. But what about custom views? This week we will learn how to share styling using environment for our custom views.","dateModified":"2020-12-09T00:00:00+08:00","datePublished":"2020-12-09T00:00:00+08:00","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->


  <link rel="stylesheet" href="/styles.css">
  <link rel="shortcut icon" href="/public/favicon.ico">
  <link rel="alternate" type="application/atom+xml" title="Code4You" href="/feed.xml">
</head>


  <body>

    <div class="container content">
      <header class="masthead">
        <nav>
          <h1 class="masthead-title">
            <a href="/" title="Home">Code4You</a>
          </h1>
          <div>
            <a href="/categories" title="Categories">Categories</a>
            <a href="/archive" title="Archive">Archive</a>
            <a href="/feed.xml" title="Feed">Feed</a>
          </div>
        </nav>
      </header>

      <main>
        <article class="post">
  <h2 class="post-title">Styling custom SwiftUI views using environment</h2>
  <time datetime="2020-12-09T00:00:00+08:00" class="post-date">09 Dec 2020</time>
  <p>One of my favorite features of SwiftUI is styling. I love the idea of style protocols provided by every view and sharing them using the environment. I have already covered most of the style protocols for SwiftUI provided views in my previous posts. But what about custom views? This week we will learn how to share styling using environment for our custom views.</p>

<!-- <div class="ads">
    <span>
        Why don’t more iOS apps use voice? Machine learning for voice is hard, and using Siri is clunky and rigid. So we open-sourced an iOS library (also Android, Node, Python, & React Native), and built a no-code web tool to make custom wake words, speech recognizers, and AI voices—for all devs! <a href="https://www.spokestack.io/?utm_source=swiftui_weekly&utm_medium=email&utm_campaign=maker_launch_PAID">Try it for free.</a>
    </span>
</div> -->

<h4 id="basics">Basics</h4>
<p>If you are not familiar with style protocols in SwiftUI, let me show you a rapid example of using them.</p>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">struct</span> <span class="kt">MyApp</span><span class="p">:</span> <span class="kt">App</span> <span class="p">{</span>
    <span class="k">var</span> <span class="nv">body</span><span class="p">:</span> <span class="kd">some</span> <span class="kt">Scene</span> <span class="p">{</span>
        <span class="kt">WindowGroup</span> <span class="p">{</span>
            <span class="kt">RootView</span><span class="p">()</span>
                <span class="o">.</span><span class="nf">listStyle</span><span class="p">(</span><span class="kt">InsetGroupedListStyle</span><span class="p">())</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>In the example above, we attached the <em>listStyle</em> modifier to the root view of the app. This modifier shares the instance of <em>ListStyle</em> protocol with the whole app view hierarchy using the environment. All the app list instances will use <em>InsetGroupedListStyle</em> by default just because of this single line of code. But don’t worry. Any particular part of the view hierarchy can override this value with any other style when needed. Let’s take a look at another example.</p>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">struct</span> <span class="kt">FillButtonStyle</span><span class="p">:</span> <span class="kt">ButtonStyle</span> <span class="p">{</span>
    <span class="kd">func</span> <span class="nf">makeBody</span><span class="p">(</span><span class="nv">configuration</span><span class="p">:</span> <span class="kt">Configuration</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kd">some</span> <span class="kt">View</span> <span class="p">{</span>
        <span class="n">configuration</span><span class="o">.</span><span class="n">label</span>
            <span class="o">.</span><span class="nf">padding</span><span class="p">()</span>
            <span class="o">.</span><span class="nf">foregroundColor</span><span class="p">(</span><span class="o">.</span><span class="n">white</span><span class="p">)</span>
            <span class="o">.</span><span class="nf">background</span><span class="p">(</span><span class="kt">Color</span><span class="o">.</span><span class="n">accentColor</span><span class="p">)</span>
            <span class="o">.</span><span class="nf">clipShape</span><span class="p">(</span><span class="kt">RoundedRectangle</span><span class="p">(</span><span class="nv">cornerRadius</span><span class="p">:</span> <span class="mi">8</span><span class="p">,</span> <span class="nv">style</span><span class="p">:</span> <span class="o">.</span><span class="n">continuous</span><span class="p">))</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kd">struct</span> <span class="kt">MyApp</span><span class="p">:</span> <span class="kt">App</span> <span class="p">{</span>
    <span class="k">var</span> <span class="nv">body</span><span class="p">:</span> <span class="kd">some</span> <span class="kt">Scene</span> <span class="p">{</span>
        <span class="kt">WindowGroup</span> <span class="p">{</span>
            <span class="kt">RootView</span><span class="p">()</span>
                <span class="o">.</span><span class="nf">buttonStyle</span><span class="p">(</span><span class="kt">FillButtonStyle</span><span class="p">())</span>
                <span class="o">.</span><span class="nf">listStyle</span><span class="p">(</span><span class="kt">InsetGroupedListStyle</span><span class="p">())</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>As you can see here, we apply the unified button style for all the buttons in the app. All buttons will be filled with the accent color and will use the rounded rectangle’s shape.</p>

<blockquote>
  <p>To learn more about <em>ButtonStyle</em> protocol, look at my <a href="/2020/02/19/mastering-buttons-in-swiftui/">“Mastering buttons in SwiftUI”</a> post.</p>
</blockquote>

<h4 id="styling-using-view-parameters">Styling using view parameters</h4>
<p>Now we know how to use the style protocols that SwiftUI provides us, but what about our custom views? I maintain <a href="https://github.com/mecid/SwiftUICharts">a small charting library</a>. As you may know, charts can be highly flexible in terms of configuration. Let’s take a look at the usage example of my charting library.</p>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">let</span> <span class="nv">dataPoints</span><span class="p">:</span> <span class="p">[</span><span class="kt">DataPoint</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>

<span class="kt">BarChartView</span><span class="p">(</span>
    <span class="nv">dataPoints</span><span class="p">:</span> <span class="n">dataPoints</span><span class="p">,</span>
    <span class="nv">showLabels</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
    <span class="nv">labelCount</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
    <span class="nv">showLegends</span><span class="p">:</span> <span class="kc">true</span>
<span class="p">)</span>
</code></pre></div></div>

<p>As you can see, multiple parameters allow us to configure the chart presentation. There are actually many more parameters, but all of them have default values, and you don’t need to provide them here.</p>

<p>The first thing that I decide to do is extract the chart presentation parameters into a separated struct to keep them apart from chart data.</p>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">struct</span> <span class="kt">ChartStyle</span> <span class="p">{</span>
    <span class="k">let</span> <span class="nv">barMinHeight</span><span class="p">:</span> <span class="kt">CGFloat</span>
    <span class="k">let</span> <span class="nv">showAxis</span><span class="p">:</span> <span class="kt">Bool</span>
    <span class="k">let</span> <span class="nv">axisLeadingPadding</span><span class="p">:</span> <span class="kt">CGFloat</span>
    <span class="k">let</span> <span class="nv">showLabels</span><span class="p">:</span> <span class="kt">Bool</span>
    <span class="k">let</span> <span class="nv">labelCount</span><span class="p">:</span> <span class="kt">Int</span><span class="p">?</span>
    <span class="k">let</span> <span class="nv">showLegends</span><span class="p">:</span> <span class="kt">Bool</span>
    
    <span class="kd">public</span> <span class="nf">init</span><span class="p">(</span>
        <span class="nv">barMinHeight</span><span class="p">:</span> <span class="kt">CGFloat</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span>
        <span class="nv">showAxis</span><span class="p">:</span> <span class="kt">Bool</span> <span class="o">=</span> <span class="kc">true</span><span class="p">,</span>
        <span class="nv">axisLeadingPadding</span><span class="p">:</span> <span class="kt">CGFloat</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
        <span class="nv">showLabels</span><span class="p">:</span> <span class="kt">Bool</span> <span class="o">=</span> <span class="kc">true</span><span class="p">,</span>
        <span class="nv">labelCount</span><span class="p">:</span> <span class="kt">Int</span><span class="p">?</span> <span class="o">=</span> <span class="kc">nil</span><span class="p">,</span>
        <span class="nv">showLegends</span><span class="p">:</span> <span class="kt">Bool</span> <span class="o">=</span> <span class="kc">true</span>
    <span class="p">)</span> <span class="p">{</span>
        <span class="k">self</span><span class="o">.</span><span class="n">barMinHeight</span> <span class="o">=</span> <span class="n">barMinHeight</span>
        <span class="k">self</span><span class="o">.</span><span class="n">showAxis</span> <span class="o">=</span> <span class="n">showAxis</span>
        <span class="k">self</span><span class="o">.</span><span class="n">axisLeadingPadding</span> <span class="o">=</span> <span class="n">axisLeadingPadding</span>
        <span class="k">self</span><span class="o">.</span><span class="n">showLabels</span> <span class="o">=</span> <span class="n">showLabels</span>
        <span class="k">self</span><span class="o">.</span><span class="n">labelCount</span> <span class="o">=</span> <span class="n">labelCount</span>
        <span class="k">self</span><span class="o">.</span><span class="n">showLegends</span> <span class="o">=</span> <span class="n">showLegends</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>Let’s take a look at the usage example now.</p>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">let</span> <span class="nv">dataPoints</span><span class="p">:</span> <span class="p">[</span><span class="kt">DataPoint</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">let</span> <span class="nv">style</span> <span class="o">=</span> <span class="kt">ChartStyle</span><span class="p">(</span><span class="nv">showAxis</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span> <span class="nv">labelCount</span><span class="p">:</span> <span class="mi">3</span><span class="p">)</span>
<span class="kt">BarChartView</span><span class="p">(</span><span class="nv">dataPoints</span><span class="p">:</span> <span class="n">dataPoints</span><span class="p">,</span> <span class="nv">style</span><span class="p">:</span> <span class="n">style</span><span class="p">)</span>
</code></pre></div></div>

<h4 id="styling-using-environment">Styling using environment</h4>
<p>The previous example looks better than before, but it doesn’t give us all the benefits of environment sharing that standard SwiftUI views have. We can easily solve it by inserting an instance of style struct into the environment instead of passing it via initializer. Let’s take a look at how we can do that.</p>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">struct</span> <span class="kt">ChartStyleEnvironmentKey</span><span class="p">:</span> <span class="kt">EnvironmentKey</span> <span class="p">{</span>
    <span class="kd">static</span> <span class="k">var</span> <span class="nv">defaultValue</span><span class="p">:</span> <span class="kt">ChartStyle</span> <span class="o">=</span> <span class="o">.</span><span class="nf">init</span><span class="p">()</span>
<span class="p">}</span>

<span class="kd">extension</span> <span class="kt">EnvironmentValues</span> <span class="p">{</span>
    <span class="k">var</span> <span class="nv">chartStyle</span><span class="p">:</span> <span class="kt">ChartStyle</span> <span class="p">{</span>
        <span class="k">get</span> <span class="p">{</span> <span class="k">self</span><span class="p">[</span><span class="kt">ChartStyleEnvironmentKey</span><span class="o">.</span><span class="k">self</span><span class="p">]</span> <span class="p">}</span>
        <span class="k">set</span> <span class="p">{</span> <span class="k">self</span><span class="p">[</span><span class="kt">ChartStyleEnvironmentKey</span><span class="o">.</span><span class="k">self</span><span class="p">]</span> <span class="o">=</span> <span class="n">newValue</span> <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kd">extension</span> <span class="kt">View</span> <span class="p">{</span>
    <span class="kd">func</span> <span class="nf">chartStyle</span><span class="p">(</span><span class="n">_</span> <span class="nv">style</span><span class="p">:</span> <span class="kt">ChartStyle</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kd">some</span> <span class="kt">View</span> <span class="p">{</span>
        <span class="nf">environment</span><span class="p">(\</span><span class="o">.</span><span class="n">chartStyle</span><span class="p">,</span> <span class="n">style</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>First of all, we create an additional environment value that will hold the chart style. Then we create an extension on <em>View</em> protocol that allows us to insert chart styles into a view hierarchy environment.</p>

<blockquote>
  <p>To learn more about the possibilities of SwiftUI’s environment feature, take a look at my <a href="/2019/08/21/the-power-of-environment-in-swiftui/">“The power of Environment in SwiftUI”</a> post.</p>
</blockquote>

<p>We can use the environment property wrapper inside <em>BarChartView</em> to obtain the style that the environment shares.</p>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">struct</span> <span class="kt">BarChartView</span><span class="p">:</span> <span class="kt">View</span> <span class="p">{</span>
    <span class="kd">@Environment</span><span class="p">(\</span><span class="o">.</span><span class="n">chartStyle</span><span class="p">)</span> <span class="k">var</span> <span class="nv">chartStyle</span>
    <span class="k">let</span> <span class="nv">dataPoints</span><span class="p">:</span> <span class="p">[</span><span class="kt">DataPoint</span><span class="p">]</span>
    
    <span class="k">var</span> <span class="nv">body</span><span class="p">:</span> <span class="kd">some</span> <span class="kt">View</span> <span class="p">{</span>
        <span class="c1">// draw bars</span>
        <span class="k">if</span> <span class="n">chartStyle</span><span class="o">.</span><span class="n">showLabels</span> <span class="p">{</span>
            <span class="c1">// show labels</span>
        <span class="p">}</span>

        <span class="k">if</span> <span class="n">chartStyle</span><span class="o">.</span><span class="n">showLegends</span> <span class="p">{</span>
            <span class="c1">// show legend</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="k">let</span> <span class="nv">dataPoints1</span><span class="p">:</span> <span class="p">[</span><span class="kt">DataPoint</span><span class="p">]</span> <span class="o">=</span> <span class="c1">// ...</span>
<span class="k">let</span> <span class="nv">dataPoints2</span><span class="p">:</span> <span class="p">[</span><span class="kt">DataPoint</span><span class="p">]</span> <span class="o">=</span> <span class="c1">// ...</span>

<span class="kt">HStack</span> <span class="p">{</span>
    <span class="kt">BarChartView</span><span class="p">(</span><span class="nv">dataPoints</span><span class="p">:</span> <span class="n">dataPoints1</span><span class="p">)</span>
    <span class="kt">BarChartView</span><span class="p">(</span><span class="nv">dataPoints</span><span class="p">:</span> <span class="n">dataPoints2</span><span class="p">)</span>
<span class="p">}</span><span class="o">.</span><span class="nf">chartStyle</span><span class="p">(</span><span class="kt">ChartStyle</span><span class="p">(</span><span class="nv">showAxis</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span> <span class="nv">labelCount</span><span class="p">:</span> <span class="mi">3</span><span class="p">))</span>
</code></pre></div></div>

<p><img src="/public/redacted.jpeg" alt="charts" /></p>

<h4 id="conclusion">Conclusion</h4>
<p>I really love this approach because it easily allows us to style the whole app hierarchy. For example, I have a screen that displays a list of charts with different data points. All of these charts have the same styling, which I insert into the environment of its parent view using a single line of code.</p>

<p>I hope you enjoy the post. Feel free to follow me on <a href="https://twitter.com/mecid">Twitter</a> and ask your questions related to this article. Thanks for reading, and see you next week!</p>

</article>


<aside class="related">
  <h4>Recent posts</h4>
  <ul class="related-posts">
    
      <li>
        <a title="Custom accessibility content in SwiftUI" href="/2021/10/06/custom-accessibility-content-in-swiftui/">
          Custom accessibility content in SwiftUI
          <small><time datetime="2021-10-06T00:00:00+08:00">06 Oct 2021</time></small>
        </a>
      </li>
    
      <li>
        <a title="Audio graphs in SwiftUI" href="/2021/09/29/audio-graphs-in-swiftui/">
          Audio graphs in SwiftUI
          <small><time datetime="2021-09-29T00:00:00+08:00">29 Sep 2021</time></small>
        </a>
      </li>
    
      <li>
        <a title="Accessibility focus in SwiftUI" href="/2021/09/23/accessibility-focus-in-swiftui/">
          Accessibility focus in SwiftUI
          <small><time datetime="2021-09-23T00:00:00+08:00">23 Sep 2021</time></small>
        </a>
      </li>
    
  </ul>
</aside>


      </main>

      <footer class="footer">
          <img class="avatar" alt="mecid" width="100" height="100" data-proofer-ignore="true" src="https://avatars2.githubusercontent.com/mecid?v=3&s=100" srcset="https://avatars2.githubusercontent.com/mecid?v=3&s=100 1x, https://avatars2.githubusercontent.com/mecid?v=3&s=200 2x, https://avatars2.githubusercontent.com/mecid?v=3&s=300 3x, https://avatars2.githubusercontent.com/mecid?v=3&s=400 4x" />
          <small>Hi there! I am code4you,I like to program, and do some App.</small>
          <small>I'm a developer</small>
          <small>Feel free to follow me on <a href="https://github.com/code4you2021">Github</a>.</small>
        <small>
          &copy; <time datetime="2021-10-17T11:25:11+08:00">2021</time>. All rights reserved.
        </small>
      </footer>
    </div>

    
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-1WQVZK1CR7"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-18491817-18');
    </script>
    
  </body>
</html>
