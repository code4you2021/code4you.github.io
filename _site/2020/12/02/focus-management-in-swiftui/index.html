<!DOCTYPE html>
<html lang="en">

  <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="keywords" content="swift ios development apple watch iphone ipad swiftui macos uikit dev wwdc tutorial guide redux tea state container" />

  <!-- Begin Jekyll SEO tag v2.7.1 -->
<title>Focus management in SwiftUI | Code4You</title>
<meta name="generator" content="Jekyll v3.9.0" />
<meta property="og:title" content="Focus management in SwiftUI" />
<meta name="author" content="Code4You" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="WWDC 20 brings us tons of new SwiftUI APIs, which we can use to improve our apps user experience without using UIKit. One of these new APIs was the focus management API that we can use on iOS, macOS, tvOS, and watchOS. This week we will talk about SwiftUI functionality that allows us to manage the focus in our apps." />
<meta property="og:description" content="WWDC 20 brings us tons of new SwiftUI APIs, which we can use to improve our apps user experience without using UIKit. One of these new APIs was the focus management API that we can use on iOS, macOS, tvOS, and watchOS. This week we will talk about SwiftUI functionality that allows us to manage the focus in our apps." />
<link rel="canonical" href="http://localhost:4000/2020/12/02/focus-management-in-swiftui/" />
<meta property="og:url" content="http://localhost:4000/2020/12/02/focus-management-in-swiftui/" />
<meta property="og:site_name" content="Code4You" />
<meta property="og:image" content="http://localhost:4000/public/tabs.png" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2020-12-02T00:00:00+08:00" />
<meta name="twitter:card" content="summary_large_image" />
<meta property="twitter:image" content="http://localhost:4000/public/tabs.png" />
<meta property="twitter:title" content="Focus management in SwiftUI" />
<script type="application/ld+json">
{"@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/2020/12/02/focus-management-in-swiftui/"},"url":"http://localhost:4000/2020/12/02/focus-management-in-swiftui/","image":"http://localhost:4000/public/tabs.png","author":{"@type":"Person","name":"Code4You"},"headline":"Focus management in SwiftUI","description":"WWDC 20 brings us tons of new SwiftUI APIs, which we can use to improve our apps user experience without using UIKit. One of these new APIs was the focus management API that we can use on iOS, macOS, tvOS, and watchOS. This week we will talk about SwiftUI functionality that allows us to manage the focus in our apps.","dateModified":"2020-12-02T00:00:00+08:00","datePublished":"2020-12-02T00:00:00+08:00","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->


  <link rel="stylesheet" href="/styles.css">
  <link rel="shortcut icon" href="/public/favicon.ico">
  <link rel="alternate" type="application/atom+xml" title="Code4You" href="/feed.xml">
</head>


  <body>

    <div class="container content">
      <header class="masthead">
        <nav>
          <h1 class="masthead-title">
            <a href="/" title="Home">Code4You</a>
          </h1>
          <div>
            <a href="/categories" title="Categories">Categories</a>
            <a href="/archive" title="Archive">Archive</a>
            <a href="/feed.xml" title="Feed">Feed</a>
          </div>
        </nav>
      </header>

      <main>
        <article class="post">
  <h2 class="post-title">Focus management in SwiftUI</h2>
  <time datetime="2020-12-02T00:00:00+08:00" class="post-date">02 Dec 2020</time>
  <p>WWDC 20 brings us tons of new SwiftUI APIs, which we can use to improve our apps user experience without using UIKit. One of these new APIs was the focus management API that we can use on iOS, macOS, tvOS, and watchOS. This week we will talk about SwiftUI functionality that allows us to manage the focus in our apps.</p>

<!-- <div class="ads">
    <span>
        Why don’t more iOS apps use voice? Machine learning for voice is hard, and using Siri is clunky and rigid. So we open-sourced an iOS library (also Android, Node, Python, & React Native), and built a no-code web tool to make custom wake words, speech recognizers, and AI voices—for all devs! <a href="https://www.spokestack.io/?utm_source=swiftui_weekly&utm_medium=email&utm_campaign=maker_launch_PAID">Try it for free.</a>
    </span>
</div> -->

<h4 id="basics">Basics</h4>
<p>Focus indicates the act of selecting an element of a graphical user interface. On Apple TV, people use the remote to interact indirectly with onscreen elements. This interaction is based on a focus model. By pressing buttons and using gestures on the remote, people move the focus from element to element, stop on a specific one, and click to access content or initiate action.</p>

<p>You can easily make any view focusable by using the <em>focusable</em> modifier. Remember that you don’t need to use it with already focusable views like <em>List</em> and <em>Button</em>. Let’s take a look at how we can use this modifier in code.</p>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">struct</span> <span class="kt">Poster</span><span class="p">:</span> <span class="kt">View</span> <span class="p">{</span>
    <span class="kd">@State</span> <span class="kd">private</span> <span class="k">var</span> <span class="nv">isFocused</span> <span class="o">=</span> <span class="kc">false</span>

    <span class="k">var</span> <span class="nv">body</span><span class="p">:</span> <span class="kd">some</span> <span class="kt">View</span> <span class="p">{</span>
        <span class="kt">RoundedRectangle</span><span class="p">(</span><span class="nv">cornerRadius</span><span class="p">:</span> <span class="mi">8</span><span class="p">)</span>
            <span class="o">.</span><span class="nf">frame</span><span class="p">(</span><span class="nv">width</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span> <span class="nv">height</span><span class="p">:</span> <span class="mi">150</span><span class="p">)</span>
            <span class="o">.</span><span class="nf">scaleEffect</span><span class="p">(</span><span class="n">isFocused</span> <span class="p">?</span> <span class="mf">1.2</span> <span class="p">:</span> <span class="mi">1</span><span class="p">)</span>
            <span class="o">.</span><span class="nf">focusable</span><span class="p">(</span><span class="kc">true</span><span class="p">)</span> <span class="p">{</span> <span class="n">newState</span> <span class="k">in</span> <span class="n">isFocused</span> <span class="o">=</span> <span class="n">newState</span> <span class="p">}</span>
            <span class="o">.</span><span class="nf">animation</span><span class="p">(</span><span class="o">.</span><span class="n">easeInOut</span><span class="p">,</span> <span class="nv">value</span><span class="p">:</span> <span class="n">isFocused</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kd">struct</span> <span class="kt">ContentView</span><span class="p">:</span> <span class="kt">View</span> <span class="p">{</span>
    <span class="k">var</span> <span class="nv">body</span><span class="p">:</span> <span class="kd">some</span> <span class="kt">View</span> <span class="p">{</span>
        <span class="kt">ScrollView</span><span class="p">(</span><span class="o">.</span><span class="n">horizontal</span><span class="p">)</span> <span class="p">{</span>
            <span class="kt">LazyHStack</span> <span class="p">{</span>
                <span class="kt">ForEach</span><span class="p">(</span><span class="mi">0</span><span class="o">..&lt;</span><span class="mi">100</span><span class="p">)</span> <span class="p">{</span> <span class="n">index</span> <span class="k">in</span>
                    <span class="kt">Poster</span><span class="p">()</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>As you can see in the example above, we use the <em>focusable</em> modifier to enable focusing abilities on <em>RoundedRectangle</em>. We also scale our rectangle whenever the user focuses on it. <em>Focusable</em> modifier accepts two parameters. The first one is the bool value that indicates whenever the view is focusable or not. The second one is the closure that SwiftUI runs whenever the focus state of the view changes. This modifier is available on all platforms except iOS.</p>

<p>Another thing that SwiftUI provides us to handle the focused state in our views is environment value, which allows us to recognize if the view’s nearest focusable ancestor has focus.</p>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">struct</span> <span class="kt">Poster</span><span class="p">:</span> <span class="kt">View</span> <span class="p">{</span>
    <span class="kd">@Environment</span><span class="p">(\</span><span class="o">.</span><span class="n">isFocused</span><span class="p">)</span> <span class="k">var</span> <span class="nv">isFocused</span>

    <span class="k">var</span> <span class="nv">body</span><span class="p">:</span> <span class="kd">some</span> <span class="kt">View</span> <span class="p">{</span>
        <span class="kt">RoundedRectangle</span><span class="p">(</span><span class="nv">cornerRadius</span><span class="p">:</span> <span class="mi">8</span><span class="p">)</span>
            <span class="o">.</span><span class="nf">frame</span><span class="p">(</span><span class="nv">width</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span> <span class="nv">height</span><span class="p">:</span> <span class="mi">150</span><span class="p">)</span>
            <span class="o">.</span><span class="nf">scaleEffect</span><span class="p">(</span><span class="n">isFocused</span> <span class="p">?</span> <span class="mf">1.2</span> <span class="p">:</span> <span class="mi">1</span><span class="p">)</span>
            <span class="o">.</span><span class="nf">animation</span><span class="p">(</span><span class="o">.</span><span class="n">easeInOut</span><span class="p">,</span> <span class="nv">value</span><span class="p">:</span> <span class="n">isFocused</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kd">struct</span> <span class="kt">ContentView</span><span class="p">:</span> <span class="kt">View</span> <span class="p">{</span>
    <span class="k">var</span> <span class="nv">body</span><span class="p">:</span> <span class="kd">some</span> <span class="kt">View</span> <span class="p">{</span>
        <span class="kt">ScrollView</span><span class="p">(</span><span class="o">.</span><span class="n">horizontal</span><span class="p">)</span> <span class="p">{</span>
            <span class="kt">LazyHStack</span> <span class="p">{</span>
                <span class="kt">ForEach</span><span class="p">(</span><span class="mi">0</span><span class="o">..&lt;</span><span class="mi">100</span><span class="p">)</span> <span class="p">{</span> <span class="n">index</span> <span class="k">in</span>
                    <span class="kt">ZStack</span> <span class="p">{</span>
                        <span class="kt">Poster</span><span class="p">()</span>
                    <span class="p">}</span><span class="o">.</span><span class="nf">focusable</span><span class="p">()</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>In this example, we use the <em>isFocused</em> environment value to understand whenever our parent <em>ZStack</em> is focused. The view itself doesn’t have to be focusable because this environment value checks if the view is within the focused view.</p>

<blockquote>
  <p>SwiftUI uses environment to pass system-wide and application-related information. To learn more about environment, take a look at my <a href="/2019/08/21/the-power-of-environment-in-swiftui/">“The power of Environment in SwiftUI”</a> post.</p>
</blockquote>

<h4 id="focus-on-watchos-and-tvos">Focus on watchOS and tvOS</h4>
<p>We already talked about the APIs available on most Apple platforms, but there is much more new stuff. There is a bunch of new APIs that we can use only on watchOS and tvOS. For example, we can define focus entry points for our views on watchOS and tvOS. Assume that you are working on the login screen. You want to focus on text fields as soon as the view appears. Let’s take a look at how we can achieve this behavior with SwiftUI.</p>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="kd">struct</span> <span class="kt">LoginView</span><span class="p">:</span> <span class="kt">View</span> <span class="p">{</span>
    <span class="kd">@State</span> <span class="kd">private</span> <span class="k">var</span> <span class="nv">email</span> <span class="o">=</span> <span class="s">""</span>
    <span class="kd">@State</span> <span class="kd">private</span> <span class="k">var</span> <span class="nv">password</span> <span class="o">=</span> <span class="s">""</span>

    <span class="kd">@State</span> <span class="kd">private</span> <span class="k">var</span> <span class="nv">hasFilledCredentials</span> <span class="o">=</span> <span class="kc">false</span>
    <span class="kd">@Namespace</span> <span class="kd">private</span> <span class="k">var</span> <span class="nv">namespace</span>

    <span class="kd">@Environment</span><span class="p">(\</span><span class="o">.</span><span class="n">resetFocus</span><span class="p">)</span> <span class="k">var</span> <span class="nv">resetFocus</span>

    <span class="k">var</span> <span class="nv">body</span><span class="p">:</span> <span class="kd">some</span> <span class="kt">View</span> <span class="p">{</span>
        <span class="kt">VStack</span> <span class="p">{</span>
            <span class="kt">TextField</span><span class="p">(</span><span class="s">"email"</span><span class="p">,</span> <span class="nv">text</span><span class="p">:</span> <span class="err">$</span><span class="n">email</span><span class="p">)</span>
                <span class="o">.</span><span class="nf">prefersDefaultFocus</span><span class="p">(</span><span class="o">!</span><span class="n">hasFilledCredentials</span><span class="p">,</span> <span class="nv">in</span><span class="p">:</span> <span class="n">namespace</span><span class="p">)</span>

            <span class="kt">SecureField</span><span class="p">(</span><span class="s">"password"</span><span class="p">,</span> <span class="nv">text</span><span class="p">:</span> <span class="err">$</span><span class="n">password</span><span class="p">)</span>

            <span class="kt">Button</span><span class="p">(</span><span class="s">"login"</span><span class="p">)</span> <span class="p">{}</span>
                <span class="o">.</span><span class="nf">prefersDefaultFocus</span><span class="p">(</span><span class="n">hasFilledCredentials</span><span class="p">,</span> <span class="nv">in</span><span class="p">:</span> <span class="n">namespace</span><span class="p">)</span>

            <span class="kt">Button</span><span class="p">(</span><span class="s">"reset credentials"</span><span class="p">)</span> <span class="p">{</span>
                <span class="n">hasFilledCredentials</span> <span class="o">=</span> <span class="kc">false</span>
                <span class="nf">resetFocus</span><span class="p">(</span><span class="nv">in</span><span class="p">:</span> <span class="n">namespace</span><span class="p">)</span>
            <span class="p">}</span>
        <span class="p">}</span><span class="o">.</span><span class="nf">focusScope</span><span class="p">(</span><span class="n">namespace</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>As you can see, SwiftUI provides us a special <em>prefersDefaultFocus</em> modifier that allows us to define a preferred focus area in our view. Let’s take a deeper look at how this modifier works. It accepts two parameters. The first one is bool value describing whenever this view should be preferred as the default focus area. The second one is the <em>namespace</em>, defined by its ancestor view and indicates the focus scope. Default focus preference is limited to its <em>namespace</em>. It allows you to define multiple scopes and define different focus entry points in a single view hierarchy.</p>

<blockquote>
  <p>To learn more about new property wrappers, take a look at my <a href="/2020/06/29/new-property-wrappers-in-swiftui/">“New property wrappers in SwiftUI”</a> post.</p>
</blockquote>

<p>There is also the <em>resetFocus</em> environment action, which we can use to reset a focus to its preferred default position when needed.</p>

<h4 id="conclusion">Conclusion</h4>
<p>I really like how Apple transforms imperative UIKit APIs into the declarative world of SwiftUI. I am still not sure why Apple doesn’t make all of these new APIs available for all platforms, but I believe we will see them on iOS also. I hope you enjoy the post. Feel free to follow me on <a href="https://twitter.com/mecid">Twitter</a> and ask your questions related to this article. Thanks for reading, and see you next week!</p>

</article>


<aside class="related">
  <h4>Recent posts</h4>
  <ul class="related-posts">
    
      <li>
        <a title="Custom accessibility content in SwiftUI" href="/2021/10/06/custom-accessibility-content-in-swiftui/">
          Custom accessibility content in SwiftUI
          <small><time datetime="2021-10-06T00:00:00+08:00">06 Oct 2021</time></small>
        </a>
      </li>
    
      <li>
        <a title="Audio graphs in SwiftUI" href="/2021/09/29/audio-graphs-in-swiftui/">
          Audio graphs in SwiftUI
          <small><time datetime="2021-09-29T00:00:00+08:00">29 Sep 2021</time></small>
        </a>
      </li>
    
      <li>
        <a title="Accessibility focus in SwiftUI" href="/2021/09/23/accessibility-focus-in-swiftui/">
          Accessibility focus in SwiftUI
          <small><time datetime="2021-09-23T00:00:00+08:00">23 Sep 2021</time></small>
        </a>
      </li>
    
  </ul>
</aside>


      </main>

      <footer class="footer">
          <img class="avatar" alt="mecid" width="100" height="100" data-proofer-ignore="true" src="https://avatars2.githubusercontent.com/mecid?v=3&s=100" srcset="https://avatars2.githubusercontent.com/mecid?v=3&s=100 1x, https://avatars2.githubusercontent.com/mecid?v=3&s=200 2x, https://avatars2.githubusercontent.com/mecid?v=3&s=300 3x, https://avatars2.githubusercontent.com/mecid?v=3&s=400 4x" />
          <small>Hi there! I am code4you,I like to program, and do some App.</small>
          <small>I'm a developer</small>
          <small>Feel free to follow me on <a href="https://github.com/code4you2021">Github</a>.</small>
        <small>
          &copy; <time datetime="2021-10-17T11:25:11+08:00">2021</time>. All rights reserved.
        </small>
      </footer>
    </div>

    
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-1WQVZK1CR7"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-18491817-18');
    </script>
    
  </body>
</html>
