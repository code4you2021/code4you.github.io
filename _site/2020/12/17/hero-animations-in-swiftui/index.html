<!DOCTYPE html>
<html lang="en">

  <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="keywords" content="swift ios development apple watch iphone ipad swiftui macos uikit dev wwdc tutorial guide redux tea state container" />

  <!-- Begin Jekyll SEO tag v2.7.1 -->
<title>Hero animations in SwiftUI | Code4You</title>
<meta name="generator" content="Jekyll v3.9.0" />
<meta property="og:title" content="Hero animations in SwiftUI" />
<meta name="author" content="Code4You" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Animation is one of the powerful features of SwiftUI. I was shocked when I saw how easy we could animate changes in view hierarchy by simply mutating @State properties and attaching animation modifiers. This week we will talk about another animation type called hero animation. We will learn how we can implement hero animations using the new matchedGeometryEffect view modifier." />
<meta property="og:description" content="Animation is one of the powerful features of SwiftUI. I was shocked when I saw how easy we could animate changes in view hierarchy by simply mutating @State properties and attaching animation modifiers. This week we will talk about another animation type called hero animation. We will learn how we can implement hero animations using the new matchedGeometryEffect view modifier." />
<link rel="canonical" href="http://localhost:4000/2020/12/17/hero-animations-in-swiftui/" />
<meta property="og:url" content="http://localhost:4000/2020/12/17/hero-animations-in-swiftui/" />
<meta property="og:site_name" content="Code4You" />
<meta property="og:image" content="http://localhost:4000/public/swiftui.png" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2020-12-17T00:00:00+08:00" />
<meta name="twitter:card" content="summary_large_image" />
<meta property="twitter:image" content="http://localhost:4000/public/swiftui.png" />
<meta property="twitter:title" content="Hero animations in SwiftUI" />
<script type="application/ld+json">
{"@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/2020/12/17/hero-animations-in-swiftui/"},"url":"http://localhost:4000/2020/12/17/hero-animations-in-swiftui/","image":"http://localhost:4000/public/swiftui.png","author":{"@type":"Person","name":"Code4You"},"headline":"Hero animations in SwiftUI","description":"Animation is one of the powerful features of SwiftUI. I was shocked when I saw how easy we could animate changes in view hierarchy by simply mutating @State properties and attaching animation modifiers. This week we will talk about another animation type called hero animation. We will learn how we can implement hero animations using the new matchedGeometryEffect view modifier.","dateModified":"2020-12-17T00:00:00+08:00","datePublished":"2020-12-17T00:00:00+08:00","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->


  <link rel="stylesheet" href="/styles.css">
  <link rel="shortcut icon" href="/public/favicon.ico">
  <link rel="alternate" type="application/atom+xml" title="Code4You" href="/feed.xml">
</head>


  <body>

    <div class="container content">
      <header class="masthead">
        <nav>
          <h1 class="masthead-title">
            <a href="/" title="Home">Code4You</a>
          </h1>
          <div>
            <a href="/categories" title="Categories">Categories</a>
            <a href="/archive" title="Archive">Archive</a>
            <a href="/feed.xml" title="Feed">Feed</a>
          </div>
        </nav>
      </header>

      <main>
        <article class="post">
  <h2 class="post-title">Hero animations in SwiftUI</h2>
  <time datetime="2020-12-17T00:00:00+08:00" class="post-date">17 Dec 2020</time>
  <p>Animation is one of the powerful features of SwiftUI. I was shocked when I saw how easy we could animate changes in view hierarchy by simply mutating <em>@State</em> properties and attaching animation modifiers. This week we will talk about another animation type called hero animation. We will learn how we can implement hero animations using the new <em>matchedGeometryEffect</em> view modifier.</p>

<!-- <div class="ads">
    <span>
        Why don’t more iOS apps use voice? Machine learning for voice is hard, and using Siri is clunky and rigid. So we open-sourced an iOS library (also Android, Node, Python, & React Native), and built a no-code web tool to make custom wake words, speech recognizers, and AI voices—for all devs! <a href="https://www.spokestack.io/?utm_source=swiftui_weekly&utm_medium=email&utm_campaign=maker_launch_PAID">Try it for free.</a>
    </span>
</div> -->

<p>Assume that we are working on an app that shows a grid of images. You can select an image by tapping on it. On the bottom of the screen, we have another grid that shows only selected images. Let’s start implementing this app example.</p>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">import</span> <span class="kt">SwiftUI</span>

<span class="kd">struct</span> <span class="kt">ContentView</span><span class="p">:</span> <span class="kt">View</span> <span class="p">{</span>
    <span class="kd">@State</span> <span class="kd">private</span> <span class="k">var</span> <span class="nv">allImages</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s">"heart.fill"</span><span class="p">,</span>
        <span class="s">"bandage.fill"</span><span class="p">,</span>
        <span class="s">"cross.fill"</span><span class="p">,</span>
        <span class="s">"bed.double.fill"</span><span class="p">,</span>
        <span class="s">"cross.case.fill"</span><span class="p">,</span>
        <span class="s">"pills.fill"</span>
    <span class="p">]</span>
    
    <span class="kd">@State</span> <span class="kd">private</span> <span class="k">var</span> <span class="nv">selectedImages</span><span class="p">:</span> <span class="p">[</span><span class="kt">String</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">var</span> <span class="nv">body</span><span class="p">:</span> <span class="kd">some</span> <span class="kt">View</span> <span class="p">{</span>
        <span class="kt">VStack</span> <span class="p">{</span>
            <span class="kt">Text</span><span class="p">(</span><span class="s">"All images"</span><span class="p">)</span>
                <span class="o">.</span><span class="nf">font</span><span class="p">(</span><span class="o">.</span><span class="n">headline</span><span class="p">)</span>
            <span class="n">allImagesView</span>

            <span class="kt">Spacer</span><span class="p">()</span>

            <span class="kt">Text</span><span class="p">(</span><span class="s">"Selected images"</span><span class="p">)</span>
                <span class="o">.</span><span class="nf">font</span><span class="p">(</span><span class="o">.</span><span class="n">headline</span><span class="p">)</span>
            <span class="n">selectedImagesView</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>Here we have a view that defines the list of images and the empty list of selected images. We also structured our view’s body to place the list of available images on the top and the list of selected images on the bottom of the screen. Let’s move forward and implement a grid that displays our images.</p>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// ContentView.swift</span>
<span class="kd">private</span> <span class="k">var</span> <span class="nv">allImagesView</span><span class="p">:</span> <span class="kd">some</span> <span class="kt">View</span> <span class="p">{</span>
    <span class="kt">LazyVGrid</span><span class="p">(</span><span class="nv">columns</span><span class="p">:</span> <span class="p">[</span><span class="o">.</span><span class="nf">init</span><span class="p">(</span><span class="o">.</span><span class="nf">adaptive</span><span class="p">(</span><span class="nv">minimum</span><span class="p">:</span> <span class="mi">44</span><span class="p">))])</span> <span class="p">{</span>
        <span class="kt">ForEach</span><span class="p">(</span><span class="n">allImages</span><span class="p">,</span> <span class="nv">id</span><span class="p">:</span> <span class="p">\</span><span class="o">.</span><span class="k">self</span><span class="p">)</span> <span class="p">{</span> <span class="n">image</span> <span class="k">in</span>
            <span class="kt">Image</span><span class="p">(</span><span class="nv">systemName</span><span class="p">:</span> <span class="n">image</span><span class="p">)</span>
                <span class="o">.</span><span class="nf">resizable</span><span class="p">()</span>
                <span class="o">.</span><span class="nf">frame</span><span class="p">(</span><span class="nv">width</span><span class="p">:</span> <span class="mi">44</span><span class="p">,</span> <span class="nv">height</span><span class="p">:</span> <span class="mi">44</span><span class="p">)</span>
                <span class="o">.</span><span class="n">onTapGesture</span> <span class="p">{</span>
                    <span class="n">withAnimation</span> <span class="p">{</span>
                        <span class="n">allImages</span><span class="o">.</span><span class="n">removeAll</span> <span class="p">{</span> <span class="nv">$0</span> <span class="o">==</span> <span class="n">image</span> <span class="p">}</span>
                        <span class="n">selectedImages</span><span class="o">.</span><span class="nf">append</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
                    <span class="p">}</span>
                <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>As you can see in the example above, we have a grid with a single adaptive column displaying squared images of 44pt. We also attach a tap gesture to every image that removes the image from the list and moves it to the selected image list. We wrap this mutation using the <em>withAnimation</em> function, which animates this change.</p>

<blockquote>
  <p>To learn more about grids, look at my <a href="/2020/07/08/mastering-grids-in-swiftui/">“Mastering grids in SwiftUI”</a> post.</p>
</blockquote>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// ContentView.swift</span>
<span class="kd">private</span> <span class="k">var</span> <span class="nv">selectedImagesView</span><span class="p">:</span> <span class="kd">some</span> <span class="kt">View</span> <span class="p">{</span>
    <span class="kt">LazyVGrid</span><span class="p">(</span><span class="nv">columns</span><span class="p">:</span> <span class="p">[</span><span class="o">.</span><span class="nf">init</span><span class="p">(</span><span class="o">.</span><span class="nf">adaptive</span><span class="p">(</span><span class="nv">minimum</span><span class="p">:</span> <span class="mi">88</span><span class="p">))])</span> <span class="p">{</span>
        <span class="kt">ForEach</span><span class="p">(</span><span class="n">selectedImages</span><span class="p">,</span> <span class="nv">id</span><span class="p">:</span> <span class="p">\</span><span class="o">.</span><span class="k">self</span><span class="p">)</span> <span class="p">{</span> <span class="n">image</span> <span class="k">in</span>
            <span class="kt">Image</span><span class="p">(</span><span class="nv">systemName</span><span class="p">:</span> <span class="n">image</span><span class="p">)</span>
                <span class="o">.</span><span class="nf">resizable</span><span class="p">()</span>
                <span class="o">.</span><span class="nf">frame</span><span class="p">(</span><span class="nv">width</span><span class="p">:</span> <span class="mi">88</span><span class="p">,</span> <span class="nv">height</span><span class="p">:</span> <span class="mi">88</span><span class="p">)</span>
                <span class="o">.</span><span class="n">onTapGesture</span> <span class="p">{</span>
                    <span class="n">withAnimation</span> <span class="p">{</span>
                        <span class="n">selectedImages</span><span class="o">.</span><span class="n">removeAll</span> <span class="p">{</span> <span class="nv">$0</span> <span class="o">==</span> <span class="n">image</span> <span class="p">}</span>
                        <span class="n">allImages</span><span class="o">.</span><span class="nf">append</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
                    <span class="p">}</span>
                <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>Here is the source code of the selected images grid, which looks very similar to the previous one. There are two differences. The first one is the size of the images. Here we use 88pt instead of 44pt. The second difference is the tap gesture. In this case, we move an image from the list of the selected image to the all images list.</p>

<p>By default, SwiftUI uses fade-in and fade-out transitions to animate layout changes. For example, when you remove a view from a view hierarchy, SwiftUI uses a fade-out transition. You can change this behavior by adding a <em>transition</em> modifier to the view and providing another transition.</p>

<blockquote>
  <p>If you are not familiar with transitions in SwiftUI, take a look at my <a href="/2019/06/26/animations-in-swiftui/">“Animations in SwiftUI”</a> post.</p>
</blockquote>

<p><img src="/public/hero1.mp4" alt="fading-animation" /></p>

<p>As you can see here, SwiftUI removes the image you tap using fade-out transition and adds it to another grid using fade-in transition. Now, it is time to talk about hero animations.</p>

<p>Hero animation is a special effect in motion pictures and animations that changes one image into another through a seamless transition. For example, we want to achieve a morphing animation while moving an image from top to bottom by applying the scaling transformation.</p>

<p>Fortunately, SwiftUI provides us a special view modifier called <em>matchedGeometryEffect</em> to implement hero animations easily. By attaching <em>matchedGeometryEffect</em> to multiple views, we define a connection between them. SwiftUI can use this connection to understand the geometry of transition and automatically apply shape, position, and size transformation between these changes.</p>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// ContentView.swift</span>
<span class="kd">@Namespace</span> <span class="kd">private</span> <span class="k">var</span> <span class="nv">imageEffect</span>

<span class="kd">private</span> <span class="k">var</span> <span class="nv">allImagesView</span><span class="p">:</span> <span class="kd">some</span> <span class="kt">View</span> <span class="p">{</span>
    <span class="kt">LazyVGrid</span><span class="p">(</span><span class="nv">columns</span><span class="p">:</span> <span class="p">[</span><span class="o">.</span><span class="nf">init</span><span class="p">(</span><span class="o">.</span><span class="nf">adaptive</span><span class="p">(</span><span class="nv">minimum</span><span class="p">:</span> <span class="mi">44</span><span class="p">))])</span> <span class="p">{</span>
        <span class="kt">ForEach</span><span class="p">(</span><span class="n">allImages</span><span class="p">,</span> <span class="nv">id</span><span class="p">:</span> <span class="p">\</span><span class="o">.</span><span class="k">self</span><span class="p">)</span> <span class="p">{</span> <span class="n">image</span> <span class="k">in</span>
            <span class="kt">Image</span><span class="p">(</span><span class="nv">systemName</span><span class="p">:</span> <span class="n">image</span><span class="p">)</span>
                <span class="o">.</span><span class="nf">resizable</span><span class="p">()</span>
                <span class="o">.</span><span class="nf">matchedGeometryEffect</span><span class="p">(</span><span class="nv">id</span><span class="p">:</span> <span class="n">image</span><span class="p">,</span> <span class="nv">in</span><span class="p">:</span> <span class="n">imageEffect</span><span class="p">)</span>
                <span class="o">.</span><span class="nf">frame</span><span class="p">(</span><span class="nv">width</span><span class="p">:</span> <span class="mi">44</span><span class="p">,</span> <span class="nv">height</span><span class="p">:</span> <span class="mi">44</span><span class="p">)</span>
                <span class="o">.</span><span class="n">onTapGesture</span> <span class="p">{</span>
                    <span class="n">withAnimation</span> <span class="p">{</span>
                        <span class="n">allImages</span><span class="o">.</span><span class="n">removeAll</span> <span class="p">{</span> <span class="nv">$0</span> <span class="o">==</span> <span class="n">image</span> <span class="p">}</span>
                        <span class="n">selectedImages</span><span class="o">.</span><span class="nf">append</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
                    <span class="p">}</span>
                <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kd">private</span> <span class="k">var</span> <span class="nv">selectedImagesView</span><span class="p">:</span> <span class="kd">some</span> <span class="kt">View</span> <span class="p">{</span>
    <span class="kt">LazyVGrid</span><span class="p">(</span><span class="nv">columns</span><span class="p">:</span> <span class="p">[</span><span class="o">.</span><span class="nf">init</span><span class="p">(</span><span class="o">.</span><span class="nf">adaptive</span><span class="p">(</span><span class="nv">minimum</span><span class="p">:</span> <span class="mi">88</span><span class="p">))])</span> <span class="p">{</span>
        <span class="kt">ForEach</span><span class="p">(</span><span class="n">selectedImages</span><span class="p">,</span> <span class="nv">id</span><span class="p">:</span> <span class="p">\</span><span class="o">.</span><span class="k">self</span><span class="p">)</span> <span class="p">{</span> <span class="n">image</span> <span class="k">in</span>
            <span class="kt">Image</span><span class="p">(</span><span class="nv">systemName</span><span class="p">:</span> <span class="n">image</span><span class="p">)</span>
                <span class="o">.</span><span class="nf">resizable</span><span class="p">()</span>
                <span class="o">.</span><span class="nf">matchedGeometryEffect</span><span class="p">(</span><span class="nv">id</span><span class="p">:</span> <span class="n">image</span><span class="p">,</span> <span class="nv">in</span><span class="p">:</span> <span class="n">imageEffect</span><span class="p">)</span>
                <span class="o">.</span><span class="nf">frame</span><span class="p">(</span><span class="nv">width</span><span class="p">:</span> <span class="mi">88</span><span class="p">,</span> <span class="nv">height</span><span class="p">:</span> <span class="mi">88</span><span class="p">)</span>
                <span class="o">.</span><span class="n">onTapGesture</span> <span class="p">{</span>
                    <span class="n">withAnimation</span> <span class="p">{</span>
                        <span class="n">selectedImages</span><span class="o">.</span><span class="n">removeAll</span> <span class="p">{</span> <span class="nv">$0</span> <span class="o">==</span> <span class="n">image</span> <span class="p">}</span>
                        <span class="n">allImages</span><span class="o">.</span><span class="nf">append</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
                    <span class="p">}</span>
                <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>As you can see, we attach <em>matchedGeometryEffect</em> view modifier by passing a unique identifier and namespace. SwiftUI uses these parameters to identify views in the view hierarchy and understand layout changes.</p>

<p>If inserting a view in the same transaction that another view with the same identifier is removed, the system will interpolate their frame rectangles in window space to make it appear that a single view moves from its old position to its new position. Remember that you should use unique identifiers for every view that applies a matched geometry effect.</p>

<p><img src="/public/hero2.mp4" alt="hero-animation" /></p>

<h4 id="conclusion">Conclusion</h4>
<p>Today we learned about implementing hero animations in SwiftUI using the <em>matchedGeometryEffect</em> view modifier. I love how easy we can achieve this effect in SwiftUI. Unfortunately, it doesn’t work between different views inside navigation links, but I hope to see this working during the next iteration of SwiftUI. I hope you enjoy the post. Feel free to follow me on <a href="https://twitter.com/mecid">Twitter</a> and ask your questions related to this article. Thanks for reading, and see you next week!</p>


</article>


<aside class="related">
  <h4>Recent posts</h4>
  <ul class="related-posts">
    
      <li>
        <a title="Custom accessibility content in SwiftUI" href="/2021/10/06/custom-accessibility-content-in-swiftui/">
          Custom accessibility content in SwiftUI
          <small><time datetime="2021-10-06T00:00:00+08:00">06 Oct 2021</time></small>
        </a>
      </li>
    
      <li>
        <a title="Audio graphs in SwiftUI" href="/2021/09/29/audio-graphs-in-swiftui/">
          Audio graphs in SwiftUI
          <small><time datetime="2021-09-29T00:00:00+08:00">29 Sep 2021</time></small>
        </a>
      </li>
    
      <li>
        <a title="Accessibility focus in SwiftUI" href="/2021/09/23/accessibility-focus-in-swiftui/">
          Accessibility focus in SwiftUI
          <small><time datetime="2021-09-23T00:00:00+08:00">23 Sep 2021</time></small>
        </a>
      </li>
    
  </ul>
</aside>


      </main>

      <footer class="footer">
          <img class="avatar" alt="mecid" width="100" height="100" data-proofer-ignore="true" src="https://avatars2.githubusercontent.com/mecid?v=3&s=100" srcset="https://avatars2.githubusercontent.com/mecid?v=3&s=100 1x, https://avatars2.githubusercontent.com/mecid?v=3&s=200 2x, https://avatars2.githubusercontent.com/mecid?v=3&s=300 3x, https://avatars2.githubusercontent.com/mecid?v=3&s=400 4x" />
          <small>Hi there! I am code4you,I like to program, and do some App.</small>
          <small>I'm a developer</small>
          <small>Feel free to follow me on <a href="https://github.com/code4you2021">Github</a>.</small>
        <small>
          &copy; <time datetime="2021-10-17T11:25:11+08:00">2021</time>. All rights reserved.
        </small>
      </footer>
    </div>

    
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-1WQVZK1CR7"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-18491817-18');
    </script>
    
  </body>
</html>
