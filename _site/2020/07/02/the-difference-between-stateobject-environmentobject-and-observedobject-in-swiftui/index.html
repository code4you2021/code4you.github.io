<!DOCTYPE html>
<html lang="en">

  <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="keywords" content="swift ios development apple watch iphone ipad swiftui macos uikit dev wwdc tutorial guide redux tea state container" />

  <!-- Begin Jekyll SEO tag v2.7.1 -->
<title>The difference between @StateObject, @EnvironmentObject, and @ObservedObject in SwiftUI | Code4You</title>
<meta name="generator" content="Jekyll v3.9.0" />
<meta property="og:title" content="The difference between @StateObject, @EnvironmentObject, and @ObservedObject in SwiftUI" />
<meta name="author" content="Code4You" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="This week I decided to share as much as I can about data flow in SwiftUI. In this post, we will discuss the difference between @StateObject, @EnvironmentObject, and @ObservedObject property wrappers. I know that this is the most confusing topic in SwiftUI for newcomers." />
<meta property="og:description" content="This week I decided to share as much as I can about data flow in SwiftUI. In this post, we will discuss the difference between @StateObject, @EnvironmentObject, and @ObservedObject property wrappers. I know that this is the most confusing topic in SwiftUI for newcomers." />
<link rel="canonical" href="http://localhost:4000/2020/07/02/the-difference-between-stateobject-environmentobject-and-observedobject-in-swiftui/" />
<meta property="og:url" content="http://localhost:4000/2020/07/02/the-difference-between-stateobject-environmentobject-and-observedobject-in-swiftui/" />
<meta property="og:site_name" content="Code4You" />
<meta property="og:image" content="http://localhost:4000/public/wwdc20.jpg" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2020-07-02T00:00:00+08:00" />
<meta name="twitter:card" content="summary_large_image" />
<meta property="twitter:image" content="http://localhost:4000/public/wwdc20.jpg" />
<meta property="twitter:title" content="The difference between @StateObject, @EnvironmentObject, and @ObservedObject in SwiftUI" />
<script type="application/ld+json">
{"@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/2020/07/02/the-difference-between-stateobject-environmentobject-and-observedobject-in-swiftui/"},"url":"http://localhost:4000/2020/07/02/the-difference-between-stateobject-environmentobject-and-observedobject-in-swiftui/","image":"http://localhost:4000/public/wwdc20.jpg","author":{"@type":"Person","name":"Code4You"},"headline":"The difference between @StateObject, @EnvironmentObject, and @ObservedObject in SwiftUI","description":"This week I decided to share as much as I can about data flow in SwiftUI. In this post, we will discuss the difference between @StateObject, @EnvironmentObject, and @ObservedObject property wrappers. I know that this is the most confusing topic in SwiftUI for newcomers.","dateModified":"2020-07-02T00:00:00+08:00","datePublished":"2020-07-02T00:00:00+08:00","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->


  <link rel="stylesheet" href="/styles.css">
  <link rel="shortcut icon" href="/public/favicon.ico">
  <link rel="alternate" type="application/atom+xml" title="Code4You" href="/feed.xml">
</head>


  <body>

    <div class="container content">
      <header class="masthead">
        <nav>
          <h1 class="masthead-title">
            <a href="/" title="Home">Code4You</a>
          </h1>
          <div>
            <a href="/categories" title="Categories">Categories</a>
            <a href="/archive" title="Archive">Archive</a>
            <a href="/feed.xml" title="Feed">Feed</a>
          </div>
        </nav>
      </header>

      <main>
        <article class="post">
  <h2 class="post-title">The difference between @StateObject, @EnvironmentObject, and @ObservedObject in SwiftUI</h2>
  <time datetime="2020-07-02T00:00:00+08:00" class="post-date">02 Jul 2020</time>
  <p>This week I decided to share as much as I can about data flow in SwiftUI. In this post, we will discuss the difference between @<em>StateObject</em>, @<em>EnvironmentObject</em>, and @<em>ObservedObject</em> property wrappers. I know that this is the most confusing topic in SwiftUI for newcomers.</p>

<!-- <div class="ads">
    <span>
        Why don’t more iOS apps use voice? Machine learning for voice is hard, and using Siri is clunky and rigid. So we open-sourced an iOS library (also Android, Node, Python, & React Native), and built a no-code web tool to make custom wake words, speech recognizers, and AI voices—for all devs! <a href="https://www.spokestack.io/?utm_source=swiftui_weekly&utm_medium=email&utm_campaign=maker_launch_PAID">Try it for free.</a>
    </span>
</div> -->

<h4 id="why-swiftui-does-need-property-wrappers">Why SwiftUI does need property wrappers?</h4>
<p>SwiftUI uses immutable struct types to describe the view hierarchy. All the views that SwiftUI provides are immutable. That’s why SwiftUI gives us a bunch of property wrappers to handle data mutations. Property wrappers allow us to declare them inside SwiftUI views but store the data outside of the view declaring it.</p>

<h4 id="stateobject">@StateObject</h4>
<p>@<em>StateObject</em> is the new property wrapper that initializes the instance of a class that conforms to <em>ObservableObject</em> protocol and store it inside the SwiftUI framework’s internal memory. SwiftUI creates @<em>StateObject</em> only once for every container that declares it and keeps it outside of view lifecycle. Let’s look at some examples where we use @<em>StateObject</em> to keep the whole app’s state.</p>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">import</span> <span class="kt">SwiftUI</span>

<span class="kd">@main</span>
<span class="kd">struct</span> <span class="kt">CardioBotApp</span><span class="p">:</span> <span class="kt">App</span> <span class="p">{</span>
    <span class="kd">@StateObject</span> <span class="k">var</span> <span class="nv">store</span> <span class="o">=</span> <span class="kt">Store</span><span class="p">(</span>
        <span class="nv">initialState</span><span class="p">:</span> <span class="kt">AppState</span><span class="p">(),</span>
        <span class="nv">reducer</span><span class="p">:</span> <span class="n">appReducer</span><span class="p">,</span>
        <span class="nv">environment</span><span class="p">:</span> <span class="kt">AppEnvironment</span><span class="p">(</span><span class="nv">service</span><span class="p">:</span> <span class="kt">HealthService</span><span class="p">())</span>
    <span class="p">)</span>

    <span class="k">var</span> <span class="nv">body</span><span class="p">:</span> <span class="kd">some</span> <span class="kt">Scene</span> <span class="p">{</span>
        <span class="kt">WindowGroup</span> <span class="p">{</span>
            <span class="kt">RootView</span><span class="p">()</span><span class="o">.</span><span class="nf">environmentObject</span><span class="p">(</span><span class="n">store</span><span class="p">)</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>As you can see, @<em>StateObject</em> perfectly fits to store the whole app state and share it with different scenes or views of your app. SwiftUI will store it in special framework memory to keep your data in a safe place outside of scene or view lifecycle.</p>

<blockquote>
  <p>To learn more about using a single state container, take a look at my <a href="/2019/09/18/redux-like-state-container-in-swiftui/">“Redux-like state container in SwiftUI. Basics.”</a> post.</p>
</blockquote>

<h4 id="observedobject">@ObservedObject</h4>
<p>@<em>ObservedObject</em> is another way to subscribe and keep track of changes in <em>ObservableObject</em>. SwiftUI doesn’t control the lifecycle of @<em>ObservedObject</em>, and you have to manage it yourself. @<em>ObservedObject</em> perfectly fits a case where you have an <em>ObservableObject</em> stored by @<em>StateObject</em>, and you want to share it with any reusable view.</p>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">struct</span> <span class="kt">CalendarContainerView</span><span class="p">:</span> <span class="kt">View</span> <span class="p">{</span>
    <span class="kd">@ObservedObject</span> <span class="k">var</span> <span class="nv">store</span><span class="p">:</span> <span class="kt">Store</span><span class="o">&lt;</span><span class="kt">CalendarState</span><span class="p">,</span> <span class="kt">CalendarAction</span><span class="o">&gt;</span>
    <span class="k">let</span> <span class="nv">interval</span><span class="p">:</span> <span class="kt">DateInterval</span>

    <span class="k">var</span> <span class="nv">body</span><span class="p">:</span> <span class="kd">some</span> <span class="kt">View</span> <span class="p">{</span>
        <span class="kt">CalendarView</span><span class="p">(</span><span class="nv">interval</span><span class="p">:</span> <span class="n">interval</span><span class="p">)</span> <span class="p">{</span> <span class="n">date</span> <span class="k">in</span>
            <span class="kt">DateView</span><span class="p">(</span><span class="nv">date</span><span class="p">:</span> <span class="n">date</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">self</span><span class="o">.</span><span class="nf">view</span><span class="p">(</span><span class="nv">for</span><span class="p">:</span> <span class="n">date</span><span class="p">)</span>
            <span class="p">}</span>
        <span class="p">}</span><span class="o">.</span><span class="nf">navigationBarTitle</span><span class="p">(</span><span class="s">"calendar"</span><span class="p">,</span> <span class="nv">displayMode</span><span class="p">:</span> <span class="o">.</span><span class="n">inline</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>I mention reusable views because I use <em>CalendarContainerView</em> in multiple places in my app, and I don’t want to make it dependent on the environment. I use @<em>ObservedObject</em> to explicitly indicate the data used by the view in that particular case.</p>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">NavigationLink</span><span class="p">(</span>
    <span class="nv">destination</span><span class="p">:</span> <span class="kt">CalendarContainerView</span><span class="p">(</span>
        <span class="nv">store</span><span class="p">:</span> <span class="n">transformedStore</span><span class="p">,</span>
        <span class="nv">interval</span><span class="p">:</span> <span class="o">.</span><span class="n">twelveMonthsAgo</span>
    <span class="p">)</span>
<span class="p">)</span> <span class="p">{</span>
    <span class="kt">Text</span><span class="p">(</span><span class="s">"Calendar"</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div></div>

<blockquote>
  <p>To learn more about using container views, take a look at my <a href="/2019/10/02/redux-like-state-container-in-swiftui-part3/">“Redux-like state container in SwiftUI. Container Views.”</a> post.</p>
</blockquote>

<h4 id="environmentobject">@EnvironmentObject</h4>
<p>@<em>EnvironmentObject</em> is an excellent way to implicitly inject an instance of a class that conforms to <em>ObservableObject</em> into a part of the view hierarchy. Assume that you have a module in your app that contains 3-4 screens, and all of them use the same view model. If you don’t want to pass the same view model explicitly from one view to another, then @<em>EnvironmentObject</em> is all you need. Let’s take a look at how we can use it.</p>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">@main</span>
<span class="kd">struct</span> <span class="kt">CardioBotApp</span><span class="p">:</span> <span class="kt">App</span> <span class="p">{</span>
    <span class="kd">@StateObject</span> <span class="k">var</span> <span class="nv">store</span> <span class="o">=</span> <span class="kt">Store</span><span class="p">(</span>
        <span class="nv">initialState</span><span class="p">:</span> <span class="kt">AppState</span><span class="p">(),</span>
        <span class="nv">reducer</span><span class="p">:</span> <span class="n">appReducer</span><span class="p">,</span>
        <span class="nv">environment</span><span class="p">:</span> <span class="o">.</span><span class="n">production</span>
    <span class="p">)</span>

    <span class="k">var</span> <span class="nv">body</span><span class="p">:</span> <span class="kd">some</span> <span class="kt">Scene</span> <span class="p">{</span>
        <span class="kt">WindowGroup</span> <span class="p">{</span>
            <span class="kt">TabView</span> <span class="p">{</span>
                <span class="kt">NavigationView</span> <span class="p">{</span>
                    <span class="kt">SummaryContainerView</span><span class="p">()</span>
                        <span class="o">.</span><span class="nf">navigationBarTitle</span><span class="p">(</span><span class="s">"today"</span><span class="p">)</span>
                        <span class="o">.</span><span class="nf">environmentObject</span><span class="p">(</span>
                            <span class="n">store</span><span class="o">.</span><span class="nf">derived</span><span class="p">(</span>
                                <span class="nv">deriveState</span><span class="p">:</span> <span class="p">\</span><span class="o">.</span><span class="n">summary</span><span class="p">,</span>
                                <span class="nv">embedAction</span><span class="p">:</span> <span class="kt">AppAction</span><span class="o">.</span><span class="n">summary</span>
                            <span class="p">)</span>
                        <span class="p">)</span>
                <span class="p">}</span>

                <span class="kt">NavigationView</span> <span class="p">{</span>
                    <span class="kt">TrendsContainerView</span><span class="p">()</span>
                        <span class="o">.</span><span class="nf">navigationBarTitle</span><span class="p">(</span><span class="s">"trends"</span><span class="p">)</span>
                        <span class="o">.</span><span class="nf">environmentObject</span><span class="p">(</span>
                            <span class="n">store</span><span class="o">.</span><span class="nf">derived</span><span class="p">(</span>
                                <span class="nv">deriveState</span><span class="p">:</span> <span class="p">\</span><span class="o">.</span><span class="n">trends</span><span class="p">,</span>
                                <span class="nv">embedAction</span><span class="p">:</span> <span class="kt">AppAction</span><span class="o">.</span><span class="n">trends</span>
                            <span class="p">)</span>
                        <span class="p">)</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>In the example above, we inject the environment object into the view hierarchy of <em>SummaryContainerView</em>. SwiftUI will implicitly give access for inserted environment objects to all child views that live inside <em>SummaryContainerView</em>. We can quickly obtain and subscribe to injected environment objects using @<em>EnvironmentObject</em> property wrapper.</p>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">struct</span> <span class="kt">SummaryContainerView</span><span class="p">:</span> <span class="kt">View</span> <span class="p">{</span>
    <span class="kd">@EnvironmentObject</span> <span class="k">var</span> <span class="nv">store</span><span class="p">:</span> <span class="kt">Store</span><span class="o">&lt;</span><span class="kt">SummaryState</span><span class="p">,</span> <span class="kt">SummaryAction</span><span class="o">&gt;</span>

    <span class="k">var</span> <span class="nv">body</span><span class="p">:</span> <span class="kd">some</span> <span class="kt">View</span> <span class="p">{</span>
        <span class="c1">//......</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>I have to mention that @<em>EnvironmentObject</em> has the same lifecycle as @<em>ObservedObject</em>. It means that you can get a new environment object whenever you create it inside a view that can be recreated by SwiftUI.</p>

<blockquote>
  <p>To learn more about advanced techniques while using a single state container, take a look at my <a href="/2019/09/25/redux-like-state-container-in-swiftui-part2/">“Redux-like state container in SwiftUI. Best practices.”</a> post.</p>
</blockquote>

<h4 id="conclusion">Conclusion</h4>
<p>Today we talked about the differences between @<em>StateObject</em>, @<em>EnvironmentObject</em>, and @<em>ObservedObject</em> property wrappers. I hope this post makes it easier to understand which property wrapper fits best your case. Feel free to follow me on <a href="https://twitter.com/mecid">Twitter</a> and ask your questions related to this post. Thanks for reading, and see you next week!</p>

</article>


<aside class="related">
  <h4>Recent posts</h4>
  <ul class="related-posts">
    
      <li>
        <a title="Custom accessibility content in SwiftUI" href="/2021/10/06/custom-accessibility-content-in-swiftui/">
          Custom accessibility content in SwiftUI
          <small><time datetime="2021-10-06T00:00:00+08:00">06 Oct 2021</time></small>
        </a>
      </li>
    
      <li>
        <a title="Audio graphs in SwiftUI" href="/2021/09/29/audio-graphs-in-swiftui/">
          Audio graphs in SwiftUI
          <small><time datetime="2021-09-29T00:00:00+08:00">29 Sep 2021</time></small>
        </a>
      </li>
    
      <li>
        <a title="Accessibility focus in SwiftUI" href="/2021/09/23/accessibility-focus-in-swiftui/">
          Accessibility focus in SwiftUI
          <small><time datetime="2021-09-23T00:00:00+08:00">23 Sep 2021</time></small>
        </a>
      </li>
    
  </ul>
</aside>


      </main>

      <footer class="footer">
          <img class="avatar" alt="mecid" width="100" height="100" data-proofer-ignore="true" src="https://avatars2.githubusercontent.com/mecid?v=3&s=100" srcset="https://avatars2.githubusercontent.com/mecid?v=3&s=100 1x, https://avatars2.githubusercontent.com/mecid?v=3&s=200 2x, https://avatars2.githubusercontent.com/mecid?v=3&s=300 3x, https://avatars2.githubusercontent.com/mecid?v=3&s=400 4x" />
          <small>Hi there! I am code4you,I like to program, and do some App.</small>
          <small>I'm a developer</small>
          <small>Feel free to follow me on <a href="https://github.com/code4you2021">Github</a>.</small>
        <small>
          &copy; <time datetime="2021-10-17T11:25:11+08:00">2021</time>. All rights reserved.
        </small>
      </footer>
    </div>

    
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-1WQVZK1CR7"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-18491817-18');
    </script>
    
  </body>
</html>
