<!DOCTYPE html>
<html lang="en">

  <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="keywords" content="swift ios development apple watch iphone ipad swiftui macos uikit dev wwdc tutorial guide redux tea state container" />

  <!-- Begin Jekyll SEO tag v2.7.1 -->
<title>The power of @ViewBuilder in SwiftUI | Code4You</title>
<meta name="generator" content="Jekyll v3.9.0" />
<meta property="og:title" content="The power of @ViewBuilder in SwiftUI" />
<meta name="author" content="Code4You" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Last week we started a series of posts about developing interactive components using SwiftUI, where we talked about building the bottom sheet. We need to understand the power of @ViewBuilder before moving to the next post about building another interactive view. That’s why this week, we will talk about @ViewBuilder and its benefits while developing custom views." />
<meta property="og:description" content="Last week we started a series of posts about developing interactive components using SwiftUI, where we talked about building the bottom sheet. We need to understand the power of @ViewBuilder before moving to the next post about building another interactive view. That’s why this week, we will talk about @ViewBuilder and its benefits while developing custom views." />
<link rel="canonical" href="http://localhost:4000/2019/12/18/the-power-of-viewbuilder-in-swiftui/" />
<meta property="og:url" content="http://localhost:4000/2019/12/18/the-power-of-viewbuilder-in-swiftui/" />
<meta property="og:site_name" content="Code4You" />
<meta property="og:image" content="http://localhost:4000/public/viewbuilder.png" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2019-12-18T00:00:00+08:00" />
<meta name="twitter:card" content="summary_large_image" />
<meta property="twitter:image" content="http://localhost:4000/public/viewbuilder.png" />
<meta property="twitter:title" content="The power of @ViewBuilder in SwiftUI" />
<script type="application/ld+json">
{"@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/2019/12/18/the-power-of-viewbuilder-in-swiftui/"},"url":"http://localhost:4000/2019/12/18/the-power-of-viewbuilder-in-swiftui/","image":"http://localhost:4000/public/viewbuilder.png","author":{"@type":"Person","name":"Code4You"},"headline":"The power of @ViewBuilder in SwiftUI","description":"Last week we started a series of posts about developing interactive components using SwiftUI, where we talked about building the bottom sheet. We need to understand the power of @ViewBuilder before moving to the next post about building another interactive view. That’s why this week, we will talk about @ViewBuilder and its benefits while developing custom views.","dateModified":"2019-12-18T00:00:00+08:00","datePublished":"2019-12-18T00:00:00+08:00","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->


  <link rel="stylesheet" href="/styles.css">
  <link rel="shortcut icon" href="/public/favicon.ico">
  <link rel="alternate" type="application/atom+xml" title="Code4You" href="/feed.xml">
</head>


  <body>

    <div class="container content">
      <header class="masthead">
        <nav>
          <h1 class="masthead-title">
            <a href="/" title="Home">Code4You</a>
          </h1>
          <div>
            <a href="/categories" title="Categories">Categories</a>
            <a href="/archive" title="Archive">Archive</a>
            <a href="/feed.xml" title="Feed">Feed</a>
          </div>
        </nav>
      </header>

      <main>
        <article class="post">
  <h2 class="post-title">The power of @ViewBuilder in SwiftUI</h2>
  <time datetime="2019-12-18T00:00:00+08:00" class="post-date">18 Dec 2019</time>
  <p>Last week we started a series of posts about developing interactive components using SwiftUI, where we talked about building the bottom sheet. We need to understand the power of <em>@ViewBuilder</em> before moving to the next post about building another interactive view. That’s why this week, we will talk about <em>@ViewBuilder</em> and its benefits while developing custom views.</p>

<!-- <div class="ads">
    <span>
        Why don’t more iOS apps use voice? Machine learning for voice is hard, and using Siri is clunky and rigid. So we open-sourced an iOS library (also Android, Node, Python, & React Native), and built a no-code web tool to make custom wake words, speech recognizers, and AI voices—for all devs! <a href="https://www.spokestack.io/?utm_source=swiftui_weekly&utm_medium=email&utm_campaign=maker_launch_PAID">Try it for free.</a>
    </span>
</div> -->

<h4 id="result-builders">Result builders</h4>
<p><em>@ViewBuilder</em> is one of the possible result builders. The result builder feature of Swift is described in <a href="https://github.com/apple/swift-evolution/blob/main/proposals/0289-result-builders.md">Swift Evolution Proposal</a>. The main goal of result builder is providing <em>DSL</em> like syntax. Let’s take a look at a very quick example of <em>@ViewBuilder</em> usage.</p>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">import</span> <span class="kt">SwiftUI</span>

<span class="kd">struct</span> <span class="kt">ContentView</span><span class="p">:</span> <span class="kt">View</span> <span class="p">{</span>
    <span class="k">var</span> <span class="nv">body</span><span class="p">:</span> <span class="kd">some</span> <span class="kt">View</span> <span class="p">{</span>
        <span class="kt">HStack</span><span class="p">{</span>
            <span class="kt">Text</span><span class="p">(</span><span class="s">"hello"</span><span class="p">)</span>
            <span class="kt">Text</span><span class="p">(</span><span class="s">"world"</span><span class="p">)</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>We need to go down one layer to understand how <em>@ViewBuilder</em> works.</p>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">@inlinable</span> <span class="kd">public</span> <span class="nf">init</span><span class="p">(</span>
    <span class="nv">alignment</span><span class="p">:</span> <span class="kt">VerticalAlignment</span> <span class="o">=</span> <span class="o">.</span><span class="n">center</span><span class="p">,</span>
    <span class="nv">spacing</span><span class="p">:</span> <span class="kt">CGFloat</span><span class="p">?</span> <span class="o">=</span> <span class="kc">nil</span><span class="p">,</span>
    <span class="kd">@ViewBuilder</span> <span class="nv">content</span><span class="p">:</span> <span class="p">()</span> <span class="o">-&gt;</span> <span class="kt">Content</span>
<span class="p">)</span>
</code></pre></div></div>

<p>Here is the declaration of <em>HStack</em> view, as you can see the content closure inside the init method marked with <em>@ViewBuilder</em>. It means that expression inside that closure needs to be handled by <em>@ViewBuilder</em>. The swift compiler will try to find the static buildBlock method declared in <em>@ViewBuilder</em> struct that has two views as parameters. Let’s take a look at <em>@ViewBuilder</em> struct declaration to find that method.</p>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">@available</span><span class="p">(</span><span class="n">iOS</span> <span class="mf">13.0</span><span class="p">,</span> <span class="kt">OSX</span> <span class="mf">10.15</span><span class="p">,</span> <span class="n">tvOS</span> <span class="mf">13.0</span><span class="p">,</span> <span class="n">watchOS</span> <span class="mf">6.0</span><span class="p">,</span> <span class="o">*</span><span class="p">)</span>
<span class="kd">extension</span> <span class="kt">ViewBuilder</span> <span class="p">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">func</span> <span class="n">buildBlock</span><span class="o">&lt;</span><span class="kt">C0</span><span class="p">,</span> <span class="kt">C1</span><span class="o">&gt;</span><span class="p">(</span><span class="n">_</span> <span class="nv">c0</span><span class="p">:</span> <span class="kt">C0</span><span class="p">,</span> <span class="n">_</span> <span class="nv">c1</span><span class="p">:</span> <span class="kt">C1</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">TupleView</span><span class="o">&lt;</span><span class="p">(</span><span class="kt">C0</span><span class="p">,</span> <span class="kt">C1</span><span class="p">)</span><span class="o">&gt;</span> <span class="k">where</span> <span class="kt">C0</span> <span class="p">:</span> <span class="kt">View</span><span class="p">,</span> <span class="kt">C1</span> <span class="p">:</span> <span class="kt">View</span>
<span class="p">}</span>
</code></pre></div></div>

<p>As you can see, <em>@ViewBuilder</em> has a static <em>buildBlock</em> method that accepts two views, combine them and return <em>TupleView</em>. It also has other declarations of <em>buildBlock</em> method, which takes from one to ten child views, and all of them combine child views into a <em>TupleView</em>. That’s why <em>@ViewBuilder</em> can accept only ten views inside the closure.</p>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">struct</span> <span class="kt">ContentView</span><span class="p">:</span> <span class="kt">View</span> <span class="p">{</span>
    <span class="kd">@ObservedObject</span> <span class="k">var</span> <span class="nv">viewModel</span><span class="p">:</span> <span class="kt">ViewModel</span>

    <span class="kd">@ViewBuilder</span>
    <span class="k">var</span> <span class="nv">body</span><span class="p">:</span> <span class="kd">some</span> <span class="kt">View</span> <span class="p">{</span>
        <span class="k">if</span> <span class="n">viewModel</span><span class="o">.</span><span class="n">isAuthorized</span> <span class="p">{</span>
            <span class="kt">Text</span><span class="p">(</span><span class="s">"Hello World!"</span><span class="p">)</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="kt">LoginView</span><span class="p">(</span><span class="nv">viewModel</span><span class="p">:</span> <span class="n">viewModel</span><span class="p">)</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p><em>@ViewBuilder</em> also has support for conditions via <em>if</em> and <em>switch</em> expressions.</p>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">struct</span> <span class="kt">ContentView</span><span class="p">:</span> <span class="kt">View</span> <span class="p">{</span>
    <span class="kd">@ObservedObject</span> <span class="k">var</span> <span class="nv">viewModel</span><span class="p">:</span> <span class="kt">ViewModel</span>

    <span class="kd">@ViewBuilder</span>
    <span class="k">var</span> <span class="nv">body</span><span class="p">:</span> <span class="kd">some</span> <span class="kt">View</span> <span class="p">{</span>
        <span class="k">switch</span> <span class="n">viewModel</span><span class="o">.</span><span class="n">isAuthorized</span> <span class="p">{</span>
        <span class="k">case</span> <span class="nv">true</span><span class="p">:</span>
            <span class="kt">Text</span><span class="p">(</span><span class="s">"Hello"</span><span class="p">)</span>
        <span class="k">case</span> <span class="nv">false</span><span class="p">:</span>
            <span class="kt">LoginView</span><span class="p">(</span><span class="nv">viewModel</span><span class="p">:</span> <span class="n">viewModel</span><span class="p">)</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<blockquote>
  <p>To learn how to avoid ten views limitation, take a look at my <a href="/2019/10/30/view-composition-in-swiftui/">“View Composition in SwiftUI”</a> post.</p>
</blockquote>

<h4 id="tupleview">TupleView</h4>
<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">import</span> <span class="kt">SwiftUI</span>

<span class="kd">struct</span> <span class="kt">ContentView</span><span class="p">:</span> <span class="kt">View</span> <span class="p">{</span>
    <span class="k">var</span> <span class="nv">body</span><span class="p">:</span> <span class="kd">some</span> <span class="kt">View</span> <span class="p">{</span>
        <span class="kt">HStack</span><span class="p">{</span>
            <span class="kt">Text</span><span class="p">(</span><span class="s">"hello"</span><span class="p">)</span>
            <span class="kt">Text</span><span class="p">(</span><span class="s">"world"</span><span class="p">)</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="nf">print</span><span class="p">(</span><span class="kt">Mirror</span><span class="p">(</span><span class="nv">reflecting</span><span class="p">:</span> <span class="kt">ContentView</span><span class="p">()</span><span class="o">.</span><span class="n">body</span><span class="p">))</span>
<span class="c1">// Mirror for HStack&lt;TupleView&lt;(Text, Text)&gt;&gt;</span>
</code></pre></div></div>

<p><em>TupleView</em> is a view created from a swift tuple of view values. <em>TupleView</em> doesn’t have any logic inside. It just holds the views. <em>TupleView</em> completely transparent and behaves like its parent view. It means when you put it inside the <em>HStack</em>, <em>TupleView</em> places the views from the tuple in a horizontal direction.</p>

<h4 id="using-viewbuilder">Using @ViewBuilder</h4>
<p>Now we know all the needed things to build our own custom view container, which uses <em>@ViewBuilder</em>. Assume that our app needs a notification view. The notification view should have a consistent design and appear in the top of the screen, but content can be various. It is a perfect use case for <em>@ViewBuilder</em>. Let’s see how we can utilize it.</p>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">import</span> <span class="kt">SwiftUI</span>

<span class="kd">struct</span> <span class="kt">NotificationView</span><span class="o">&lt;</span><span class="kt">Content</span><span class="p">:</span> <span class="kt">View</span><span class="o">&gt;</span><span class="p">:</span> <span class="kt">View</span> <span class="p">{</span>
    <span class="k">let</span> <span class="nv">content</span><span class="p">:</span> <span class="kt">Content</span>

    <span class="nf">init</span><span class="p">(</span><span class="kd">@ViewBuilder</span> <span class="nv">content</span><span class="p">:</span> <span class="p">()</span> <span class="o">-&gt;</span> <span class="kt">Content</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">self</span><span class="o">.</span><span class="n">content</span> <span class="o">=</span> <span class="nf">content</span><span class="p">()</span>
    <span class="p">}</span>

    <span class="k">var</span> <span class="nv">body</span><span class="p">:</span> <span class="kd">some</span> <span class="kt">View</span> <span class="p">{</span>
        <span class="n">content</span>
            <span class="o">.</span><span class="nf">padding</span><span class="p">()</span>
            <span class="o">.</span><span class="nf">background</span><span class="p">(</span><span class="kt">Color</span><span class="p">(</span><span class="o">.</span><span class="n">tertiarySystemBackground</span><span class="p">))</span>
            <span class="o">.</span><span class="nf">cornerRadius</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span>
            <span class="o">.</span><span class="nf">transition</span><span class="p">(</span><span class="o">.</span><span class="nf">move</span><span class="p">(</span><span class="nv">edge</span><span class="p">:</span> <span class="o">.</span><span class="n">top</span><span class="p">))</span>
            <span class="o">.</span><span class="nf">animation</span><span class="p">(</span><span class="o">.</span><span class="nf">spring</span><span class="p">())</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>As you can see, we use <em>@ViewBuilder</em> to mark our content closure. It gives us the opportunity to use <em>NotificationView</em> in the same way as <em>VStack</em> or <em>HStack</em>. Here is the example of using <em>NotificationView</em>.</p>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">import</span> <span class="kt">SwiftUI</span>

<span class="kd">struct</span> <span class="kt">ContentView</span><span class="p">:</span> <span class="kt">View</span> <span class="p">{</span>
    <span class="kd">@State</span> <span class="kd">private</span> <span class="k">var</span> <span class="nv">notificationShown</span> <span class="o">=</span> <span class="kc">false</span>

    <span class="k">var</span> <span class="nv">body</span><span class="p">:</span> <span class="kd">some</span> <span class="kt">View</span> <span class="p">{</span>
        <span class="kt">VStack</span> <span class="p">{</span>
            <span class="k">if</span> <span class="k">self</span><span class="o">.</span><span class="n">notificationShown</span> <span class="p">{</span>
                <span class="kt">NotificationView</span> <span class="p">{</span>
                    <span class="kt">Text</span><span class="p">(</span><span class="s">"notification"</span><span class="p">)</span>
                <span class="p">}</span>
            <span class="p">}</span>

            <span class="kt">Spacer</span><span class="p">()</span>

            <span class="kt">Button</span><span class="p">(</span><span class="s">"toggle"</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">self</span><span class="o">.</span><span class="n">notificationShown</span><span class="o">.</span><span class="nf">toggle</span><span class="p">()</span>
            <span class="p">}</span>

            <span class="kt">Spacer</span><span class="p">()</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<blockquote>
  <p>We also used the ability to build custom views via <em>@ViewBuilder</em> during <a href="/2019/12/11/building-bottom-sheet-in-swiftui/">“Building Bottom sheet in SwiftUI”</a> post.</p>
</blockquote>

<h4 id="conclusion">Conclusion</h4>
<p>This week we talked about the benefits of result builders and used <em>@ViewBuilder</em> as a concrete example. <em>@ViewBuilder</em> allows us to build super reusable SwiftUI views by separating its presentation logic and content. I hope you enjoy the post. Feel free to follow me on <a href="https://twitter.com/mecid">Twitter</a> and ask your questions related to this post. Thanks for reading, and see you next week!</p>

</article>


<aside class="related">
  <h4>Recent posts</h4>
  <ul class="related-posts">
    
      <li>
        <a title="Custom accessibility content in SwiftUI" href="/2021/10/06/custom-accessibility-content-in-swiftui/">
          Custom accessibility content in SwiftUI
          <small><time datetime="2021-10-06T00:00:00+08:00">06 Oct 2021</time></small>
        </a>
      </li>
    
      <li>
        <a title="Audio graphs in SwiftUI" href="/2021/09/29/audio-graphs-in-swiftui/">
          Audio graphs in SwiftUI
          <small><time datetime="2021-09-29T00:00:00+08:00">29 Sep 2021</time></small>
        </a>
      </li>
    
      <li>
        <a title="Accessibility focus in SwiftUI" href="/2021/09/23/accessibility-focus-in-swiftui/">
          Accessibility focus in SwiftUI
          <small><time datetime="2021-09-23T00:00:00+08:00">23 Sep 2021</time></small>
        </a>
      </li>
    
  </ul>
</aside>


      </main>

      <footer class="footer">
          <img class="avatar" alt="mecid" width="100" height="100" data-proofer-ignore="true" src="https://avatars2.githubusercontent.com/mecid?v=3&s=100" srcset="https://avatars2.githubusercontent.com/mecid?v=3&s=100 1x, https://avatars2.githubusercontent.com/mecid?v=3&s=200 2x, https://avatars2.githubusercontent.com/mecid?v=3&s=300 3x, https://avatars2.githubusercontent.com/mecid?v=3&s=400 4x" />
          <small>Hi there! I am code4you,I like to program, and do some App.</small>
          <small>I'm a developer</small>
          <small>Feel free to follow me on <a href="https://github.com/code4you2021">Github</a>.</small>
        <small>
          &copy; <time datetime="2021-10-17T11:25:11+08:00">2021</time>. All rights reserved.
        </small>
      </footer>
    </div>

    
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-1WQVZK1CR7"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-18491817-18');
    </script>
    
  </body>
</html>
