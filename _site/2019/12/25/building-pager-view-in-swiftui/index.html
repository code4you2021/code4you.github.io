<!DOCTYPE html>
<html lang="en">

  <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="keywords" content="swift ios development apple watch iphone ipad swiftui macos uikit dev wwdc tutorial guide redux tea state container" />

  <!-- Begin Jekyll SEO tag v2.7.1 -->
<title>Building Pager view in SwiftUI | Code4You</title>
<meta name="generator" content="Jekyll v3.9.0" />
<meta property="og:title" content="Building Pager view in SwiftUI" />
<meta name="author" content="Code4You" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="This week I want to continue the series of posts about building custom interactive views in SwiftUI. Today we will create a pager view. ScrollView in SwiftUI support only scrolling content and doesn’t have paging behavior. That’s why we will build a pager view that supports paging mode." />
<meta property="og:description" content="This week I want to continue the series of posts about building custom interactive views in SwiftUI. Today we will create a pager view. ScrollView in SwiftUI support only scrolling content and doesn’t have paging behavior. That’s why we will build a pager view that supports paging mode." />
<link rel="canonical" href="http://localhost:4000/2019/12/25/building-pager-view-in-swiftui/" />
<meta property="og:url" content="http://localhost:4000/2019/12/25/building-pager-view-in-swiftui/" />
<meta property="og:site_name" content="Code4You" />
<meta property="og:image" content="http://localhost:4000/public/pager.png" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2019-12-25T00:00:00+08:00" />
<meta name="twitter:card" content="summary_large_image" />
<meta property="twitter:image" content="http://localhost:4000/public/pager.png" />
<meta property="twitter:title" content="Building Pager view in SwiftUI" />
<script type="application/ld+json">
{"@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/2019/12/25/building-pager-view-in-swiftui/"},"url":"http://localhost:4000/2019/12/25/building-pager-view-in-swiftui/","image":"http://localhost:4000/public/pager.png","author":{"@type":"Person","name":"Code4You"},"headline":"Building Pager view in SwiftUI","description":"This week I want to continue the series of posts about building custom interactive views in SwiftUI. Today we will create a pager view. ScrollView in SwiftUI support only scrolling content and doesn’t have paging behavior. That’s why we will build a pager view that supports paging mode.","dateModified":"2019-12-25T00:00:00+08:00","datePublished":"2019-12-25T00:00:00+08:00","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->


  <link rel="stylesheet" href="/styles.css">
  <link rel="shortcut icon" href="/public/favicon.ico">
  <link rel="alternate" type="application/atom+xml" title="Code4You" href="/feed.xml">
</head>


  <body>

    <div class="container content">
      <header class="masthead">
        <nav>
          <h1 class="masthead-title">
            <a href="/" title="Home">Code4You</a>
          </h1>
          <div>
            <a href="/categories" title="Categories">Categories</a>
            <a href="/archive" title="Archive">Archive</a>
            <a href="/feed.xml" title="Feed">Feed</a>
          </div>
        </nav>
      </header>

      <main>
        <article class="post">
  <h2 class="post-title">Building Pager view in SwiftUI</h2>
  <time datetime="2019-12-25T00:00:00+08:00" class="post-date">25 Dec 2019</time>
  <p>This week I want to continue the series of posts about building custom interactive views in SwiftUI. Today we will create a pager view. <em>ScrollView</em> in SwiftUI support only scrolling content and doesn’t have paging behavior. That’s why we will build a pager view that supports paging mode.</p>

<!-- <div class="ads">
    <span>
        Why don’t more iOS apps use voice? Machine learning for voice is hard, and using Siri is clunky and rigid. So we open-sourced an iOS library (also Android, Node, Python, & React Native), and built a no-code web tool to make custom wake words, speech recognizers, and AI voices—for all devs! <a href="https://www.spokestack.io/?utm_source=swiftui_weekly&utm_medium=email&utm_campaign=maker_launch_PAID">Try it for free.</a>
    </span>
</div> -->

<p>Let’s start by describing the <em>PagerView</em> and all the needed properties. First of all, we need the page count, binding to the currently visible page, and the content of pages.</p>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">import</span> <span class="kt">SwiftUI</span>

<span class="kd">struct</span> <span class="kt">PagerView</span><span class="o">&lt;</span><span class="kt">Content</span><span class="p">:</span> <span class="kt">View</span><span class="o">&gt;</span><span class="p">:</span> <span class="kt">View</span> <span class="p">{</span>
    <span class="k">let</span> <span class="nv">pageCount</span><span class="p">:</span> <span class="kt">Int</span>
    <span class="kd">@Binding</span> <span class="k">var</span> <span class="nv">currentIndex</span><span class="p">:</span> <span class="kt">Int</span>
    <span class="k">let</span> <span class="nv">content</span><span class="p">:</span> <span class="kt">Content</span>

    <span class="nf">init</span><span class="p">(</span><span class="nv">pageCount</span><span class="p">:</span> <span class="kt">Int</span><span class="p">,</span> <span class="nv">currentIndex</span><span class="p">:</span> <span class="kt">Binding</span><span class="o">&lt;</span><span class="kt">Int</span><span class="o">&gt;</span><span class="p">,</span> <span class="kd">@ViewBuilder</span> <span class="nv">content</span><span class="p">:</span> <span class="p">()</span> <span class="o">-&gt;</span> <span class="kt">Content</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">self</span><span class="o">.</span><span class="n">pageCount</span> <span class="o">=</span> <span class="n">pageCount</span>
        <span class="k">self</span><span class="o">.</span><span class="n">_currentIndex</span> <span class="o">=</span> <span class="n">currentIndex</span>
        <span class="k">self</span><span class="o">.</span><span class="n">content</span> <span class="o">=</span> <span class="nf">content</span><span class="p">()</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>Again, we use binding to extract the state of the view. It allows us to store the state in the parent view and react to page changes. We also use <em>@ViewBuilder</em> for the content closure. <em>@ViewBuilder</em> enables encapsulation of the presentation logic by keeping content descriptions outside the view. It is a pretty popular technique for any container view in SwiftUI.</p>

<blockquote>
  <p>To learn more about the benefits of @ViewBuilder while building custom SwiftUI view take a look at <a href="/2019/12/18/the-power-of-viewbuilder-in-swiftui/">my dedicated post</a>.</p>
</blockquote>

<p>Now we can build our presentation logic and render the current page. All we need to do is to place our content inside an <em>HStack</em> and set proper offset. Let’s see how easily we can achieve that.</p>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">var</span> <span class="nv">body</span><span class="p">:</span> <span class="kd">some</span> <span class="kt">View</span> <span class="p">{</span>
    <span class="kt">GeometryReader</span> <span class="p">{</span> <span class="n">geometry</span> <span class="k">in</span>
        <span class="kt">HStack</span><span class="p">(</span><span class="nv">spacing</span><span class="p">:</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">self</span><span class="o">.</span><span class="n">content</span><span class="o">.</span><span class="nf">frame</span><span class="p">(</span><span class="nv">width</span><span class="p">:</span> <span class="n">geometry</span><span class="o">.</span><span class="n">size</span><span class="o">.</span><span class="n">width</span><span class="p">)</span>
        <span class="p">}</span>
        <span class="o">.</span><span class="nf">frame</span><span class="p">(</span><span class="nv">width</span><span class="p">:</span> <span class="n">geometry</span><span class="o">.</span><span class="n">size</span><span class="o">.</span><span class="n">width</span><span class="p">,</span> <span class="nv">alignment</span><span class="p">:</span> <span class="o">.</span><span class="n">leading</span><span class="p">)</span>
        <span class="o">.</span><span class="nf">offset</span><span class="p">(</span><span class="nv">x</span><span class="p">:</span> <span class="o">-</span><span class="kt">CGFloat</span><span class="p">(</span><span class="k">self</span><span class="o">.</span><span class="n">currentIndex</span><span class="p">)</span> <span class="o">*</span> <span class="n">geometry</span><span class="o">.</span><span class="n">size</span><span class="o">.</span><span class="n">width</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>In the example above, we use <em>GeometryReader</em> to get information about the parent view’s size and fill the entire place. We also need to set alignment to leading because, by default, frame place the child view in the center. We also use <em>offset</em> modifier to place an active page in the visible area.</p>

<blockquote>
  <p>To learn more about GeometryReader, take a look at <a href="/2019/08/14/building-barchart-with-shape-api-in-swiftui/">“Building BarChart with Shape API in SwiftUI” post</a>.</p>
</blockquote>

<p>Let’s move to the final step and attach the drag gesture to <em>HStack</em> to swipe pages interactively. We need to declare a new view-local state for the gesture to store translation while the gesture is active. We can use translation value to add offset to the <em>HStack</em> to achieve interactive page dragging.</p>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">@GestureState</span> <span class="kd">private</span> <span class="k">var</span> <span class="nv">translation</span><span class="p">:</span> <span class="kt">CGFloat</span> <span class="o">=</span> <span class="mi">0</span>

<span class="k">var</span> <span class="nv">body</span><span class="p">:</span> <span class="kd">some</span> <span class="kt">View</span> <span class="p">{</span>
    <span class="kt">GeometryReader</span> <span class="p">{</span> <span class="n">geometry</span> <span class="k">in</span>
        <span class="kt">HStack</span><span class="p">(</span><span class="nv">spacing</span><span class="p">:</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">self</span><span class="o">.</span><span class="n">content</span><span class="o">.</span><span class="nf">frame</span><span class="p">(</span><span class="nv">width</span><span class="p">:</span> <span class="n">geometry</span><span class="o">.</span><span class="n">size</span><span class="o">.</span><span class="n">width</span><span class="p">)</span>
        <span class="p">}</span>
        <span class="o">.</span><span class="nf">frame</span><span class="p">(</span><span class="nv">width</span><span class="p">:</span> <span class="n">geometry</span><span class="o">.</span><span class="n">size</span><span class="o">.</span><span class="n">width</span><span class="p">,</span> <span class="nv">alignment</span><span class="p">:</span> <span class="o">.</span><span class="n">leading</span><span class="p">)</span>
        <span class="o">.</span><span class="nf">offset</span><span class="p">(</span><span class="nv">x</span><span class="p">:</span> <span class="o">-</span><span class="kt">CGFloat</span><span class="p">(</span><span class="k">self</span><span class="o">.</span><span class="n">currentIndex</span><span class="p">)</span> <span class="o">*</span> <span class="n">geometry</span><span class="o">.</span><span class="n">size</span><span class="o">.</span><span class="n">width</span><span class="p">)</span>
        <span class="o">.</span><span class="nf">offset</span><span class="p">(</span><span class="nv">x</span><span class="p">:</span> <span class="k">self</span><span class="o">.</span><span class="n">translation</span><span class="p">)</span>
        <span class="o">.</span><span class="nf">animation</span><span class="p">(</span><span class="o">.</span><span class="nf">interactiveSpring</span><span class="p">(),</span> <span class="nv">value</span><span class="p">:</span> <span class="n">currentIndex</span><span class="p">)</span>
        <span class="o">.</span><span class="nf">animation</span><span class="p">(</span><span class="o">.</span><span class="nf">interactiveSpring</span><span class="p">(),</span> <span class="nv">value</span><span class="p">:</span> <span class="n">translation</span><span class="p">)</span>
        <span class="o">.</span><span class="nf">gesture</span><span class="p">(</span>
            <span class="kt">DragGesture</span><span class="p">()</span><span class="o">.</span><span class="nf">updating</span><span class="p">(</span><span class="k">self</span><span class="o">.</span><span class="err">$</span><span class="n">translation</span><span class="p">)</span> <span class="p">{</span> <span class="n">value</span><span class="p">,</span> <span class="n">state</span><span class="p">,</span> <span class="n">_</span> <span class="k">in</span>
                <span class="n">state</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">translation</span><span class="o">.</span><span class="n">width</span>
            <span class="p">}</span><span class="o">.</span><span class="n">onEnded</span> <span class="p">{</span> <span class="n">value</span> <span class="k">in</span>
                <span class="k">let</span> <span class="nv">offset</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">translation</span><span class="o">.</span><span class="n">width</span> <span class="o">/</span> <span class="n">geometry</span><span class="o">.</span><span class="n">size</span><span class="o">.</span><span class="n">width</span>
                <span class="k">let</span> <span class="nv">newIndex</span> <span class="o">=</span> <span class="p">(</span><span class="kt">CGFloat</span><span class="p">(</span><span class="k">self</span><span class="o">.</span><span class="n">currentIndex</span><span class="p">)</span> <span class="o">-</span> <span class="n">offset</span><span class="p">)</span><span class="o">.</span><span class="nf">rounded</span><span class="p">()</span>
                <span class="k">self</span><span class="o">.</span><span class="n">currentIndex</span> <span class="o">=</span> <span class="nf">min</span><span class="p">(</span><span class="nf">max</span><span class="p">(</span><span class="kt">Int</span><span class="p">(</span><span class="n">newIndex</span><span class="p">),</span> <span class="mi">0</span><span class="p">),</span> <span class="k">self</span><span class="o">.</span><span class="n">pageCount</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
            <span class="p">}</span>
        <span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>Whenever drag gesture ends, we need to calculate how big was the translation and if it is enough to move to the next or previous pages. We can estimate it straightforwardly by using geometry and some math functions like min, max, and rounding. Let’s finally see how we can use our <em>PagerView</em>.</p>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">struct</span> <span class="kt">ContentView</span><span class="p">:</span> <span class="kt">View</span> <span class="p">{</span>
    <span class="kd">@State</span> <span class="kd">private</span> <span class="k">var</span> <span class="nv">currentPage</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">var</span> <span class="nv">body</span><span class="p">:</span> <span class="kd">some</span> <span class="kt">View</span> <span class="p">{</span>
        <span class="kt">PagerView</span><span class="p">(</span><span class="nv">pageCount</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="nv">currentIndex</span><span class="p">:</span> <span class="err">$</span><span class="n">currentPage</span><span class="p">)</span> <span class="p">{</span>
            <span class="kt">Color</span><span class="o">.</span><span class="n">blue</span>
            <span class="kt">Color</span><span class="o">.</span><span class="n">red</span>
            <span class="kt">Color</span><span class="o">.</span><span class="n">green</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<blockquote>
  <p>Full source code available on <a href="https://gist.github.com/mecid/e0d4d6652ccc8b5737449a01ee8cbc6f">GitHub</a>.</p>
</blockquote>

<p>I enjoy the snapping effect which we have in our view, and it is all possible by using interactive spring. Interactive spring is an animation with a lower response value, intended for driving interactive animations.</p>

<blockquote>
  <p>To learn more about animations and transitions in SwiftUI, take a look at my <a href="/2019/06/26/animations-in-swiftui/">“Animations in SwiftUI” post</a>.</p>
</blockquote>

<h4 id="conclusion">Conclusion</h4>
<p>This week we built another interactive view component in SwiftUI. I feel like it is so easy to build interactive views, all you need to do is declare your state, statically render the state and then attach a gesture which modifies that state. SwiftUI handles all the transitions between states automatically by adding very fluid animations. I hope you enjoy the post. Feel free to follow me on <a href="https://twitter.com/mecid">Twitter</a> and ask your questions related to this post. Thanks for reading, and see you next week!</p>

</article>


<aside class="related">
  <h4>Recent posts</h4>
  <ul class="related-posts">
    
      <li>
        <a title="Custom accessibility content in SwiftUI" href="/2021/10/06/custom-accessibility-content-in-swiftui/">
          Custom accessibility content in SwiftUI
          <small><time datetime="2021-10-06T00:00:00+08:00">06 Oct 2021</time></small>
        </a>
      </li>
    
      <li>
        <a title="Audio graphs in SwiftUI" href="/2021/09/29/audio-graphs-in-swiftui/">
          Audio graphs in SwiftUI
          <small><time datetime="2021-09-29T00:00:00+08:00">29 Sep 2021</time></small>
        </a>
      </li>
    
      <li>
        <a title="Accessibility focus in SwiftUI" href="/2021/09/23/accessibility-focus-in-swiftui/">
          Accessibility focus in SwiftUI
          <small><time datetime="2021-09-23T00:00:00+08:00">23 Sep 2021</time></small>
        </a>
      </li>
    
  </ul>
</aside>


      </main>

      <footer class="footer">
          <img class="avatar" alt="mecid" width="100" height="100" data-proofer-ignore="true" src="https://avatars2.githubusercontent.com/mecid?v=3&s=100" srcset="https://avatars2.githubusercontent.com/mecid?v=3&s=100 1x, https://avatars2.githubusercontent.com/mecid?v=3&s=200 2x, https://avatars2.githubusercontent.com/mecid?v=3&s=300 3x, https://avatars2.githubusercontent.com/mecid?v=3&s=400 4x" />
          <small>Hi there! I am code4you,I like to program, and do some App.</small>
          <small>I'm a developer</small>
          <small>Feel free to follow me on <a href="https://github.com/code4you2021">Github</a>.</small>
        <small>
          &copy; <time datetime="2021-10-17T11:25:11+08:00">2021</time>. All rights reserved.
        </small>
      </footer>
    </div>

    
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-1WQVZK1CR7"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-18491817-18');
    </script>
    
  </body>
</html>
