<!DOCTYPE html>
<html lang="en">

  <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="keywords" content="swift ios development apple watch iphone ipad swiftui macos uikit dev wwdc tutorial guide redux tea state container" />

  <!-- Begin Jekyll SEO tag v2.7.1 -->
<title>Reusing SwiftUI views across Apple platforms | Code4You</title>
<meta name="generator" content="Jekyll v3.9.0" />
<meta property="og:title" content="Reusing SwiftUI views across Apple platforms" />
<meta name="author" content="Code4You" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="This week we will talk about reusing SwiftUI views between Apple platforms. We will learn how to run the same views both on iOS, watchOS and macOS without any changes. To make it possible, all we need is an understanding of the view decomposition principle." />
<meta property="og:description" content="This week we will talk about reusing SwiftUI views between Apple platforms. We will learn how to run the same views both on iOS, watchOS and macOS without any changes. To make it possible, all we need is an understanding of the view decomposition principle." />
<link rel="canonical" href="http://localhost:4000/2019/10/23/reusing-swiftui-views-across-apple-platforms/" />
<meta property="og:url" content="http://localhost:4000/2019/10/23/reusing-swiftui-views-across-apple-platforms/" />
<meta property="og:site_name" content="Code4You" />
<meta property="og:image" content="http://localhost:4000/public/napbot-watch.jpeg" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2019-10-23T00:00:00+08:00" />
<meta name="twitter:card" content="summary_large_image" />
<meta property="twitter:image" content="http://localhost:4000/public/napbot-watch.jpeg" />
<meta property="twitter:title" content="Reusing SwiftUI views across Apple platforms" />
<script type="application/ld+json">
{"@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/2019/10/23/reusing-swiftui-views-across-apple-platforms/"},"url":"http://localhost:4000/2019/10/23/reusing-swiftui-views-across-apple-platforms/","image":"http://localhost:4000/public/napbot-watch.jpeg","author":{"@type":"Person","name":"Code4You"},"headline":"Reusing SwiftUI views across Apple platforms","description":"This week we will talk about reusing SwiftUI views between Apple platforms. We will learn how to run the same views both on iOS, watchOS and macOS without any changes. To make it possible, all we need is an understanding of the view decomposition principle.","dateModified":"2019-10-23T00:00:00+08:00","datePublished":"2019-10-23T00:00:00+08:00","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->


  <link rel="stylesheet" href="/styles.css">
  <link rel="shortcut icon" href="/public/favicon.ico">
  <link rel="alternate" type="application/atom+xml" title="Code4You" href="/feed.xml">
</head>


  <body>

    <div class="container content">
      <header class="masthead">
        <nav>
          <h1 class="masthead-title">
            <a href="/" title="Home">Code4You</a>
          </h1>
          <div>
            <a href="/categories" title="Categories">Categories</a>
            <a href="/archive" title="Archive">Archive</a>
            <a href="/feed.xml" title="Feed">Feed</a>
          </div>
        </nav>
      </header>

      <main>
        <article class="post">
  <h2 class="post-title">Reusing SwiftUI views across Apple platforms</h2>
  <time datetime="2019-10-23T00:00:00+08:00" class="post-date">23 Oct 2019</time>
  <p>This week we will talk about reusing SwiftUI views between Apple platforms. We will learn how to run the same views both on iOS, watchOS and macOS without any changes. To make it possible, all we need is an understanding of the view decomposition principle.</p>

<!-- <div class="ads">
    <span>
        Why don’t more iOS apps use voice? Machine learning for voice is hard, and using Siri is clunky and rigid. So we open-sourced an iOS library (also Android, Node, Python, & React Native), and built a no-code web tool to make custom wake words, speech recognizers, and AI voices—for all devs! <a href="https://www.spokestack.io/?utm_source=swiftui_weekly&utm_medium=email&utm_campaign=maker_launch_PAID">Try it for free.</a>
    </span>
</div> -->

<p>One of the slogans of SwiftUI during <em>WWDC</em> this year was “Learn one time, use anywhere”. SwiftUI is a <em>declarative</em> framework for building <em>User Interfaces</em> on Apple platforms. But what does mean the word <strong>declarative</strong>? It means that you describe what you want to achieve, and the framework does all the needed work for you. Depending on the platform, SwiftUI can render content differently.</p>

<p><img src="/public/napbot.jpeg" alt="napbot-screenshot" /></p>

<p>Last month I had released my <a href="https://napbot.swiftwithmajid.com">NapBot app</a>, which I wrote entirely in SwiftUI. What I really love in this app is the how easy I was able to share my views between iOS and watchOS apps. I was able to run my app on watchOS just in a few minutes by adding a couple of small target checks.</p>

<p>Let’s take a look at a calendar day details screen. It uses a list component as the root view. Inside the list, we have a chart and a bunch of sections with text data. We already talked about creating a bar chart in <a href="/2019/08/14/building-barchart-with-shape-api-in-swiftui/">“Building BarChart with Shape API in SwiftUI”</a> post, check that post if you want to learn more about <em>Shapes API</em>.</p>

<h4 id="if-macro">#if macro</h4>
<p>This screen also has a picker component with the <em>SegmentedPicker</em> style, which allows changing the data represented in the chart. Unfortunately, watchOS doesn’t support <em>SegmentedPicker</em> style. That’s why I decide to remove it from the watchOS app but keep it in the iOS app. We can conditionally include or exclude code by using <strong>#if macro</strong> in SwiftUI. Let’s take a look at the source code of my <em>SleepDetailsView</em>.</p>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="kd">@State</span> <span class="kd">private</span> <span class="k">var</span> <span class="nv">chart</span><span class="p">:</span> <span class="kt">Chart</span> <span class="o">=</span> <span class="o">.</span><span class="n">sleepPhases</span>

    <span class="kd">private</span> <span class="k">var</span> <span class="nv">chartSection</span><span class="p">:</span> <span class="kd">some</span> <span class="kt">View</span> <span class="p">{</span>
        <span class="kt">VStack</span> <span class="p">{</span>
            <span class="cp">#if os(iOS)</span>
            <span class="kt">Picker</span><span class="p">(</span><span class="nv">selection</span><span class="p">:</span> <span class="err">$</span><span class="n">chart</span><span class="p">,</span> <span class="nv">label</span><span class="p">:</span> <span class="kt">Text</span><span class="p">(</span><span class="s">"chartType"</span><span class="p">))</span> <span class="p">{</span>
                <span class="kt">Text</span><span class="p">(</span><span class="s">"phases"</span><span class="p">)</span><span class="o">.</span><span class="nf">tag</span><span class="p">(</span><span class="kt">Chart</span><span class="o">.</span><span class="n">sleepPhases</span><span class="p">)</span>
                <span class="kt">Text</span><span class="p">(</span><span class="s">"heartRate"</span><span class="p">)</span><span class="o">.</span><span class="nf">tag</span><span class="p">(</span><span class="kt">Chart</span><span class="o">.</span><span class="n">heartRate</span><span class="p">)</span>
            <span class="p">}</span>
            <span class="o">.</span><span class="nf">pickerStyle</span><span class="p">(</span><span class="kt">SegmentedPickerStyle</span><span class="p">())</span>
            <span class="o">.</span><span class="nf">labelsHidden</span><span class="p">()</span>
            <span class="cp">#endif</span>

            <span class="kt">BarChartView</span><span class="p">(</span><span class="nv">bars</span><span class="p">:</span> <span class="n">bars</span><span class="p">,</span> <span class="nv">labelsCount</span><span class="p">:</span> <span class="mi">5</span><span class="p">)</span>
                <span class="o">.</span><span class="nf">frame</span><span class="p">(</span><span class="nv">height</span><span class="p">:</span> <span class="mi">280</span><span class="p">)</span>
        <span class="p">}</span>
    <span class="p">}</span>
</code></pre></div></div>

<p>As you can see in the example above, we keep the picker component in the view hierarchy only when we build it for iOS. Swift compiler will exclude these lines during the watch app build process.</p>

<h4 id="container-views">Container views</h4>
<p>Another problem while adopting the sleep details screen to watchOS was a <em>NavigationBarItems</em>. watchOS doesn’t have support for navigation bar items at all. Fortunately, I’m a huge fan of the <em>Container Views</em> concept, which allows us to get rid of this problem.</p>

<p><em>Container View</em> is a view that handles the data flow and doesn’t render any <em>User Interface</em> itself. Instead, <em>Container View</em> fetches the data and passes it to a <em>Rendering View</em>. We already talked about <em>Container Views</em> a few times on my blog. Please check the <a href="/2019/07/31/introducing-container-views-in-swiftui/">“Introducing Container views in SwiftUI”</a> post to learn more.</p>

<p>I have a <em>SleepDetailsContainer</em> and <em>SleepDetailsView</em>. <em>SleepDetailsContainer</em> controls the data flow and passes data to <em>SleepDetailsView</em>. <em>SleepDetailsView</em> simply renders the data. Here is the source code of these two views.</p>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">struct</span> <span class="kt">SleepDetailsContainer</span><span class="p">:</span> <span class="kt">View</span> <span class="p">{</span>
    <span class="kd">@EnvironmentObject</span> <span class="k">var</span> <span class="nv">store</span><span class="p">:</span> <span class="kt">SleepStore</span>

    <span class="k">var</span> <span class="nv">body</span><span class="p">:</span> <span class="kd">some</span> <span class="kt">View</span> <span class="p">{</span>
        <span class="kt">SleepDetailsView</span><span class="p">(</span><span class="nv">sleep</span><span class="p">:</span> <span class="n">store</span><span class="o">.</span><span class="n">sleep</span><span class="p">)</span>
            <span class="o">.</span><span class="nf">onAppear</span><span class="p">(</span><span class="nv">perform</span><span class="p">:</span> <span class="n">store</span><span class="o">.</span><span class="n">fetch</span><span class="p">)</span>
            <span class="o">.</span><span class="nf">navigationBarItems</span><span class="p">(</span><span class="nv">trailing</span><span class="p">:</span> <span class="kt">EditButton</span><span class="p">())</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kd">struct</span> <span class="kt">SleepDetailsView</span><span class="p">:</span> <span class="kt">View</span> <span class="p">{</span>
    <span class="k">let</span> <span class="nv">sleep</span><span class="p">:</span> <span class="kt">Sleep</span>

    <span class="k">var</span> <span class="nv">body</span><span class="p">:</span> <span class="kd">some</span> <span class="kt">View</span> <span class="p">{</span>
        <span class="kt">Form</span> <span class="p">{</span>
            <span class="n">chartSection</span>
            <span class="n">durationSection</span>
            <span class="n">phasesSection</span>
            <span class="n">heartRateSection</span>
            <span class="n">noiseSection</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>In this case, we have <em>SleepDetailsView</em>, which is fully compatible with watchOS. All we need is creating a new version of <em>SleepDetailsContainer</em> for watchOS, which doesn’t use navigation items. And here is the result.</p>

<p><img src="/public/napbot-watch.jpeg" alt="napbot-watch-screenshot" /></p>

<h4 id="conclusion">Conclusion</h4>
<p>Today we learned how to reuse SwiftUI views on all Apple platforms with the minimum amount of changes. <em>Container Views</em> concept is still one of my favorite patterns, which I use a lot while developing SwiftUI apps. I hope you enjoy the post. Feel free to follow me on <a href="https://twitter.com/mecid">Twitter</a> and ask your questions related to this post. Thanks for reading, and see you next week!</p>

</article>


<aside class="related">
  <h4>Recent posts</h4>
  <ul class="related-posts">
    
      <li>
        <a title="Custom accessibility content in SwiftUI" href="/2021/10/06/custom-accessibility-content-in-swiftui/">
          Custom accessibility content in SwiftUI
          <small><time datetime="2021-10-06T00:00:00+08:00">06 Oct 2021</time></small>
        </a>
      </li>
    
      <li>
        <a title="Audio graphs in SwiftUI" href="/2021/09/29/audio-graphs-in-swiftui/">
          Audio graphs in SwiftUI
          <small><time datetime="2021-09-29T00:00:00+08:00">29 Sep 2021</time></small>
        </a>
      </li>
    
      <li>
        <a title="Accessibility focus in SwiftUI" href="/2021/09/23/accessibility-focus-in-swiftui/">
          Accessibility focus in SwiftUI
          <small><time datetime="2021-09-23T00:00:00+08:00">23 Sep 2021</time></small>
        </a>
      </li>
    
  </ul>
</aside>


      </main>

      <footer class="footer">
          <img class="avatar" alt="mecid" width="100" height="100" data-proofer-ignore="true" src="https://avatars2.githubusercontent.com/mecid?v=3&s=100" srcset="https://avatars2.githubusercontent.com/mecid?v=3&s=100 1x, https://avatars2.githubusercontent.com/mecid?v=3&s=200 2x, https://avatars2.githubusercontent.com/mecid?v=3&s=300 3x, https://avatars2.githubusercontent.com/mecid?v=3&s=400 4x" />
          <small>Hi there! I am code4you,I like to program, and do some App.</small>
          <small>I'm a developer</small>
          <small>Feel free to follow me on <a href="https://github.com/code4you2021">Github</a>.</small>
        <small>
          &copy; <time datetime="2021-10-17T11:25:11+08:00">2021</time>. All rights reserved.
        </small>
      </footer>
    </div>

    
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-1WQVZK1CR7"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-18491817-18');
    </script>
    
  </body>
</html>
