<!DOCTYPE html>
<html lang="en">

  <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="keywords" content="swift ios development apple watch iphone ipad swiftui macos uikit dev wwdc tutorial guide redux tea state container" />

  <!-- Begin Jekyll SEO tag v2.7.1 -->
<title>Redux-like state container in SwiftUI. Container Views. | Code4You</title>
<meta name="generator" content="Jekyll v3.9.0" />
<meta property="og:title" content="Redux-like state container in SwiftUI. Container Views." />
<meta name="author" content="Code4You" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="This week I want to continue the topic of using a Redux-like state container in SwiftUI. I’m delighted with the new approach and already finished the refactoring of the NapBot app in this way. That’s why today I want to share with you how I use Container Views with a state container similar to Redux." />
<meta property="og:description" content="This week I want to continue the topic of using a Redux-like state container in SwiftUI. I’m delighted with the new approach and already finished the refactoring of the NapBot app in this way. That’s why today I want to share with you how I use Container Views with a state container similar to Redux." />
<link rel="canonical" href="http://localhost:4000/2019/10/02/redux-like-state-container-in-swiftui-part3/" />
<meta property="og:url" content="http://localhost:4000/2019/10/02/redux-like-state-container-in-swiftui-part3/" />
<meta property="og:site_name" content="Code4You" />
<meta property="og:image" content="http://localhost:4000/public/store.png" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2019-10-02T00:00:00+08:00" />
<meta name="twitter:card" content="summary_large_image" />
<meta property="twitter:image" content="http://localhost:4000/public/store.png" />
<meta property="twitter:title" content="Redux-like state container in SwiftUI. Container Views." />
<script type="application/ld+json">
{"@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/2019/10/02/redux-like-state-container-in-swiftui-part3/"},"url":"http://localhost:4000/2019/10/02/redux-like-state-container-in-swiftui-part3/","image":"http://localhost:4000/public/store.png","author":{"@type":"Person","name":"Code4You"},"headline":"Redux-like state container in SwiftUI. Container Views.","description":"This week I want to continue the topic of using a Redux-like state container in SwiftUI. I’m delighted with the new approach and already finished the refactoring of the NapBot app in this way. That’s why today I want to share with you how I use Container Views with a state container similar to Redux.","dateModified":"2019-10-02T00:00:00+08:00","datePublished":"2019-10-02T00:00:00+08:00","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->


  <link rel="stylesheet" href="/styles.css">
  <link rel="shortcut icon" href="/public/favicon.ico">
  <link rel="alternate" type="application/atom+xml" title="Code4You" href="/feed.xml">
</head>


  <body>

    <div class="container content">
      <header class="masthead">
        <nav>
          <h1 class="masthead-title">
            <a href="/" title="Home">Code4You</a>
          </h1>
          <div>
            <a href="/categories" title="Categories">Categories</a>
            <a href="/archive" title="Archive">Archive</a>
            <a href="/feed.xml" title="Feed">Feed</a>
          </div>
        </nav>
      </header>

      <main>
        <article class="post">
  <h2 class="post-title">Redux-like state container in SwiftUI. Container Views.</h2>
  <time datetime="2019-10-02T00:00:00+08:00" class="post-date">02 Oct 2019</time>
  <p>This week I want to continue the topic of using a <em>Redux-like state container in SwiftUI</em>. I’m delighted with the new approach and already finished the refactoring of the <a href="https://napbot.swiftwithmajid.com">NapBot app</a> in this way. That’s why today I want to share with you how I use <em>Container Views</em> with a state container similar to <em>Redux</em>.</p>

<!-- <div class="ads">
    <span>
        Why don’t more iOS apps use voice? Machine learning for voice is hard, and using Siri is clunky and rigid. So we open-sourced an iOS library (also Android, Node, Python, & React Native), and built a no-code web tool to make custom wake words, speech recognizers, and AI voices—for all devs! <a href="https://www.spokestack.io/?utm_source=swiftui_weekly&utm_medium=email&utm_campaign=maker_launch_PAID">Try it for free.</a>
    </span>
</div> -->

<p>In previous weeks we already discussed the basics and some good practices while using <em>Redux-like state containers</em>. If you are not familiar with <em>Redux</em>, please take a look at those posts to understand how to build it in SwiftUI and which benefits you get by using it.</p>

<ol>
  <li><a href="/2019/09/18/redux-like-state-container-in-swiftui/">Redux-like state container in SwiftUI. Basics</a></li>
  <li><a href="/2019/09/25/redux-like-state-container-in-swiftui-part2/">Redux-like state container in SwiftUI. Best practices</a></li>
</ol>

<p>The container which holds the whole app’s state as a single source of truth simplifies my codebase and eliminates a bunch of bugs that I had during manual sync between multiple states across the app screens.</p>

<blockquote>
  <p>To learn more about modeling app state using multiple store objects, take a look at my dedicated <a href="/2019/09/04/modeling-app-state-using-store-objects-in-swiftui/">“Modeling app state using Store objects in SwiftUI”</a> post.</p>
</blockquote>

<h4 id="container-views">Container Views</h4>
<p>Today, I want to touch another subject from my previous posts which plays very nice in conjunction with a <em>Redux-like state container</em>, and this is <em>Container Views</em>. <em>Container Views</em> help us to keep our SwiftUI views simple and responsible for only one job.</p>

<p>The main idea is dividing your views into two types: <em>Container Views and Rendering Views</em>. The <em>Rendering View</em> is responsible for drawing the content, and that’s all. So basically it should not store the state or handle any lifecycle event. It usually renders the data which you pass via the init method.</p>

<p><em>Container View</em>, on another hand, is responsible for handling data-flow and lifecycle events by providing the functions/closures to a <em>Rendering View</em>. Let’s take a look at a simple example.</p>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">import</span> <span class="kt">SwiftUI</span>

<span class="kd">struct</span> <span class="kt">SearchContainerView</span><span class="p">:</span> <span class="kt">View</span> <span class="p">{</span>
    <span class="kd">@EnvironmentObject</span> <span class="k">var</span> <span class="nv">store</span><span class="p">:</span> <span class="kt">ReposStore</span>
    <span class="kd">@State</span> <span class="kd">private</span> <span class="k">var</span> <span class="nv">query</span><span class="p">:</span> <span class="kt">String</span> <span class="o">=</span> <span class="s">"Swift"</span>

    <span class="k">var</span> <span class="nv">body</span><span class="p">:</span> <span class="kd">some</span> <span class="kt">View</span> <span class="p">{</span>
        <span class="kt">SearchView</span><span class="p">(</span><span class="nv">query</span><span class="p">:</span> <span class="err">$</span><span class="n">query</span><span class="p">,</span> <span class="nv">repos</span><span class="p">:</span> <span class="n">store</span><span class="o">.</span><span class="n">repos</span><span class="p">,</span> <span class="nv">onCommit</span><span class="p">:</span> <span class="n">fetch</span><span class="p">)</span>
            <span class="o">.</span><span class="nf">onAppear</span><span class="p">(</span><span class="nv">perform</span><span class="p">:</span> <span class="n">fetch</span><span class="p">)</span>
    <span class="p">}</span>

    <span class="kd">private</span> <span class="kd">func</span> <span class="nf">fetch</span><span class="p">()</span> <span class="p">{</span>
        <span class="n">store</span><span class="o">.</span><span class="nf">fetch</span><span class="p">(</span><span class="nv">matching</span><span class="p">:</span> <span class="n">query</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kd">struct</span> <span class="kt">SearchView</span><span class="p">:</span> <span class="kt">View</span> <span class="p">{</span>
    <span class="kd">@Binding</span> <span class="k">var</span> <span class="nv">query</span><span class="p">:</span> <span class="kt">String</span>

    <span class="k">let</span> <span class="nv">repos</span><span class="p">:</span> <span class="p">[</span><span class="kt">Repo</span><span class="p">]</span>
    <span class="k">let</span> <span class="nv">onCommit</span><span class="p">:</span> <span class="p">()</span> <span class="o">-&gt;</span> <span class="kt">Void</span>

    <span class="k">var</span> <span class="nv">body</span><span class="p">:</span> <span class="kd">some</span> <span class="kt">View</span> <span class="p">{</span>
        <span class="kt">List</span> <span class="p">{</span>
            <span class="kt">TextField</span><span class="p">(</span><span class="s">"Type something"</span><span class="p">,</span> <span class="nv">text</span><span class="p">:</span> <span class="err">$</span><span class="n">query</span><span class="p">,</span> <span class="nv">onCommit</span><span class="p">:</span> <span class="n">onCommit</span><span class="p">)</span>
            <span class="kt">ReposView</span><span class="p">(</span><span class="nv">repos</span><span class="p">:</span> <span class="n">repos</span><span class="p">)</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kd">struct</span> <span class="kt">ReposView</span><span class="p">:</span> <span class="kt">View</span> <span class="p">{</span>
    <span class="k">let</span> <span class="nv">repos</span><span class="p">:</span> <span class="p">[</span><span class="kt">Repo</span><span class="p">]</span>

    <span class="k">var</span> <span class="nv">body</span><span class="p">:</span> <span class="kd">some</span> <span class="kt">View</span> <span class="p">{</span>
        <span class="kt">ForEach</span><span class="p">(</span><span class="n">repos</span><span class="p">)</span> <span class="p">{</span> <span class="n">repo</span> <span class="k">in</span>
            <span class="kt">HStack</span><span class="p">(</span><span class="nv">alignment</span><span class="p">:</span> <span class="o">.</span><span class="n">top</span><span class="p">)</span> <span class="p">{</span>
                <span class="kt">VStack</span><span class="p">(</span><span class="nv">alignment</span><span class="p">:</span> <span class="o">.</span><span class="n">leading</span><span class="p">)</span> <span class="p">{</span>
                    <span class="kt">Text</span><span class="p">(</span><span class="n">repo</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
                        <span class="o">.</span><span class="nf">font</span><span class="p">(</span><span class="o">.</span><span class="n">headline</span><span class="p">)</span>
                    <span class="kt">Text</span><span class="p">(</span><span class="n">repo</span><span class="o">.</span><span class="n">description</span> <span class="p">??</span> <span class="s">""</span><span class="p">)</span>
                        <span class="o">.</span><span class="nf">font</span><span class="p">(</span><span class="o">.</span><span class="n">subheadline</span><span class="p">)</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>In the example above, you can see how we build a connection between <em>Container and Rendering views</em>. <em>Container View</em> provides the data to <em>Rendering Views</em>. By doing this, we can easily reuse our <em>ReposView</em> anywhere across the app. <em>ReposView</em> doesn’t have any dependency on some state or datastore and gets all the needed data via the init method.</p>

<blockquote>
  <p>To learn more about <em>Container Views</em>, take a look at <a href="/2019/07/31/introducing-container-views-in-swiftui/">“Introducing Container views in SwiftUI” post</a>.</p>
</blockquote>

<h4 id="using-container-views-with-redux-like-state-container">Using Container Views with Redux-like state container</h4>
<p>During my transition from multiple stores to a single source of truth, I realize that <em>Container Views</em> play a significant role in this approach. I mainly use them for sending actions to the store and mapping the global app state to <em>Rendering View</em> properties. <em>Container Views</em> perfectly fit into my current app architecture. Let’s take a look at the example.</p>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">import</span> <span class="kt">SwiftUI</span>

<span class="kd">struct</span> <span class="kt">SearchContainerView</span><span class="p">:</span> <span class="kt">View</span> <span class="p">{</span>
    <span class="kd">@EnvironmentObject</span> <span class="k">var</span> <span class="nv">store</span><span class="p">:</span> <span class="kt">AppStore</span>
    <span class="kd">@State</span> <span class="kd">private</span> <span class="k">var</span> <span class="nv">query</span><span class="p">:</span> <span class="kt">String</span> <span class="o">=</span> <span class="s">"Swift"</span>

    <span class="k">var</span> <span class="nv">body</span><span class="p">:</span> <span class="kd">some</span> <span class="kt">View</span> <span class="p">{</span>
        <span class="kt">SearchView</span><span class="p">(</span>
            <span class="nv">query</span><span class="p">:</span> <span class="err">$</span><span class="n">query</span><span class="p">,</span>
            <span class="nv">repos</span><span class="p">:</span> <span class="n">store</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">search</span><span class="o">.</span><span class="n">result</span><span class="p">,</span>
            <span class="nv">onCommit</span><span class="p">:</span> <span class="n">fetch</span>
        <span class="p">)</span><span class="o">.</span><span class="nf">onAppear</span><span class="p">(</span><span class="nv">perform</span><span class="p">:</span> <span class="n">fetch</span><span class="p">)</span>
    <span class="p">}</span>

    <span class="kd">private</span> <span class="kd">func</span> <span class="nf">fetch</span><span class="p">()</span> <span class="p">{</span>
        <span class="n">store</span><span class="o">.</span><span class="nf">send</span><span class="p">(</span><span class="kt">SideEffect</span><span class="o">.</span><span class="nf">search</span><span class="p">(</span><span class="n">query</span><span class="p">))</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kd">struct</span> <span class="kt">SearchView</span><span class="p">:</span> <span class="kt">View</span> <span class="p">{</span>
    <span class="kd">@Binding</span> <span class="k">var</span> <span class="nv">query</span><span class="p">:</span> <span class="kt">String</span>

    <span class="k">let</span> <span class="nv">repos</span><span class="p">:</span> <span class="p">[</span><span class="kt">Repo</span><span class="p">]</span>
    <span class="k">let</span> <span class="nv">onCommit</span><span class="p">:</span> <span class="p">()</span> <span class="o">-&gt;</span> <span class="kt">Void</span>

    <span class="k">var</span> <span class="nv">body</span><span class="p">:</span> <span class="kd">some</span> <span class="kt">View</span> <span class="p">{</span>
        <span class="kt">List</span> <span class="p">{</span>
            <span class="kt">TextField</span><span class="p">(</span><span class="s">"Type something"</span><span class="p">,</span> <span class="nv">text</span><span class="p">:</span> <span class="err">$</span><span class="n">query</span><span class="p">,</span> <span class="nv">onCommit</span><span class="p">:</span> <span class="n">onCommit</span><span class="p">)</span>
            <span class="kt">ReposView</span><span class="p">(</span><span class="nv">repos</span><span class="p">:</span> <span class="n">repos</span><span class="p">)</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>As you can see in the example above, <em>Container View</em> helps us to keep <em>Rendering Views</em> small and independent.</p>

<h4 id="conclusion">Conclusion</h4>
<p>Today we talked about the benefits of using <em>Container Views with Redux-like state containers</em>. I love this approach and use it as my main way to go with SwiftUI. I hope you enjoy the post. Feel free to follow me on <a href="https://twitter.com/mecid">Twitter</a> and ask your questions related to this post. Thanks for reading and see you next week!</p>

<ol>
  <li><a href="/2019/09/18/redux-like-state-container-in-swiftui/">Redux-like state container in SwiftUI. Basics</a></li>
  <li><a href="/2019/09/25/redux-like-state-container-in-swiftui-part2/">Redux-like state container in SwiftUI. Best practices</a></li>
  <li>Redux-like state container in SwiftUI. Container Views.</li>
  <li><a href="/2021/02/03/redux-like-state-container-in-swiftui-part4/">Redux-like state container in SwiftUI. Connectors.</a></li>
</ol>

<h4 id="references">References</h4>
<p>The series of posts have built on a foundation of ideas started by other libraries, particularly Redux, Elm, and TCA.</p>
<ol>
  <li><a href="https://developer.apple.com/videos/play/wwdc2020/10040/">WWDC20 - Data Essentials in SwiftUI</a></li>
  <li><a href="https://redux.js.org">Redux</a> - The JavaScript library that popularized unidirectional data flow.</li>
  <li><a href="https://guide.elm-lang.org/architecture/">The Elm Architecture</a> - A purely functional language and runtime that inspired the creation of Redux.</li>
  <li><a href="https://github.com/pointfreeco/swift-composable-architecture">The Composable Architecture</a> - A library that bridges concepts from the Elm Architecture and Redux to Swift. It introduced the “environment” and “effect” patterns that this series covers.</li>
</ol>

</article>


<aside class="related">
  <h4>Recent posts</h4>
  <ul class="related-posts">
    
      <li>
        <a title="Custom accessibility content in SwiftUI" href="/2021/10/06/custom-accessibility-content-in-swiftui/">
          Custom accessibility content in SwiftUI
          <small><time datetime="2021-10-06T00:00:00+08:00">06 Oct 2021</time></small>
        </a>
      </li>
    
      <li>
        <a title="Audio graphs in SwiftUI" href="/2021/09/29/audio-graphs-in-swiftui/">
          Audio graphs in SwiftUI
          <small><time datetime="2021-09-29T00:00:00+08:00">29 Sep 2021</time></small>
        </a>
      </li>
    
      <li>
        <a title="Accessibility focus in SwiftUI" href="/2021/09/23/accessibility-focus-in-swiftui/">
          Accessibility focus in SwiftUI
          <small><time datetime="2021-09-23T00:00:00+08:00">23 Sep 2021</time></small>
        </a>
      </li>
    
  </ul>
</aside>


      </main>

      <footer class="footer">
          <img class="avatar" alt="mecid" width="100" height="100" data-proofer-ignore="true" src="https://avatars2.githubusercontent.com/mecid?v=3&s=100" srcset="https://avatars2.githubusercontent.com/mecid?v=3&s=100 1x, https://avatars2.githubusercontent.com/mecid?v=3&s=200 2x, https://avatars2.githubusercontent.com/mecid?v=3&s=300 3x, https://avatars2.githubusercontent.com/mecid?v=3&s=400 4x" />
          <small>Hi there! I am code4you,I like to program, and do some App.</small>
          <small>I'm a developer</small>
          <small>Feel free to follow me on <a href="https://github.com/code4you2021">Github</a>.</small>
        <small>
          &copy; <time datetime="2021-10-17T11:25:11+08:00">2021</time>. All rights reserved.
        </small>
      </footer>
    </div>

    
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-1WQVZK1CR7"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-18491817-18');
    </script>
    
  </body>
</html>
