<!DOCTYPE html>
<html lang="en">

  <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="keywords" content="swift ios development apple watch iphone ipad swiftui macos uikit dev wwdc tutorial guide redux tea state container" />

  <!-- Begin Jekyll SEO tag v2.7.1 -->
<title>Mastering AsyncImage in SwiftUI | Code4You</title>
<meta name="generator" content="Jekyll v3.9.0" />
<meta property="og:title" content="Mastering AsyncImage in SwiftUI" />
<meta name="author" content="Code4You" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="During our careers, we primarily build apps that work with web services to retrieve and upload data. Remote image is one type of that data that we need to download and display. SwiftUI provides us the AsyncImage type, which is a view that downloads and shows an image via URL. This week we learn how to use and customize AsyncImage in SwiftUI." />
<meta property="og:description" content="During our careers, we primarily build apps that work with web services to retrieve and upload data. Remote image is one type of that data that we need to download and display. SwiftUI provides us the AsyncImage type, which is a view that downloads and shows an image via URL. This week we learn how to use and customize AsyncImage in SwiftUI." />
<link rel="canonical" href="http://localhost:4000/2021/07/07/mastering-asyncimage-in-swiftui/" />
<meta property="og:url" content="http://localhost:4000/2021/07/07/mastering-asyncimage-in-swiftui/" />
<meta property="og:site_name" content="Code4You" />
<meta property="og:image" content="http://localhost:4000/public/wwdc21-v3.jpg" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2021-07-07T00:00:00+08:00" />
<meta name="twitter:card" content="summary_large_image" />
<meta property="twitter:image" content="http://localhost:4000/public/wwdc21-v3.jpg" />
<meta property="twitter:title" content="Mastering AsyncImage in SwiftUI" />
<script type="application/ld+json">
{"@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/2021/07/07/mastering-asyncimage-in-swiftui/"},"url":"http://localhost:4000/2021/07/07/mastering-asyncimage-in-swiftui/","image":"http://localhost:4000/public/wwdc21-v3.jpg","author":{"@type":"Person","name":"Code4You"},"headline":"Mastering AsyncImage in SwiftUI","description":"During our careers, we primarily build apps that work with web services to retrieve and upload data. Remote image is one type of that data that we need to download and display. SwiftUI provides us the AsyncImage type, which is a view that downloads and shows an image via URL. This week we learn how to use and customize AsyncImage in SwiftUI.","dateModified":"2021-07-07T00:00:00+08:00","datePublished":"2021-07-07T00:00:00+08:00","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->


  <link rel="stylesheet" href="/styles.css">
  <link rel="shortcut icon" href="/public/favicon.ico">
  <link rel="alternate" type="application/atom+xml" title="Code4You" href="/feed.xml">
</head>


  <body>

    <div class="container content">
      <header class="masthead">
        <nav>
          <h1 class="masthead-title">
            <a href="/" title="Home">Code4You</a>
          </h1>
          <div>
            <a href="/categories" title="Categories">Categories</a>
            <a href="/archive" title="Archive">Archive</a>
            <a href="/feed.xml" title="Feed">Feed</a>
          </div>
        </nav>
      </header>

      <main>
        <article class="post">
  <h2 class="post-title">Mastering AsyncImage in SwiftUI</h2>
  <time datetime="2021-07-07T00:00:00+08:00" class="post-date">07 Jul 2021</time>
  <p>During our careers, we primarily build apps that work with web services to retrieve and upload data. Remote image is one type of that data that we need to download and display. SwiftUI provides us the <em>AsyncImage</em> type, which is a view that downloads and shows an image via URL. This week we learn how to use and customize <em>AsyncImage</em> in SwiftUI.</p>

<!-- <div class="ads">
    <span>
        Why don’t more iOS apps use voice? Machine learning for voice is hard, and using Siri is clunky and rigid. So we open-sourced an iOS library (also Android, Node, Python, & React Native), and built a no-code web tool to make custom wake words, speech recognizers, and AI voices—for all devs! <a href="https://www.spokestack.io/?utm_source=swiftui_weekly&utm_medium=email&utm_campaign=maker_launch_PAID">Try it for free.</a>
    </span>
</div> -->

<h4 id="basics">Basics</h4>
<p>Let’s start with a quick example that shows how to use <em>AsyncImage</em>.</p>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">struct</span> <span class="kt">AvatarView</span><span class="p">:</span> <span class="kt">View</span> <span class="p">{</span>
    <span class="k">let</span> <span class="nv">url</span><span class="p">:</span> <span class="kt">URL</span>

    <span class="k">var</span> <span class="nv">body</span><span class="p">:</span> <span class="kd">some</span> <span class="kt">View</span> <span class="p">{</span>
        <span class="kt">AsyncImage</span><span class="p">(</span><span class="nv">url</span><span class="p">:</span> <span class="n">url</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>As you can see in the example above, <em>AsyncImage</em> is a SwiftUI view that takes a URL for an image, downloads it, and displays it. There is no need for additional configuration of the network layer. <em>AsyncImage</em> uses the shared <em>URLSession</em> to download and cache images. Unfortunately, we can’t provide a custom <em>URLCache</em> or somehow customize a <em>URLRequest</em> that downloads the image.</p>

<p><em>AsyncImage</em> is another SwiftUI view which means you can attach any set of view modifiers to have the desired look and feel. For example, we can clip the shape of our image and set the size.</p>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">struct</span> <span class="kt">AvatarView</span><span class="p">:</span> <span class="kt">View</span> <span class="p">{</span>
    <span class="k">let</span> <span class="nv">url</span><span class="p">:</span> <span class="kt">URL</span>

    <span class="k">var</span> <span class="nv">body</span><span class="p">:</span> <span class="kd">some</span> <span class="kt">View</span> <span class="p">{</span>
        <span class="kt">AsyncImage</span><span class="p">(</span><span class="nv">url</span><span class="p">:</span> <span class="n">url</span><span class="p">)</span>
            <span class="o">.</span><span class="nf">frame</span><span class="p">(</span><span class="nv">width</span><span class="p">:</span> <span class="mi">44</span><span class="p">,</span> <span class="nv">height</span><span class="p">:</span> <span class="mi">44</span><span class="p">)</span>
            <span class="o">.</span><span class="nf">background</span><span class="p">(</span><span class="kt">Color</span><span class="o">.</span><span class="n">gray</span><span class="p">)</span>
            <span class="o">.</span><span class="nf">clipShape</span><span class="p">(</span><span class="kt">Circle</span><span class="p">())</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<h4 id="customization">Customization</h4>
<p>Usually, we need to customize the size of the downloaded image, scaling options, rendering mode, etc. We can access the instance of underlining image using another overload of <em>AsyncImage</em> initializer.</p>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="kt">AsyncImage</span><span class="p">(</span><span class="nv">url</span><span class="p">:</span> <span class="n">url</span><span class="p">)</span> <span class="p">{</span> <span class="n">image</span> <span class="k">in</span>
        <span class="n">image</span>
            <span class="o">.</span><span class="nf">resizable</span><span class="p">()</span>
            <span class="o">.</span><span class="nf">scaledToFill</span><span class="p">()</span>
    <span class="p">}</span> <span class="nv">placeholder</span><span class="p">:</span> <span class="p">{</span>
        <span class="kt">ProgressView</span><span class="p">()</span>
    <span class="p">}</span>
    <span class="o">.</span><span class="nf">frame</span><span class="p">(</span><span class="nv">width</span><span class="p">:</span> <span class="mi">44</span><span class="p">,</span> <span class="nv">height</span><span class="p">:</span> <span class="mi">44</span><span class="p">)</span>
    <span class="o">.</span><span class="nf">background</span><span class="p">(</span><span class="kt">Color</span><span class="o">.</span><span class="n">gray</span><span class="p">)</span>
    <span class="o">.</span><span class="nf">clipShape</span><span class="p">(</span><span class="kt">Circle</span><span class="p">())</span>
</code></pre></div></div>

<p>Here we use another <em>AsyncImage</em> initializer to access the downloaded image, make it resizable and apply the filling content mode. This initializer also allows us to provide a placeholder view that SwiftUI displays while downloading the image.</p>

<blockquote>
  <p>To learn more about image rendering options in SwiftUI, take a look at my <a href="/2020/05/27/mastering-images-in-swiftui/">“Mastering images in SwiftUI”</a> post.</p>
</blockquote>

<p>Keep in mind that this initializer uses a <em>ViewBuilder</em> closure which means you can take advantage of any SwiftUI view modifier you need and build a super custom presentation.</p>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="kt">AsyncImage</span><span class="p">(</span><span class="nv">url</span><span class="p">:</span> <span class="n">url</span><span class="p">)</span> <span class="p">{</span> <span class="n">image</span> <span class="k">in</span>
        <span class="n">image</span>
            <span class="o">.</span><span class="nf">resizable</span><span class="p">()</span>
            <span class="o">.</span><span class="nf">scaledToFill</span><span class="p">()</span>
            <span class="o">.</span><span class="nf">overlay</span><span class="p">(</span><span class="kt">Material</span><span class="o">.</span><span class="n">ultraThin</span><span class="p">)</span>
    <span class="p">}</span> <span class="nv">placeholder</span><span class="p">:</span> <span class="p">{</span>
        <span class="kt">ProgressView</span><span class="p">()</span>
    <span class="p">}</span>
    <span class="o">.</span><span class="nf">frame</span><span class="p">(</span><span class="nv">width</span><span class="p">:</span> <span class="mi">44</span><span class="p">,</span> <span class="nv">height</span><span class="p">:</span> <span class="mi">44</span><span class="p">)</span>
    <span class="o">.</span><span class="nf">background</span><span class="p">(</span><span class="kt">Color</span><span class="o">.</span><span class="n">gray</span><span class="p">)</span>
    <span class="o">.</span><span class="nf">clipShape</span><span class="p">(</span><span class="kt">Circle</span><span class="p">())</span>
</code></pre></div></div>

<p>In the example above, we use the <em>overlay</em> view modifier to cover our image with the ultra-thin material that creates a light blur effect.</p>

<blockquote>
  <p>To learn more about the logic behind the ViewBuilder type, take a look at my <a href="/2019/12/18/the-power-of-viewbuilder-in-swiftui/">“The power of @ViewBuilder in SwiftUI”</a> post.</p>
</blockquote>

<p><em>AsyncImage</em> allows us to take complete control of all the steps of image presentation using another initializer.</p>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">struct</span> <span class="kt">AvatarView</span><span class="p">:</span> <span class="kt">View</span> <span class="p">{</span>
    <span class="k">let</span> <span class="nv">url</span><span class="p">:</span> <span class="kt">URL</span>

    <span class="k">var</span> <span class="nv">body</span><span class="p">:</span> <span class="kd">some</span> <span class="kt">View</span> <span class="p">{</span>
        <span class="kt">AsyncImage</span><span class="p">(</span>
            <span class="nv">url</span><span class="p">:</span> <span class="n">url</span><span class="p">,</span>
            <span class="nv">transaction</span><span class="p">:</span> <span class="kt">Transaction</span><span class="p">(</span><span class="nv">animation</span><span class="p">:</span> <span class="o">.</span><span class="n">easeInOut</span><span class="p">)</span>
        <span class="p">)</span> <span class="p">{</span> <span class="n">phase</span> <span class="k">in</span>
            <span class="k">switch</span> <span class="n">phase</span> <span class="p">{</span>
            <span class="k">case</span> <span class="o">.</span><span class="nv">empty</span><span class="p">:</span>
                <span class="kt">ProgressView</span><span class="p">()</span>
            <span class="k">case</span> <span class="o">.</span><span class="nf">success</span><span class="p">(</span><span class="k">let</span> <span class="nv">image</span><span class="p">):</span>
                <span class="n">image</span>
                    <span class="o">.</span><span class="nf">resizable</span><span class="p">()</span>
                    <span class="o">.</span><span class="nf">transition</span><span class="p">(</span><span class="o">.</span><span class="nf">scale</span><span class="p">(</span><span class="nv">scale</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">,</span> <span class="nv">anchor</span><span class="p">:</span> <span class="o">.</span><span class="n">center</span><span class="p">))</span>
            <span class="k">case</span> <span class="o">.</span><span class="nv">failure</span><span class="p">:</span>
                <span class="kt">Image</span><span class="p">(</span><span class="nv">systemName</span><span class="p">:</span> <span class="s">"wifi.slash"</span><span class="p">)</span>
            <span class="kd">@unknown</span> <span class="k">default</span><span class="p">:</span>
                <span class="kt">EmptyView</span><span class="p">()</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="o">.</span><span class="nf">frame</span><span class="p">(</span><span class="nv">width</span><span class="p">:</span> <span class="mi">44</span><span class="p">,</span> <span class="nv">height</span><span class="p">:</span> <span class="mi">44</span><span class="p">)</span>
        <span class="o">.</span><span class="nf">background</span><span class="p">(</span><span class="kt">Color</span><span class="o">.</span><span class="n">gray</span><span class="p">)</span>
        <span class="o">.</span><span class="nf">clipShape</span><span class="p">(</span><span class="kt">Circle</span><span class="p">())</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>As you can see, we use another initializer that accepts a <em>ViewBuilder</em> closure. This closure has only one parameter that is an instance of <em>AsyncImagePhase</em> enum. <em>AsyncImagePhase</em> enum defines a bunch of image loading states like <em>empty, success, and failed</em>. You can handle all these cases to provide super-custom image presentations.</p>

<p>Another parameter of the currently used initializer is the SwiftUI transaction. By default, <em>AsyncImage</em> creates a new transaction with the default configuration. In our example, I create a custom transaction with a particular animation that <em>AsyncImage</em> will use whenever phase changes.</p>

<blockquote>
  <p>To learn more about the power of transactions in SwiftUI, take a look at my <a href="/2020/10/07/transactions-in-swiftui/">“Transactions in SwiftUI”</a> post.</p>
</blockquote>

<h4 id="conclusion">Conclusion</h4>
<p>Today we learned how to download and display remote images using <em>AsyncImage</em> view. I’m happy to see that SwiftUI provides us this feature because it is fundamental for most of the apps we build. I hope you enjoy the post. Feel free to follow me on <a href="https://twitter.com/mecid">Twitter</a> and ask your questions related to this post. Thanks for reading, and see you next week!</p>

</article>


<aside class="related">
  <h4>Recent posts</h4>
  <ul class="related-posts">
    
      <li>
        <a title="Custom accessibility content in SwiftUI" href="/2021/10/06/custom-accessibility-content-in-swiftui/">
          Custom accessibility content in SwiftUI
          <small><time datetime="2021-10-06T00:00:00+08:00">06 Oct 2021</time></small>
        </a>
      </li>
    
      <li>
        <a title="Audio graphs in SwiftUI" href="/2021/09/29/audio-graphs-in-swiftui/">
          Audio graphs in SwiftUI
          <small><time datetime="2021-09-29T00:00:00+08:00">29 Sep 2021</time></small>
        </a>
      </li>
    
      <li>
        <a title="Accessibility focus in SwiftUI" href="/2021/09/23/accessibility-focus-in-swiftui/">
          Accessibility focus in SwiftUI
          <small><time datetime="2021-09-23T00:00:00+08:00">23 Sep 2021</time></small>
        </a>
      </li>
    
  </ul>
</aside>


      </main>

      <footer class="footer">
          <img class="avatar" alt="mecid" width="100" height="100" data-proofer-ignore="true" src="https://avatars2.githubusercontent.com/mecid?v=3&s=100" srcset="https://avatars2.githubusercontent.com/mecid?v=3&s=100 1x, https://avatars2.githubusercontent.com/mecid?v=3&s=200 2x, https://avatars2.githubusercontent.com/mecid?v=3&s=300 3x, https://avatars2.githubusercontent.com/mecid?v=3&s=400 4x" />
          <small>Hi there! I am code4you,I like to program, and do some App.</small>
          <small>I'm a developer</small>
          <small>Feel free to follow me on <a href="https://github.com/code4you2021">Github</a>.</small>
        <small>
          &copy; <time datetime="2021-10-17T11:25:11+08:00">2021</time>. All rights reserved.
        </small>
      </footer>
    </div>

    
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-1WQVZK1CR7"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-18491817-18');
    </script>
    
  </body>
</html>
