<!DOCTYPE html>
<html lang="en">

  <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="keywords" content="swift ios development apple watch iphone ipad swiftui macos uikit dev wwdc tutorial guide redux tea state container" />

  <!-- Begin Jekyll SEO tag v2.7.1 -->
<title>Mastering FocusState property wrapper in SwiftUI | Code4You</title>
<meta name="generator" content="Jekyll v3.9.0" />
<meta property="og:title" content="Mastering FocusState property wrapper in SwiftUI" />
<meta name="author" content="Code4You" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="SwiftUI became very powerful during the last WWDC. We gained many new features, and one of them was a brand new FocusState property wrapper. FocusState property wrapper allows us to read and write the current focus position in the view hierarchy. This week we will learn how to manage focus in SwiftUI apps using FocusState property wrapper and focused view modifier." />
<meta property="og:description" content="SwiftUI became very powerful during the last WWDC. We gained many new features, and one of them was a brand new FocusState property wrapper. FocusState property wrapper allows us to read and write the current focus position in the view hierarchy. This week we will learn how to manage focus in SwiftUI apps using FocusState property wrapper and focused view modifier." />
<link rel="canonical" href="http://localhost:4000/2021/08/24/mastering-focusstate-property-wrapper-in-swiftui/" />
<meta property="og:url" content="http://localhost:4000/2021/08/24/mastering-focusstate-property-wrapper-in-swiftui/" />
<meta property="og:site_name" content="Code4You" />
<meta property="og:image" content="http://localhost:4000/public/focus-state.png" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2021-08-24T00:00:00+08:00" />
<meta name="twitter:card" content="summary_large_image" />
<meta property="twitter:image" content="http://localhost:4000/public/focus-state.png" />
<meta property="twitter:title" content="Mastering FocusState property wrapper in SwiftUI" />
<script type="application/ld+json">
{"@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/2021/08/24/mastering-focusstate-property-wrapper-in-swiftui/"},"url":"http://localhost:4000/2021/08/24/mastering-focusstate-property-wrapper-in-swiftui/","image":"http://localhost:4000/public/focus-state.png","author":{"@type":"Person","name":"Code4You"},"headline":"Mastering FocusState property wrapper in SwiftUI","description":"SwiftUI became very powerful during the last WWDC. We gained many new features, and one of them was a brand new FocusState property wrapper. FocusState property wrapper allows us to read and write the current focus position in the view hierarchy. This week we will learn how to manage focus in SwiftUI apps using FocusState property wrapper and focused view modifier.","dateModified":"2021-08-24T00:00:00+08:00","datePublished":"2021-08-24T00:00:00+08:00","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->


  <link rel="stylesheet" href="/styles.css">
  <link rel="shortcut icon" href="/public/favicon.ico">
  <link rel="alternate" type="application/atom+xml" title="Code4You" href="/feed.xml">
</head>


  <body>

    <div class="container content">
      <header class="masthead">
        <nav>
          <h1 class="masthead-title">
            <a href="/" title="Home">Code4You</a>
          </h1>
          <div>
            <a href="/categories" title="Categories">Categories</a>
            <a href="/archive" title="Archive">Archive</a>
            <a href="/feed.xml" title="Feed">Feed</a>
          </div>
        </nav>
      </header>

      <main>
        <article class="post">
  <h2 class="post-title">Mastering FocusState property wrapper in SwiftUI</h2>
  <time datetime="2021-08-24T00:00:00+08:00" class="post-date">24 Aug 2021</time>
  <p>SwiftUI became very powerful during the last WWDC. We gained many new features, and one of them was a brand new <em>FocusState</em> property wrapper. <em>FocusState</em> property wrapper allows us to read and write the current focus position in the view hierarchy. This week we will learn how to manage focus in SwiftUI apps using <em>FocusState</em> property wrapper and <em>focused</em> view modifier.</p>

<!-- <div class="ads">
    <span>
        Why don’t more iOS apps use voice? Machine learning for voice is hard, and using Siri is clunky and rigid. So we open-sourced an iOS library (also Android, Node, Python, & React Native), and built a no-code web tool to make custom wake words, speech recognizers, and AI voices—for all devs! <a href="https://www.spokestack.io/?utm_source=swiftui_weekly&utm_medium=email&utm_campaign=maker_launch_PAID">Try it for free.</a>
    </span>
</div> -->

<p>SwiftUI provides a new <em>FocusState</em> property wrapper that works on all Apple platforms and allows us to focus on a particular view or check if that view is already focused. The usage is effortless. Let’s see how we can use it.</p>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">import</span> <span class="kt">SwiftUI</span>

<span class="kd">struct</span> <span class="kt">SignInView</span><span class="p">:</span> <span class="kt">View</span> <span class="p">{</span>
    <span class="kd">@FocusState</span> <span class="kd">private</span> <span class="k">var</span> <span class="nv">isEmailFocused</span><span class="p">:</span> <span class="kt">Bool</span>
    <span class="kd">@State</span> <span class="kd">private</span> <span class="k">var</span> <span class="nv">email</span> <span class="o">=</span> <span class="s">""</span>

    <span class="k">var</span> <span class="nv">body</span><span class="p">:</span> <span class="kd">some</span> <span class="kt">View</span> <span class="p">{</span>
        <span class="kt">NavigationView</span> <span class="p">{</span>
            <span class="kt">Form</span> <span class="p">{</span>
                <span class="kt">TextField</span><span class="p">(</span><span class="s">"email"</span><span class="p">,</span> <span class="nv">text</span><span class="p">:</span> <span class="err">$</span><span class="n">email</span><span class="p">,</span> <span class="nv">prompt</span><span class="p">:</span> <span class="kt">Text</span><span class="p">(</span><span class="s">"email"</span><span class="p">))</span>
                    <span class="o">.</span><span class="nf">focused</span><span class="p">(</span><span class="err">$</span><span class="n">isEmailFocused</span><span class="p">)</span>
            <span class="p">}</span>
            <span class="o">.</span><span class="nf">navigationTitle</span><span class="p">(</span><span class="s">"Sign in"</span><span class="p">)</span>
            <span class="o">.</span><span class="nf">onChange</span><span class="p">(</span><span class="nv">of</span><span class="p">:</span> <span class="n">isEmailFocused</span><span class="p">)</span> <span class="p">{</span> <span class="n">newValue</span> <span class="k">in</span>
                <span class="nf">print</span><span class="p">(</span><span class="n">newValue</span><span class="p">)</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>As you can see in the example above, we need to define a boolean variable using the <em>FocusState</em> property wrapper. We also have to bind its value to the focus state of a particular view using the <em>focused</em> view modifier. SwiftUI sets the boolean value of the view to true as soon as the user focuses on it. It also changes it to false as soon as the view loses focus.</p>

<blockquote>
  <p>To learn more about focus management in SwiftUI, take a look at my <a href="/2020/12/02/focus-management-in-swiftui/">“Focus management in SwiftUI”</a> post.</p>
</blockquote>

<p>You can define as many <em>FocusState</em> variables as needed to cover your focus management logic. SwiftUI takes care of them by keeping in sync the focused view with its binding.</p>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">import</span> <span class="kt">SwiftUI</span>

<span class="kd">struct</span> <span class="kt">SignInView</span><span class="p">:</span> <span class="kt">View</span> <span class="p">{</span>
    <span class="kd">@FocusState</span> <span class="kd">private</span> <span class="k">var</span> <span class="nv">isEmailFocused</span><span class="p">:</span> <span class="kt">Bool</span>
    <span class="kd">@FocusState</span> <span class="kd">private</span> <span class="k">var</span> <span class="nv">isPasswordFocused</span><span class="p">:</span> <span class="kt">Bool</span>

    <span class="kd">@State</span> <span class="kd">private</span> <span class="k">var</span> <span class="nv">email</span> <span class="o">=</span> <span class="s">""</span>
    <span class="kd">@State</span> <span class="kd">private</span> <span class="k">var</span> <span class="nv">password</span> <span class="o">=</span> <span class="s">""</span>

    <span class="k">var</span> <span class="nv">body</span><span class="p">:</span> <span class="kd">some</span> <span class="kt">View</span> <span class="p">{</span>
        <span class="kt">NavigationView</span> <span class="p">{</span>
            <span class="kt">Form</span> <span class="p">{</span>
                <span class="kt">TextField</span><span class="p">(</span><span class="s">"email"</span><span class="p">,</span> <span class="nv">text</span><span class="p">:</span> <span class="err">$</span><span class="n">email</span><span class="p">,</span> <span class="nv">prompt</span><span class="p">:</span> <span class="kt">Text</span><span class="p">(</span><span class="s">"email"</span><span class="p">))</span>
                    <span class="o">.</span><span class="nf">focused</span><span class="p">(</span><span class="err">$</span><span class="n">isEmailFocused</span><span class="p">)</span>
                <span class="kt">SecureField</span><span class="p">(</span><span class="s">"password"</span><span class="p">,</span> <span class="nv">text</span><span class="p">:</span> <span class="err">$</span><span class="n">password</span><span class="p">,</span> <span class="nv">prompt</span><span class="p">:</span> <span class="kt">Text</span><span class="p">(</span><span class="s">"password"</span><span class="p">))</span>
                    <span class="o">.</span><span class="nf">focused</span><span class="p">(</span><span class="err">$</span><span class="n">isPasswordFocused</span><span class="p">)</span>
            <span class="p">}</span>
            <span class="o">.</span><span class="nf">navigationTitle</span><span class="p">(</span><span class="s">"Sign in"</span><span class="p">)</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>In the example above, we have two variables bound to email and password text fields. SwiftUI can manage them together and keep them in sync with the user interface. Remember that you can change the value to false programmatically to hide the keyboard or set the value to true to move the focus to a particular view.</p>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">import</span> <span class="kt">SwiftUI</span>

<span class="kd">struct</span> <span class="kt">SignInView</span><span class="p">:</span> <span class="kt">View</span> <span class="p">{</span>
    <span class="kd">@FocusState</span> <span class="kd">private</span> <span class="k">var</span> <span class="nv">isEmailFocused</span><span class="p">:</span> <span class="kt">Bool</span>
    <span class="kd">@FocusState</span> <span class="kd">private</span> <span class="k">var</span> <span class="nv">isPasswordFocused</span><span class="p">:</span> <span class="kt">Bool</span>

    <span class="kd">@State</span> <span class="kd">private</span> <span class="k">var</span> <span class="nv">email</span> <span class="o">=</span> <span class="s">""</span>
    <span class="kd">@State</span> <span class="kd">private</span> <span class="k">var</span> <span class="nv">password</span> <span class="o">=</span> <span class="s">""</span>

    <span class="k">var</span> <span class="nv">body</span><span class="p">:</span> <span class="kd">some</span> <span class="kt">View</span> <span class="p">{</span>
        <span class="kt">NavigationView</span> <span class="p">{</span>
            <span class="kt">Form</span> <span class="p">{</span>
                <span class="kt">TextField</span><span class="p">(</span><span class="s">"email"</span><span class="p">,</span> <span class="nv">text</span><span class="p">:</span> <span class="err">$</span><span class="n">email</span><span class="p">,</span> <span class="nv">prompt</span><span class="p">:</span> <span class="kt">Text</span><span class="p">(</span><span class="s">"email"</span><span class="p">))</span>
                    <span class="o">.</span><span class="nf">focused</span><span class="p">(</span><span class="err">$</span><span class="n">isEmailFocused</span><span class="p">)</span>
                <span class="kt">SecureField</span><span class="p">(</span><span class="s">"password"</span><span class="p">,</span> <span class="nv">text</span><span class="p">:</span> <span class="err">$</span><span class="n">password</span><span class="p">,</span> <span class="nv">prompt</span><span class="p">:</span> <span class="kt">Text</span><span class="p">(</span><span class="s">"password"</span><span class="p">))</span>
                    <span class="o">.</span><span class="nf">focused</span><span class="p">(</span><span class="err">$</span><span class="n">isPasswordFocused</span><span class="p">)</span>

                <span class="kt">Button</span><span class="p">(</span><span class="s">"login"</span><span class="p">)</span> <span class="p">{</span>
                    <span class="k">if</span> <span class="n">email</span><span class="o">.</span><span class="n">isEmpty</span> <span class="p">{</span>
                        <span class="n">isEmailFocused</span> <span class="o">=</span> <span class="kc">true</span>
                    <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="n">password</span><span class="o">.</span><span class="n">isEmpty</span> <span class="p">{</span>
                        <span class="n">isPasswordFocused</span> <span class="o">=</span> <span class="kc">true</span>
                    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                        <span class="n">isPasswordFocused</span> <span class="o">=</span> <span class="kc">false</span>
                        <span class="n">isEmailFocused</span> <span class="o">=</span> <span class="kc">false</span>

                        <span class="nf">login</span><span class="p">()</span>
                    <span class="p">}</span>
                <span class="p">}</span>
            <span class="p">}</span>
            <span class="o">.</span><span class="nf">navigationTitle</span><span class="p">(</span><span class="s">"Sign in"</span><span class="p">)</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="kd">private</span> <span class="kd">func</span> <span class="nf">login</span><span class="p">()</span> <span class="p">{</span>
        <span class="c1">// your logic here</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<blockquote>
  <p>To learn about other focus related property wrappers in SwiftUI, take a look at my <a href="/2021/03/03/focusedvalue-and-focusedbinding-property-wrappers-in-swiftui/">“FocusedValue and FocusedBinding property wrappers in SwiftUI”</a> post.</p>
</blockquote>

<p>Defining many <em>FocusState</em> properties in complex view hierarchies can become cumbersome. Fortunately, <em>FocusState</em> works not only with boolean values but also with any <em>Hashable</em> type. It means that we can model the focused state using an enum type conforming to <em>Hashable</em> protocol. Let’s take a look at the example.</p>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">enum</span> <span class="kt">FocusableField</span><span class="p">:</span> <span class="kt">Hashable</span> <span class="p">{</span>
    <span class="k">case</span> <span class="n">email</span>
    <span class="k">case</span> <span class="n">password</span>
<span class="p">}</span>
</code></pre></div></div>

<p>Here we have the <em>Field</em> enum that conforms to <em>Hashable</em> and defines all the focusable views we manage. Now, we can use this enum to bind the focus state of different views to various enum cases.</p>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">struct</span> <span class="kt">ContentView</span><span class="p">:</span> <span class="kt">View</span> <span class="p">{</span>
    <span class="kd">@State</span> <span class="kd">private</span> <span class="k">var</span> <span class="nv">email</span> <span class="o">=</span> <span class="s">""</span>
    <span class="kd">@State</span> <span class="kd">private</span> <span class="k">var</span> <span class="nv">password</span> <span class="o">=</span> <span class="s">""</span>
    <span class="kd">@FocusState</span> <span class="kd">private</span> <span class="k">var</span> <span class="nv">focus</span><span class="p">:</span> <span class="kt">FocusableField</span><span class="p">?</span>

    <span class="k">var</span> <span class="nv">body</span><span class="p">:</span> <span class="kd">some</span> <span class="kt">View</span> <span class="p">{</span>
        <span class="kt">NavigationView</span> <span class="p">{</span>
            <span class="kt">Form</span> <span class="p">{</span>
                <span class="kt">TextField</span><span class="p">(</span><span class="s">"email"</span><span class="p">,</span> <span class="nv">text</span><span class="p">:</span> <span class="err">$</span><span class="n">email</span><span class="p">,</span> <span class="nv">prompt</span><span class="p">:</span> <span class="kt">Text</span><span class="p">(</span><span class="s">"email"</span><span class="p">))</span>
                    <span class="o">.</span><span class="nf">focused</span><span class="p">(</span><span class="err">$</span><span class="n">focus</span><span class="p">,</span> <span class="nv">equals</span><span class="p">:</span> <span class="o">.</span><span class="n">email</span><span class="p">)</span>
                <span class="kt">SecureField</span><span class="p">(</span><span class="s">"password"</span><span class="p">,</span> <span class="nv">text</span><span class="p">:</span> <span class="err">$</span><span class="n">password</span><span class="p">,</span> <span class="nv">prompt</span><span class="p">:</span> <span class="kt">Text</span><span class="p">(</span><span class="s">"password"</span><span class="p">))</span>
                    <span class="o">.</span><span class="nf">focused</span><span class="p">(</span><span class="err">$</span><span class="n">focus</span><span class="p">,</span> <span class="nv">equals</span><span class="p">:</span> <span class="o">.</span><span class="n">password</span><span class="p">)</span>
                <span class="kt">Button</span><span class="p">(</span><span class="s">"login"</span><span class="p">,</span> <span class="nv">action</span><span class="p">:</span> <span class="n">login</span><span class="p">)</span>
            <span class="p">}</span>
            <span class="o">.</span><span class="n">toolbar</span> <span class="p">{</span>
                <span class="kt">ToolbarItem</span><span class="p">(</span><span class="nv">placement</span><span class="p">:</span> <span class="o">.</span><span class="n">keyboard</span><span class="p">)</span> <span class="p">{</span>
                    <span class="kt">Button</span><span class="p">(</span><span class="s">"next"</span><span class="p">)</span> <span class="p">{</span>
                        <span class="k">if</span> <span class="n">email</span><span class="o">.</span><span class="n">isEmpty</span> <span class="p">{</span>
                            <span class="n">focus</span> <span class="o">=</span> <span class="o">.</span><span class="n">email</span>
                        <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="n">password</span><span class="o">.</span><span class="n">isEmpty</span> <span class="p">{</span>
                            <span class="n">focus</span> <span class="o">=</span> <span class="o">.</span><span class="n">password</span>
                        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                            <span class="n">focus</span> <span class="o">=</span> <span class="kc">nil</span>
                        <span class="p">}</span>
                    <span class="p">}</span>
                <span class="p">}</span>
            <span class="p">}</span>
            <span class="o">.</span><span class="nf">navigationTitle</span><span class="p">(</span><span class="s">"Sign in"</span><span class="p">)</span>
            <span class="o">.</span><span class="n">onAppear</span> <span class="p">{</span>
                <span class="kt">DispatchQueue</span><span class="o">.</span><span class="n">main</span><span class="o">.</span><span class="nf">asyncAfter</span><span class="p">(</span><span class="nv">deadline</span><span class="p">:</span> <span class="o">.</span><span class="nf">now</span><span class="p">()</span> <span class="o">+</span> <span class="mf">0.1</span><span class="p">)</span> <span class="p">{</span>
                    <span class="n">focus</span> <span class="o">=</span> <span class="o">.</span><span class="n">email</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="kd">private</span> <span class="kd">func</span> <span class="nf">login</span><span class="p">()</span> <span class="p">{</span>
        <span class="c1">// your logic here</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>As you can see, we use another version of the <em>focused</em> view modifier to bind a view to a concrete case of the <em>Field</em> enum. SwiftUI updates the value of the <em>FocusState</em> property whenever the user focuses on any of the bound views. Remember that we should make our <em>FocusState</em> property optional to use combined with <em>Hashable</em> enum because there might be no focused view at the moment.</p>

<blockquote>
  <p>To learn more about toolbars in SwiftUI, take a look at my <a href="/2020/07/15/mastering-toolbars-in-swiftui/">“Mastering toolbars in SwiftUI”</a> post.</p>
</blockquote>

<p>Today we learned how to use the <em>FocusState</em> property wrapper to manage focus in our views. Remember that <em>FocusState</em> allows us both to read and change the focused view programmatically. I hope you enjoy the post. Feel free to follow me on <a href="https://twitter.com/mecid">Twitter</a> and ask your questions related to this post. Thanks for reading, and see you next week!</p>


</article>


<aside class="related">
  <h4>Recent posts</h4>
  <ul class="related-posts">
    
      <li>
        <a title="Custom accessibility content in SwiftUI" href="/2021/10/06/custom-accessibility-content-in-swiftui/">
          Custom accessibility content in SwiftUI
          <small><time datetime="2021-10-06T00:00:00+08:00">06 Oct 2021</time></small>
        </a>
      </li>
    
      <li>
        <a title="Audio graphs in SwiftUI" href="/2021/09/29/audio-graphs-in-swiftui/">
          Audio graphs in SwiftUI
          <small><time datetime="2021-09-29T00:00:00+08:00">29 Sep 2021</time></small>
        </a>
      </li>
    
      <li>
        <a title="Accessibility focus in SwiftUI" href="/2021/09/23/accessibility-focus-in-swiftui/">
          Accessibility focus in SwiftUI
          <small><time datetime="2021-09-23T00:00:00+08:00">23 Sep 2021</time></small>
        </a>
      </li>
    
  </ul>
</aside>


      </main>

      <footer class="footer">
          <img class="avatar" alt="mecid" width="100" height="100" data-proofer-ignore="true" src="https://avatars2.githubusercontent.com/mecid?v=3&s=100" srcset="https://avatars2.githubusercontent.com/mecid?v=3&s=100 1x, https://avatars2.githubusercontent.com/mecid?v=3&s=200 2x, https://avatars2.githubusercontent.com/mecid?v=3&s=300 3x, https://avatars2.githubusercontent.com/mecid?v=3&s=400 4x" />
          <small>Hi there! I am code4you,I like to program, and do some App.</small>
          <small>I'm a developer</small>
          <small>Feel free to follow me on <a href="https://github.com/code4you2021">Github</a>.</small>
        <small>
          &copy; <time datetime="2021-10-17T11:25:11+08:00">2021</time>. All rights reserved.
        </small>
      </footer>
    </div>

    
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-1WQVZK1CR7"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-18491817-18');
    </script>
    
  </body>
</html>
