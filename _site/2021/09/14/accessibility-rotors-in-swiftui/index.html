<!DOCTYPE html>
<html lang="en">

  <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="keywords" content="swift ios development apple watch iphone ipad swiftui macos uikit dev wwdc tutorial guide redux tea state container" />

  <!-- Begin Jekyll SEO tag v2.7.1 -->
<title>Accessibility rotors in SwiftUI | Code4You</title>
<meta name="generator" content="Jekyll v3.9.0" />
<meta property="og:title" content="Accessibility rotors in SwiftUI" />
<meta name="author" content="Code4You" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="SwiftUI Release 3 contains many new APIs that we can utilize to improve accessibility in our apps, and one of them is the new accessibilityRotor view modifier. This week we will learn how to use the accessibilityRotor view modifier to provide custom VoiceOver navigation using rotors." />
<meta property="og:description" content="SwiftUI Release 3 contains many new APIs that we can utilize to improve accessibility in our apps, and one of them is the new accessibilityRotor view modifier. This week we will learn how to use the accessibilityRotor view modifier to provide custom VoiceOver navigation using rotors." />
<link rel="canonical" href="http://localhost:4000/2021/09/14/accessibility-rotors-in-swiftui/" />
<meta property="og:url" content="http://localhost:4000/2021/09/14/accessibility-rotors-in-swiftui/" />
<meta property="og:site_name" content="Code4You" />
<meta property="og:image" content="http://localhost:4000/public/accessibility.jpeg" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2021-09-14T00:00:00+08:00" />
<meta name="twitter:card" content="summary_large_image" />
<meta property="twitter:image" content="http://localhost:4000/public/accessibility.jpeg" />
<meta property="twitter:title" content="Accessibility rotors in SwiftUI" />
<script type="application/ld+json">
{"@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/2021/09/14/accessibility-rotors-in-swiftui/"},"url":"http://localhost:4000/2021/09/14/accessibility-rotors-in-swiftui/","image":"http://localhost:4000/public/accessibility.jpeg","author":{"@type":"Person","name":"Code4You"},"headline":"Accessibility rotors in SwiftUI","description":"SwiftUI Release 3 contains many new APIs that we can utilize to improve accessibility in our apps, and one of them is the new accessibilityRotor view modifier. This week we will learn how to use the accessibilityRotor view modifier to provide custom VoiceOver navigation using rotors.","dateModified":"2021-09-14T00:00:00+08:00","datePublished":"2021-09-14T00:00:00+08:00","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->


  <link rel="stylesheet" href="/styles.css">
  <link rel="shortcut icon" href="/public/favicon.ico">
  <link rel="alternate" type="application/atom+xml" title="Code4You" href="/feed.xml">
</head>


  <body>

    <div class="container content">
      <header class="masthead">
        <nav>
          <h1 class="masthead-title">
            <a href="/" title="Home">Code4You</a>
          </h1>
          <div>
            <a href="/categories" title="Categories">Categories</a>
            <a href="/archive" title="Archive">Archive</a>
            <a href="/feed.xml" title="Feed">Feed</a>
          </div>
        </nav>
      </header>

      <main>
        <article class="post">
  <h2 class="post-title">Accessibility rotors in SwiftUI</h2>
  <time datetime="2021-09-14T00:00:00+08:00" class="post-date">14 Sep 2021</time>
  <p>SwiftUI Release 3 contains many new APIs that we can utilize to improve accessibility in our apps, and one of them is the new <em>accessibilityRotor</em> view modifier. This week we will learn how to use the <em>accessibilityRotor</em> view modifier to provide custom VoiceOver navigation using rotors.</p>

<h4 id="basics">Basics</h4>
<p>Usually, we navigate through the app using the left and right swipes while VoiceOver is on. But sometimes, we need a custom path for navigation through a specific collection of elements. A particular group of elements is called a custom rotor. You can create as many as you need custom rotors in your app.</p>

<p>To use the rotor, rotate two fingers on your iOS device’s screen as if you’re turning a dial. VoiceOver will say the first rotor option. Keep rotating your fingers to hear more options. Lift your fingers to choose an option. Then flick your finger up or down on the screen to navigate through it.</p>

<h4 id="swiftui-custom-rotors-api">SwiftUI custom rotors API</h4>
<p>Assume that we are working on a screen that provides information about health trends. There is a long list of different trends, including positive, negative, and constant results. Negative trends are the things the user should focus on improving. That’s why we should build a custom rotor to navigate only through negative trends. Let’s start by introducing the <em>Trend</em> model and the <em>TrendsView</em>.</p>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">import</span> <span class="kt">SwiftUI</span>

<span class="kd">struct</span> <span class="kt">Trend</span><span class="p">:</span> <span class="kt">Identifiable</span> <span class="p">{</span>
    <span class="k">let</span> <span class="nv">id</span> <span class="o">=</span> <span class="kt">UUID</span><span class="p">()</span>
    <span class="k">let</span> <span class="nv">message</span><span class="p">:</span> <span class="kt">String</span>
    <span class="k">let</span> <span class="nv">isPositive</span><span class="p">:</span> <span class="kt">Bool</span>
<span class="p">}</span>

<span class="kd">struct</span> <span class="kt">TrendView</span><span class="p">:</span> <span class="kt">View</span> <span class="p">{</span>
    <span class="k">let</span> <span class="nv">trend</span><span class="p">:</span> <span class="kt">Trend</span>

    <span class="k">var</span> <span class="nv">body</span><span class="p">:</span> <span class="kd">some</span> <span class="kt">View</span> <span class="p">{</span>
        <span class="kt">HStack</span> <span class="p">{</span>
            <span class="kt">Image</span><span class="p">(</span><span class="nv">systemName</span><span class="p">:</span> <span class="n">trend</span><span class="o">.</span><span class="n">isPositive</span> <span class="p">?</span> <span class="s">"chevron.up"</span> <span class="p">:</span> <span class="s">"chevron.down"</span><span class="p">)</span>
                <span class="o">.</span><span class="nf">accessibilityElement</span><span class="p">()</span>
                <span class="o">.</span><span class="nf">accessibilityLabel</span><span class="p">(</span><span class="n">trend</span><span class="o">.</span><span class="n">isPositive</span> <span class="p">?</span> <span class="s">"positive"</span> <span class="p">:</span> <span class="s">"negative"</span><span class="p">)</span>
            <span class="kt">Text</span><span class="p">(</span><span class="n">trend</span><span class="o">.</span><span class="n">message</span><span class="p">)</span>
        <span class="p">}</span><span class="o">.</span><span class="nf">accessibilityElement</span><span class="p">(</span><span class="nv">children</span><span class="p">:</span> <span class="o">.</span><span class="n">combine</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>The code above is super simple. Please look at how we use the <em>accessibilityElement</em> view modifier to make <em>TrendView</em> accessible and combine all the children’s information.</p>

<blockquote>
  <p>To learn about the basics of accessibility in SwiftUI, take a look at my <a href="/2019/09/10/accessibility-in-swiftui/">“Accessibility in SwiftUI”</a> post.</p>
</blockquote>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">struct</span> <span class="kt">TrendsView</span><span class="p">:</span> <span class="kt">View</span> <span class="p">{</span>
    <span class="k">let</span> <span class="nv">trends</span><span class="p">:</span> <span class="p">[</span><span class="kt">Trend</span><span class="p">]</span>

    <span class="k">var</span> <span class="nv">body</span><span class="p">:</span> <span class="kd">some</span> <span class="kt">View</span> <span class="p">{</span>
        <span class="kt">List</span> <span class="p">{</span>
            <span class="kt">ForEach</span><span class="p">(</span><span class="n">trends</span><span class="p">,</span> <span class="nv">id</span><span class="p">:</span> <span class="p">\</span><span class="o">.</span><span class="n">id</span><span class="p">)</span> <span class="p">{</span> <span class="n">trend</span> <span class="k">in</span>
                <span class="kt">TrendView</span><span class="p">(</span><span class="nv">trend</span><span class="p">:</span> <span class="n">trend</span><span class="p">)</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="o">.</span><span class="nf">accessibilityRotor</span><span class="p">(</span><span class="s">"Negative trends"</span><span class="p">)</span> <span class="p">{</span>
            <span class="kt">ForEach</span><span class="p">(</span><span class="n">trends</span><span class="p">,</span> <span class="nv">id</span><span class="p">:</span> <span class="p">\</span><span class="o">.</span><span class="n">id</span><span class="p">)</span> <span class="p">{</span> <span class="n">trend</span> <span class="k">in</span>
                <span class="k">if</span> <span class="o">!</span><span class="n">trend</span><span class="o">.</span><span class="n">isPositive</span> <span class="p">{</span>
                    <span class="kt">AccessibilityRotorEntry</span><span class="p">(</span><span class="n">trend</span><span class="o">.</span><span class="n">message</span><span class="p">,</span> <span class="nv">id</span><span class="p">:</span> <span class="n">trend</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>Here we have the <em>TrendsView</em> that displays the list of trends. We use the <em>accessibilityRotor</em> view modifier to create a custom rotor called “Negative trends”. As soon as the user focuses on the list, VoiceOver suggests accessing the negative trends rotor.</p>

<p>The first parameter of <em>accessibilityRotor</em> view modifier is a label. You can use <em>String, LocalizedStringKey, or Text</em> view as a label. VoiceOver uses the title to inform a user about a custom rotor.</p>

<p>The second parameter is the <em>AccessibilityRotorContentBuilder</em> closure. The <em>AccessibilityRotorContentBuilder</em> function builder is very similar to <em>ViewBuilder</em>, but instead of building views, it creates <em>AccessibilityRotorContent</em>.</p>

<p><em>AccessibilityRotorContent</em> is also identical to <em>View</em> protocol, but it describes the content of the rotor. SwiftUI types like <em>ForEach</em> and <em>Group</em> conform both to <em>View</em> and <em>AccessibilityRotorContent</em> protocols. That’s why we can use them both inside <em>ViewBuilder</em> and <em>AccessibilityRotorContentBuilder</em> closures.</p>

<p>The last piece is the <em>AccessibilityRotorEntry</em> conforming to <em>AccessibilityRotorContent</em> and allowing us to use it inside a <em>ForEach</em> or <em>Group</em>. We use it to create a rotor entry and bind it to a SwiftUI view using an ID. This is the point where all the magic takes place. We have two <em>ForEach</em> instances, and SwiftUI is smart enough to match the IDs inside <em>ForEach</em> and bind rotor entries to the views with the same IDs.</p>

<h4 id="accessibilityrotorentry-view-modifier">accessibilityRotorEntry view modifier</h4>
<p>The approach above works like a charm, but we can gain more control over binding rotor entry to a view using the <em>accessibilityRotorEntry</em> view modifier.</p>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">struct</span> <span class="kt">TrendsView</span><span class="p">:</span> <span class="kt">View</span> <span class="p">{</span>
    <span class="k">let</span> <span class="nv">trends</span><span class="p">:</span> <span class="p">[</span><span class="kt">Trend</span><span class="p">]</span>

    <span class="kd">@Namespace</span> <span class="kd">private</span> <span class="k">var</span> <span class="nv">customRotorNamespace</span>

    <span class="k">var</span> <span class="nv">body</span><span class="p">:</span> <span class="kd">some</span> <span class="kt">View</span> <span class="p">{</span>
        <span class="kt">List</span> <span class="p">{</span>
            <span class="kt">ForEach</span><span class="p">(</span><span class="n">trends</span><span class="p">,</span> <span class="nv">id</span><span class="p">:</span> <span class="p">\</span><span class="o">.</span><span class="n">id</span><span class="p">)</span> <span class="p">{</span> <span class="n">trend</span> <span class="k">in</span>
                <span class="kt">VStack</span> <span class="p">{</span>
                    <span class="kt">TrendView</span><span class="p">(</span><span class="nv">trend</span><span class="p">:</span> <span class="n">trend</span><span class="p">)</span>
                        <span class="o">.</span><span class="nf">accessibilityRotorEntry</span><span class="p">(</span><span class="nv">id</span><span class="p">:</span> <span class="n">trend</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="nv">in</span><span class="p">:</span> <span class="n">customRotorNamespace</span><span class="p">)</span>
                    <span class="kt">Text</span><span class="p">(</span><span class="n">trend</span><span class="o">.</span><span class="n">notes</span><span class="p">)</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="o">.</span><span class="nf">accessibilityRotor</span><span class="p">(</span><span class="s">"Negative trends"</span><span class="p">)</span> <span class="p">{</span>
            <span class="kt">ForEach</span><span class="p">(</span><span class="n">trends</span><span class="p">,</span> <span class="nv">id</span><span class="p">:</span> <span class="p">\</span><span class="o">.</span><span class="n">id</span><span class="p">)</span> <span class="p">{</span> <span class="n">trend</span> <span class="k">in</span>
                <span class="k">if</span> <span class="o">!</span><span class="n">trend</span><span class="o">.</span><span class="n">isPositive</span> <span class="p">{</span>
                    <span class="kt">AccessibilityRotorEntry</span><span class="p">(</span><span class="n">trend</span><span class="o">.</span><span class="n">message</span><span class="p">,</span> <span class="n">trend</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="nv">in</span><span class="p">:</span> <span class="n">customRotorNamespace</span><span class="p">)</span> 
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>In this case, we use the <em>accessibilityRotorEntry</em> view modifier to bind a rotor entry id to a view explicitly. It allows us to ignore IDs from <em>ForEach</em> and can be very helpful in situations where we don’t have ForEach or don’t need to include the whole child of <em>ForEach</em> into the rotor, like in our example.</p>

<h4 id="preparing-rotor-entries">Preparing rotor entries</h4>
<p>As a bonus, the <em>AccessibilityRotorEntry</em> type allows us to provide a closure to run when the user navigates to a particular rotor entry. For example, we can scroll to the specific list item if it is not visible when navigating to that item using rotors.</p>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">struct</span> <span class="kt">TrendsView</span><span class="p">:</span> <span class="kt">View</span> <span class="p">{</span>
    <span class="k">let</span> <span class="nv">trends</span><span class="p">:</span> <span class="p">[</span><span class="kt">Trend</span><span class="p">]</span>

    <span class="kd">@Namespace</span> <span class="kd">private</span> <span class="k">var</span> <span class="nv">customRotorNamespace</span>

    <span class="k">var</span> <span class="nv">body</span><span class="p">:</span> <span class="kd">some</span> <span class="kt">View</span> <span class="p">{</span>
        <span class="kt">ScrollViewReader</span> <span class="p">{</span> <span class="n">scrollView</span> <span class="k">in</span>
            <span class="kt">List</span> <span class="p">{</span>
                <span class="kt">ForEach</span><span class="p">(</span><span class="n">trends</span><span class="p">,</span> <span class="nv">id</span><span class="p">:</span> <span class="p">\</span><span class="o">.</span><span class="n">id</span><span class="p">)</span> <span class="p">{</span> <span class="n">trend</span> <span class="k">in</span>
                    <span class="kt">TrendView</span><span class="p">(</span><span class="nv">trend</span><span class="p">:</span> <span class="n">trend</span><span class="p">)</span>
                        <span class="o">.</span><span class="nf">accessibilityRotorEntry</span><span class="p">(</span><span class="nv">id</span><span class="p">:</span> <span class="n">trend</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="nv">in</span><span class="p">:</span> <span class="n">customRotorNamespace</span><span class="p">)</span>
                        <span class="o">.</span><span class="nf">id</span><span class="p">(</span><span class="n">trend</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
                <span class="p">}</span>
            <span class="p">}</span>
            <span class="o">.</span><span class="nf">accessibilityRotor</span><span class="p">(</span><span class="s">"Negative trends"</span><span class="p">)</span> <span class="p">{</span>
                <span class="kt">ForEach</span><span class="p">(</span><span class="n">trends</span><span class="p">,</span> <span class="nv">id</span><span class="p">:</span> <span class="p">\</span><span class="o">.</span><span class="n">id</span><span class="p">)</span> <span class="p">{</span> <span class="n">trend</span> <span class="k">in</span>
                    <span class="k">if</span> <span class="o">!</span><span class="n">trend</span><span class="o">.</span><span class="n">isPositive</span> <span class="p">{</span>
                        <span class="kt">AccessibilityRotorEntry</span><span class="p">(</span><span class="n">trend</span><span class="o">.</span><span class="n">message</span><span class="p">,</span> <span class="n">trend</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="nv">in</span><span class="p">:</span> <span class="n">customRotorNamespace</span><span class="p">)</span> <span class="p">{</span>
                            <span class="n">scrollView</span><span class="o">.</span><span class="nf">scrollTo</span><span class="p">(</span><span class="n">trend</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
                        <span class="p">}</span>
                    <span class="p">}</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<h4 id="texteditor-rotors">TextEditor Rotors</h4>
<p>The new accessibility rotors API is robust and allows us to navigate even through text in <em>TextEditor</em>. We can mark particular parts of our text content and navigate between them inside the <em>TextEditor</em>.</p>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">struct</span> <span class="kt">ContentEditor</span><span class="p">:</span> <span class="kt">View</span> <span class="p">{</span>
    <span class="kd">@Binding</span> <span class="k">var</span> <span class="nv">content</span><span class="p">:</span> <span class="kt">Content</span>

    <span class="k">var</span> <span class="nv">body</span><span class="p">:</span> <span class="kd">some</span> <span class="kt">View</span> <span class="p">{</span>
        <span class="kt">TextEditor</span><span class="p">(</span><span class="nv">text</span><span class="p">:</span> <span class="err">$</span><span class="n">content</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
            <span class="o">.</span><span class="nf">accessibilityRotor</span><span class="p">(</span><span class="s">"Emails"</span><span class="p">,</span> <span class="nv">textRanges</span><span class="p">:</span> <span class="n">content</span><span class="o">.</span><span class="n">emailRanges</span><span class="p">)</span>
            <span class="o">.</span><span class="nf">accessibilityRotor</span><span class="p">(</span><span class="s">"Links"</span><span class="p">,</span> <span class="nv">textRanges</span><span class="p">:</span> <span class="n">content</span><span class="o">.</span><span class="n">linkRanges</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<h4 id="conclusion">Conclusion</h4>
<p>SwiftUI Release 3 has done great work in the area of accessibility. Now we can use all these new APIs to build super accessible apps. I hope you enjoy the post. Feel free to follow me on <a href="https://twitter.com/mecid">Twitter</a> and ask your questions related to this post. Thanks for reading, and see you next week!</p>

</article>


<aside class="related">
  <h4>Recent posts</h4>
  <ul class="related-posts">
    
      <li>
        <a title="Custom accessibility content in SwiftUI" href="/2021/10/06/custom-accessibility-content-in-swiftui/">
          Custom accessibility content in SwiftUI
          <small><time datetime="2021-10-06T00:00:00+08:00">06 Oct 2021</time></small>
        </a>
      </li>
    
      <li>
        <a title="Audio graphs in SwiftUI" href="/2021/09/29/audio-graphs-in-swiftui/">
          Audio graphs in SwiftUI
          <small><time datetime="2021-09-29T00:00:00+08:00">29 Sep 2021</time></small>
        </a>
      </li>
    
      <li>
        <a title="Accessibility focus in SwiftUI" href="/2021/09/23/accessibility-focus-in-swiftui/">
          Accessibility focus in SwiftUI
          <small><time datetime="2021-09-23T00:00:00+08:00">23 Sep 2021</time></small>
        </a>
      </li>
    
  </ul>
</aside>


      </main>

      <footer class="footer">
          <img class="avatar" alt="mecid" width="100" height="100" data-proofer-ignore="true" src="https://avatars2.githubusercontent.com/mecid?v=3&s=100" srcset="https://avatars2.githubusercontent.com/mecid?v=3&s=100 1x, https://avatars2.githubusercontent.com/mecid?v=3&s=200 2x, https://avatars2.githubusercontent.com/mecid?v=3&s=300 3x, https://avatars2.githubusercontent.com/mecid?v=3&s=400 4x" />
          <small>Hi there! I am code4you,I like to program, and do some App.</small>
          <small>I'm a developer</small>
          <small>Feel free to follow me on <a href="https://github.com/code4you2021">Github</a>.</small>
        <small>
          &copy; <time datetime="2021-10-17T11:25:11+08:00">2021</time>. All rights reserved.
        </small>
      </footer>
    </div>

    
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-1WQVZK1CR7"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-18491817-18');
    </script>
    
  </body>
</html>
