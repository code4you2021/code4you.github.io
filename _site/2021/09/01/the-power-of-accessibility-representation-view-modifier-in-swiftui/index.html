<!DOCTYPE html>
<html lang="en">

  <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="keywords" content="swift ios development apple watch iphone ipad swiftui macos uikit dev wwdc tutorial guide redux tea state container" />

  <!-- Begin Jekyll SEO tag v2.7.1 -->
<title>The power of accessibilityRepresentation view modifier in SwiftUI | Code4You</title>
<meta name="generator" content="Jekyll v3.9.0" />
<meta property="og:title" content="The power of accessibilityRepresentation view modifier in SwiftUI" />
<meta name="author" content="Code4You" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="The SwiftUI Release 3 has a lot of improvements in the area of accessibility. It provides all the missing APIs like accessibility rotors, but it also gives us new ways of doing complex things efficiently. This week we will talk about the accessibilityRepresentation view modifier that allows us to replace accessibility elements of one view with another." />
<meta property="og:description" content="The SwiftUI Release 3 has a lot of improvements in the area of accessibility. It provides all the missing APIs like accessibility rotors, but it also gives us new ways of doing complex things efficiently. This week we will talk about the accessibilityRepresentation view modifier that allows us to replace accessibility elements of one view with another." />
<link rel="canonical" href="http://localhost:4000/2021/09/01/the-power-of-accessibility-representation-view-modifier-in-swiftui/" />
<meta property="og:url" content="http://localhost:4000/2021/09/01/the-power-of-accessibility-representation-view-modifier-in-swiftui/" />
<meta property="og:site_name" content="Code4You" />
<meta property="og:image" content="http://localhost:4000/public/accessibility.jpeg" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2021-09-01T00:00:00+08:00" />
<meta name="twitter:card" content="summary_large_image" />
<meta property="twitter:image" content="http://localhost:4000/public/accessibility.jpeg" />
<meta property="twitter:title" content="The power of accessibilityRepresentation view modifier in SwiftUI" />
<script type="application/ld+json">
{"@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/2021/09/01/the-power-of-accessibility-representation-view-modifier-in-swiftui/"},"url":"http://localhost:4000/2021/09/01/the-power-of-accessibility-representation-view-modifier-in-swiftui/","image":"http://localhost:4000/public/accessibility.jpeg","author":{"@type":"Person","name":"Code4You"},"headline":"The power of accessibilityRepresentation view modifier in SwiftUI","description":"The SwiftUI Release 3 has a lot of improvements in the area of accessibility. It provides all the missing APIs like accessibility rotors, but it also gives us new ways of doing complex things efficiently. This week we will talk about the accessibilityRepresentation view modifier that allows us to replace accessibility elements of one view with another.","dateModified":"2021-09-01T00:00:00+08:00","datePublished":"2021-09-01T00:00:00+08:00","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->


  <link rel="stylesheet" href="/styles.css">
  <link rel="shortcut icon" href="/public/favicon.ico">
  <link rel="alternate" type="application/atom+xml" title="Code4You" href="/feed.xml">
</head>


  <body>

    <div class="container content">
      <header class="masthead">
        <nav>
          <h1 class="masthead-title">
            <a href="/" title="Home">Code4You</a>
          </h1>
          <div>
            <a href="/categories" title="Categories">Categories</a>
            <a href="/archive" title="Archive">Archive</a>
            <a href="/feed.xml" title="Feed">Feed</a>
          </div>
        </nav>
      </header>

      <main>
        <article class="post">
  <h2 class="post-title">The power of accessibilityRepresentation view modifier in SwiftUI</h2>
  <time datetime="2021-09-01T00:00:00+08:00" class="post-date">01 Sep 2021</time>
  <p>The SwiftUI Release 3 has a lot of improvements in the area of accessibility. It provides all the missing APIs like accessibility rotors, but it also gives us new ways of doing complex things efficiently. This week we will talk about the <em>accessibilityRepresentation</em> view modifier that allows us to replace accessibility elements of one view with another.</p>

<p>Assume we are working on a super custom checkmark button that toggles its state only after a long press. Let’s take a look at the code we could write to implement this view.</p>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">import</span> <span class="kt">SwiftUI</span>

<span class="kd">struct</span> <span class="kt">LongPressCheckmark</span><span class="p">:</span> <span class="kt">View</span> <span class="p">{</span>
    <span class="kd">@Binding</span> <span class="k">var</span> <span class="nv">isSelected</span><span class="p">:</span> <span class="kt">Bool</span>

    <span class="k">var</span> <span class="nv">body</span><span class="p">:</span> <span class="kd">some</span> <span class="kt">View</span> <span class="p">{</span>
        <span class="kt">Image</span><span class="p">(</span><span class="nv">systemName</span><span class="p">:</span> <span class="n">isSelected</span> <span class="p">?</span> <span class="s">"checkmark.rectangle"</span> <span class="p">:</span> <span class="s">"rectangle"</span><span class="p">)</span>
            <span class="o">.</span><span class="n">onLongPressGesture</span> <span class="p">{</span> <span class="n">isSelected</span><span class="o">.</span><span class="nf">toggle</span><span class="p">()</span> <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>The code above looks simple. We have a binding to a boolean value indicating the selection of the checkmark. We also have an image presenting a checkmark or empty rectangle depending on the value of the binding. I added a long-press gesture to the image that toggles the boolean binding.</p>

<p>The main downside of the code above is the accessibility support. VoiceOver recognizes the image and doesn’t provide information about the selection state, possible actions, etc. We can improve the accessibility support manually by using the set of provided accessibility view modifiers in SwiftUI.</p>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">import</span> <span class="kt">SwiftUI</span>

<span class="kd">struct</span> <span class="kt">LongPressCheckmark</span><span class="p">:</span> <span class="kt">View</span> <span class="p">{</span>
    <span class="kd">@Binding</span> <span class="k">var</span> <span class="nv">isSelected</span><span class="p">:</span> <span class="kt">Bool</span>

    <span class="k">var</span> <span class="nv">body</span><span class="p">:</span> <span class="kd">some</span> <span class="kt">View</span> <span class="p">{</span>
        <span class="kt">Image</span><span class="p">(</span><span class="nv">systemName</span><span class="p">:</span> <span class="n">isSelected</span> <span class="p">?</span> <span class="s">"checkmark.rectangle"</span> <span class="p">:</span> <span class="s">"rectangle"</span><span class="p">)</span>
            <span class="o">.</span><span class="n">onLongPressGesture</span> <span class="p">{</span> <span class="n">isSelected</span><span class="o">.</span><span class="nf">toggle</span><span class="p">()</span> <span class="p">}</span>
            <span class="o">.</span><span class="nf">accessibilityRemoveTraits</span><span class="p">(</span><span class="o">.</span><span class="n">isImage</span><span class="p">)</span>
            <span class="o">.</span><span class="nf">accessibilityAddTraits</span><span class="p">(</span><span class="o">.</span><span class="n">isButton</span><span class="p">)</span>
            <span class="o">.</span><span class="nf">accessibilityAddTraits</span><span class="p">(</span><span class="n">isSelected</span> <span class="p">?</span> <span class="o">.</span><span class="nv">isSelected</span> <span class="p">:</span> <span class="p">[])</span>
            <span class="o">.</span><span class="nf">accessibilityLabel</span><span class="p">(</span><span class="kt">Text</span><span class="p">(</span><span class="s">"Checkmark"</span><span class="p">))</span>
            <span class="o">.</span><span class="nf">accessibilityHint</span><span class="p">(</span><span class="s">"You can toggle the checkmark"</span><span class="p">)</span>
            <span class="o">.</span><span class="n">accessibilityAction</span> <span class="p">{</span> <span class="n">isSelected</span><span class="o">.</span><span class="nf">toggle</span><span class="p">()</span> <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<blockquote>
  <p>To learn about the basics of accessibility in SwiftUI, take a look at my <a href="/2019/09/10/accessibility-in-swiftui/">“Accessibility in SwiftUI”</a> post.</p>
</blockquote>

<p>Here we add accessibility modifiers to provide information about the current state of the checkmark, an accessibility action to toggle the state, and the accessibility label with the hint. We have much more accessibility-related lines of code than button logic. Fortunately, SwiftUI provides us a way to simplify the code above by using the <em>accessibilityRepresentation</em> view modifier.</p>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">import</span> <span class="kt">SwiftUI</span>

<span class="kd">struct</span> <span class="kt">LongPressCheckmark</span><span class="p">:</span> <span class="kt">View</span> <span class="p">{</span>
    <span class="kd">@Binding</span> <span class="k">var</span> <span class="nv">isSelected</span><span class="p">:</span> <span class="kt">Bool</span>

    <span class="k">var</span> <span class="nv">body</span><span class="p">:</span> <span class="kd">some</span> <span class="kt">View</span> <span class="p">{</span>
        <span class="kt">Image</span><span class="p">(</span><span class="nv">systemName</span><span class="p">:</span> <span class="n">isSelected</span> <span class="p">?</span> <span class="s">"checkmark.rectangle"</span> <span class="p">:</span> <span class="s">"rectangle"</span><span class="p">)</span>
            <span class="o">.</span><span class="n">onLongPressGesture</span> <span class="p">{</span> <span class="n">isSelected</span><span class="o">.</span><span class="nf">toggle</span><span class="p">()</span> <span class="p">}</span>
            <span class="o">.</span><span class="n">accessibilityRepresentation</span> <span class="p">{</span>
                <span class="kt">Toggle</span><span class="p">(</span><span class="nv">isOn</span><span class="p">:</span> <span class="err">$</span><span class="n">isSelected</span><span class="p">)</span> <span class="p">{</span>
                    <span class="kt">Text</span><span class="p">(</span><span class="s">"Checkmark"</span><span class="p">)</span>
                <span class="p">}</span>
            <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>As you can see, we replace all the accessibility-related lines of code with the single <em>accessibilityRepresentation</em> view modifier. <em>accessibilityRepresentation</em> view modifier replaces the accessibility element of the current view with the accessibility information of the view you provide in the closure. SwiftUI doesn’t render the view you provide in the closure. SwiftUI uses it only for generating accessibility information.</p>

<p>Whenever you build a custom view that has logic similar to the view in SwiftUI, you can use the <em>accessibilityRepresentation</em> view modifier to generate accessibility behavior for your custom view automatically from that SwiftUI view.</p>

<p>In the previous example, we used the standard <em>Toggle</em> to extract its accessibility information. I should mention that the <em>accessibilityRepresentation</em> view modifier works both with plain views and complex view hierarchies. In the following example, we will build a custom bar chart view.</p>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">struct</span> <span class="kt">Bar</span><span class="p">:</span> <span class="kt">Identifiable</span> <span class="p">{</span>
    <span class="k">let</span> <span class="nv">id</span><span class="p">:</span> <span class="kt">UUID</span>
    <span class="k">let</span> <span class="nv">value</span><span class="p">:</span> <span class="kt">Double</span>
    <span class="k">let</span> <span class="nv">label</span><span class="p">:</span> <span class="kt">String</span>
<span class="p">}</span>

<span class="kd">struct</span> <span class="kt">BarChartView</span><span class="p">:</span> <span class="kt">View</span> <span class="p">{</span>
    <span class="k">let</span> <span class="nv">bars</span><span class="p">:</span> <span class="p">[</span><span class="kt">Bar</span><span class="p">]</span>

    <span class="k">var</span> <span class="nv">body</span><span class="p">:</span> <span class="kd">some</span> <span class="kt">View</span> <span class="p">{</span>
        <span class="kt">Canvas</span> <span class="p">{</span>
            <span class="c1">// custom drawing here</span>
        <span class="p">}</span><span class="o">.</span><span class="n">accessibilityRepresentation</span> <span class="p">{</span>
            <span class="kt">HStack</span> <span class="p">{</span>
                <span class="kt">ForEach</span><span class="p">(</span><span class="n">bars</span><span class="p">)</span> <span class="p">{</span> <span class="n">bar</span> <span class="k">in</span>
                    <span class="kt">Rectangle</span><span class="p">()</span>
                        <span class="o">.</span><span class="nf">accessibilityLabel</span><span class="p">(</span><span class="n">bar</span><span class="o">.</span><span class="n">label</span><span class="p">)</span>
                        <span class="o">.</span><span class="nf">accessibilityValue</span><span class="p">(</span><span class="s">"</span><span class="se">\(</span><span class="n">bar</span><span class="o">.</span><span class="n">value</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>Here we use the new <em>Canvas</em> view for custom drawing. <em>Canvas</em> view doesn’t support accessibility out of the box. Fortunately, we can use the <em>accessibilityRepresentation</em> view modifier to generate the accessibility information for our chart from the view hierarchy with <em>HStack</em>.</p>

<p>The new <em>accessibilityRepresentation</em> view modifier drastically simplifies the accessibility support for custom views. Remember that accessibility isn’t a feature or a “nice to have”. It’s a necessity. So let’s make your app accessible for everyone. I hope you enjoy the post. Feel free to follow me on <a href="https://twitter.com/mecid">Twitter</a> and ask your questions related to this post. Thanks for reading, and see you next week!</p>


</article>


<aside class="related">
  <h4>Recent posts</h4>
  <ul class="related-posts">
    
      <li>
        <a title="Custom accessibility content in SwiftUI" href="/2021/10/06/custom-accessibility-content-in-swiftui/">
          Custom accessibility content in SwiftUI
          <small><time datetime="2021-10-06T00:00:00+08:00">06 Oct 2021</time></small>
        </a>
      </li>
    
      <li>
        <a title="Audio graphs in SwiftUI" href="/2021/09/29/audio-graphs-in-swiftui/">
          Audio graphs in SwiftUI
          <small><time datetime="2021-09-29T00:00:00+08:00">29 Sep 2021</time></small>
        </a>
      </li>
    
      <li>
        <a title="Accessibility focus in SwiftUI" href="/2021/09/23/accessibility-focus-in-swiftui/">
          Accessibility focus in SwiftUI
          <small><time datetime="2021-09-23T00:00:00+08:00">23 Sep 2021</time></small>
        </a>
      </li>
    
  </ul>
</aside>


      </main>

      <footer class="footer">
          <img class="avatar" alt="mecid" width="100" height="100" data-proofer-ignore="true" src="https://avatars2.githubusercontent.com/mecid?v=3&s=100" srcset="https://avatars2.githubusercontent.com/mecid?v=3&s=100 1x, https://avatars2.githubusercontent.com/mecid?v=3&s=200 2x, https://avatars2.githubusercontent.com/mecid?v=3&s=300 3x, https://avatars2.githubusercontent.com/mecid?v=3&s=400 4x" />
          <small>Hi there! I am code4you,I like to program, and do some App.</small>
          <small>I'm a developer</small>
          <small>Feel free to follow me on <a href="https://github.com/code4you2021">Github</a>.</small>
        <small>
          &copy; <time datetime="2021-10-17T11:25:11+08:00">2021</time>. All rights reserved.
        </small>
      </footer>
    </div>

    
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-1WQVZK1CR7"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-18491817-18');
    </script>
    
  </body>
</html>
