<!DOCTYPE html>
<html lang="en">

  <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="keywords" content="swift ios development apple watch iphone ipad swiftui macos uikit dev wwdc tutorial guide redux tea state container" />

  <!-- Begin Jekyll SEO tag v2.7.1 -->
<title>GraphQL in Swift | Code4You</title>
<meta name="generator" content="Jekyll v3.9.0" />
<meta property="og:title" content="GraphQL in Swift" />
<meta name="author" content="Code4You" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="I spent last weeks sharing more about type-safety and building robust APIs in Swift. I want to continue the type-safety topic by talking about GraphQL. GraphQL is a query language for your API. This week we will talk about the benefits of GraphQL, and we will learn how to utilize it in Swift." />
<meta property="og:description" content="I spent last weeks sharing more about type-safety and building robust APIs in Swift. I want to continue the type-safety topic by talking about GraphQL. GraphQL is a query language for your API. This week we will talk about the benefits of GraphQL, and we will learn how to utilize it in Swift." />
<link rel="canonical" href="http://localhost:4000/2021/02/24/graphql-in-swift/" />
<meta property="og:url" content="http://localhost:4000/2021/02/24/graphql-in-swift/" />
<meta property="og:site_name" content="Code4You" />
<meta property="og:image" content="http://localhost:4000/public/graphql.png" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2021-02-24T00:00:00+08:00" />
<meta name="twitter:card" content="summary_large_image" />
<meta property="twitter:image" content="http://localhost:4000/public/graphql.png" />
<meta property="twitter:title" content="GraphQL in Swift" />
<script type="application/ld+json">
{"@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/2021/02/24/graphql-in-swift/"},"url":"http://localhost:4000/2021/02/24/graphql-in-swift/","image":"http://localhost:4000/public/graphql.png","author":{"@type":"Person","name":"Code4You"},"headline":"GraphQL in Swift","description":"I spent last weeks sharing more about type-safety and building robust APIs in Swift. I want to continue the type-safety topic by talking about GraphQL. GraphQL is a query language for your API. This week we will talk about the benefits of GraphQL, and we will learn how to utilize it in Swift.","dateModified":"2021-02-24T00:00:00+08:00","datePublished":"2021-02-24T00:00:00+08:00","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->


  <link rel="stylesheet" href="/styles.css">
  <link rel="shortcut icon" href="/public/favicon.ico">
  <link rel="alternate" type="application/atom+xml" title="Code4You" href="/feed.xml">
</head>


  <body>

    <div class="container content">
      <header class="masthead">
        <nav>
          <h1 class="masthead-title">
            <a href="/" title="Home">Code4You</a>
          </h1>
          <div>
            <a href="/categories" title="Categories">Categories</a>
            <a href="/archive" title="Archive">Archive</a>
            <a href="/feed.xml" title="Feed">Feed</a>
          </div>
        </nav>
      </header>

      <main>
        <article class="post">
  <h2 class="post-title">GraphQL in Swift</h2>
  <time datetime="2021-02-24T00:00:00+08:00" class="post-date">24 Feb 2021</time>
  <p>I spent last weeks sharing more about type-safety and building robust APIs in Swift. I want to continue the type-safety topic by talking about GraphQL. GraphQL is a query language for your API. This week we will talk about the benefits of GraphQL, and we will learn how to utilize it in Swift.</p>

<!-- <div class="ads">
    <span>
        Why don’t more iOS apps use voice? Machine learning for voice is hard, and using Siri is clunky and rigid. So we open-sourced an iOS library (also Android, Node, Python, & React Native), and built a no-code web tool to make custom wake words, speech recognizers, and AI voices—for all devs! <a href="https://www.spokestack.io/?utm_source=swiftui_weekly&utm_medium=email&utm_campaign=maker_launch_PAID">Try it for free.</a>
    </span>
</div> -->

<h4 id="basics">Basics</h4>
<p>Let me introduce GraphQL first. GraphQL is a query language for your API. Usually, a backend developer or web service should provide you a schema file and a single GraphQL endpoint. Schema file contains all the types and queries which you can make with the particular endpoint. Let’s take a look at the example of the schema file.</p>

<div class="language-graphql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">schema</span><span class="w"> </span><span class="p">{</span><span class="w">
  </span><span class="n">query</span><span class="p">:</span><span class="w"> </span><span class="n">Query</span><span class="w">
  </span><span class="n">mutation</span><span class="p">:</span><span class="w"> </span><span class="n">Mutation</span><span class="w">
</span><span class="p">}</span><span class="w">

</span><span class="k">type</span><span class="w"> </span><span class="n">Query</span><span class="w"> </span><span class="p">{</span><span class="w">
  </span><span class="n">film</span><span class="p">(</span><span class="n">id</span><span class="p">:</span><span class="w"> </span><span class="nb">ID</span><span class="p">,</span><span class="w"> </span><span class="n">filmID</span><span class="p">:</span><span class="w"> </span><span class="nb">ID</span><span class="p">):</span><span class="w"> </span><span class="n">Film</span><span class="w">
  </span><span class="n">allFilms</span><span class="p">(</span><span class="n">after</span><span class="p">:</span><span class="w"> </span><span class="nb">String</span><span class="p">,</span><span class="w"> </span><span class="n">first</span><span class="p">:</span><span class="w"> </span><span class="nb">Int</span><span class="p">,</span><span class="w"> </span><span class="n">before</span><span class="p">:</span><span class="w"> </span><span class="nb">String</span><span class="p">,</span><span class="w"> </span><span class="n">last</span><span class="p">:</span><span class="w"> </span><span class="nb">Int</span><span class="p">):</span><span class="w"> </span><span class="n">FilmsConnection</span><span class="w">
  </span><span class="err">"""</span><span class="n">more</span><span class="w"> </span><span class="n">code</span><span class="w"> </span><span class="n">here</span><span class="err">"""</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p>The schema file should contain <em>Query</em> and <em>Mutation</em> types. These types define all the queries and mutations that the current GraphQL endpoint supports. The schema file also describes the list of all the types that you can use in your queries.</p>

<div class="language-graphql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">type</span><span class="w"> </span><span class="n">Film</span><span class="w"> </span><span class="k">implements</span><span class="w"> </span><span class="n">Node</span><span class="w"> </span><span class="p">{</span><span class="w">
  </span><span class="n">title</span><span class="p">:</span><span class="w"> </span><span class="nb">String</span><span class="p">!</span><span class="w">

  </span><span class="n">episodeID</span><span class="p">:</span><span class="w"> </span><span class="nb">Int</span><span class="w">

  </span><span class="n">openingCrawl</span><span class="p">:</span><span class="w"> </span><span class="nb">String</span><span class="w">

  </span><span class="n">director</span><span class="p">:</span><span class="w"> </span><span class="nb">String</span><span class="p">!</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p>GraphQL is a strongly typed language. Every field defined inside a GraphQL custom type must declare its type. By default, every field can contain nil as a value. The fields having exclamation marks can’t be nil.</p>

<p>I use Star Wars API to show you examples in this post. Let’s continue by making some queries. You can easily play with GraphQL API using the GraphiQL app by using this <a href="https://swapi-graphql.netlify.app/.netlify/functions/index">endpoint</a>.</p>

<div class="language-graphql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">query</span><span class="w"> </span><span class="n">AllFilms</span><span class="w"> </span><span class="p">{</span><span class="w">
  </span><span class="n">allFilms</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">films</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="n">title</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">

</span><span class="err">"""response:</span><span class="w">
</span><span class="p">{</span><span class="w">
  </span><span class="err">"</span><span class="n">data</span><span class="err">":</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="err">"</span><span class="n">allFilms</span><span class="err">":</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="err">"</span><span class="n">films</span><span class="err">":</span><span class="w"> </span><span class="err">[</span><span class="w">
        </span><span class="p">{</span><span class="w">
          </span><span class="err">"</span><span class="n">title</span><span class="err">":</span><span class="w"> </span><span class="err">"</span><span class="n">A</span><span class="w"> </span><span class="n">New</span><span class="w"> </span><span class="n">Hope</span><span class="err">"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
          </span><span class="err">"</span><span class="n">title</span><span class="err">":</span><span class="w"> </span><span class="err">"</span><span class="n">The</span><span class="w"> </span><span class="n">Empire</span><span class="w"> </span><span class="n">Strikes</span><span class="w"> </span><span class="n">Back</span><span class="err">"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
          </span><span class="err">"</span><span class="n">title</span><span class="err">":</span><span class="w"> </span><span class="err">"</span><span class="n">Return</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">Jedi</span><span class="err">"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
          </span><span class="err">"</span><span class="n">title</span><span class="err">":</span><span class="w"> </span><span class="err">"</span><span class="n">The</span><span class="w"> </span><span class="n">Phantom</span><span class="w"> </span><span class="n">Menace</span><span class="err">"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
          </span><span class="err">"</span><span class="n">title</span><span class="err">":</span><span class="w"> </span><span class="err">"</span><span class="n">Attack</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">Clones</span><span class="err">"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
          </span><span class="err">"</span><span class="n">title</span><span class="err">":</span><span class="w"> </span><span class="err">"</span><span class="n">Revenge</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">Sith</span><span class="err">"</span><span class="w">
        </span><span class="p">}</span><span class="w">
      </span><span class="err">]</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span><span class="err">"""</span><span class="w">
</span></code></pre></div></div>

<p>As you can see, we use the data types from the schema file to build our query. One thing that I love about GraphQL is the response format. Request format is directly mapped to the response format. You can add more fields to your request, and the response will have them also.</p>

<div class="language-graphql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">query</span><span class="w"> </span><span class="n">AllFilms</span><span class="w"> </span><span class="p">{</span><span class="w">
  </span><span class="n">allFilms</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">films</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="n">title</span><span class="w">
      </span><span class="n">director</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">

</span><span class="err">"""response</span><span class="w">
</span><span class="p">{</span><span class="w">
  </span><span class="err">"</span><span class="n">data</span><span class="err">":</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="err">"</span><span class="n">allFilms</span><span class="err">":</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="err">"</span><span class="n">films</span><span class="err">":</span><span class="w"> </span><span class="err">[</span><span class="w">
        </span><span class="p">{</span><span class="w">
          </span><span class="err">"</span><span class="n">title</span><span class="err">":</span><span class="w"> </span><span class="err">"</span><span class="n">A</span><span class="w"> </span><span class="n">New</span><span class="w"> </span><span class="n">Hope</span><span class="err">"</span><span class="p">,</span><span class="w">
          </span><span class="err">"</span><span class="n">director</span><span class="err">":</span><span class="w"> </span><span class="err">"</span><span class="n">George</span><span class="w"> </span><span class="n">Lucas</span><span class="err">"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
          </span><span class="err">"</span><span class="n">title</span><span class="err">":</span><span class="w"> </span><span class="err">"</span><span class="n">The</span><span class="w"> </span><span class="n">Empire</span><span class="w"> </span><span class="n">Strikes</span><span class="w"> </span><span class="n">Back</span><span class="err">"</span><span class="p">,</span><span class="w">
          </span><span class="err">"</span><span class="n">director</span><span class="err">":</span><span class="w"> </span><span class="err">"</span><span class="n">Irvin</span><span class="w"> </span><span class="n">Kershner</span><span class="err">"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
          </span><span class="err">"</span><span class="n">title</span><span class="err">":</span><span class="w"> </span><span class="err">"</span><span class="n">Return</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">Jedi</span><span class="err">"</span><span class="p">,</span><span class="w">
          </span><span class="err">"</span><span class="n">director</span><span class="err">":</span><span class="w"> </span><span class="err">"</span><span class="n">Richard</span><span class="w"> </span><span class="n">Marquand</span><span class="err">"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
          </span><span class="err">"</span><span class="n">title</span><span class="err">":</span><span class="w"> </span><span class="err">"</span><span class="n">The</span><span class="w"> </span><span class="n">Phantom</span><span class="w"> </span><span class="n">Menace</span><span class="err">"</span><span class="p">,</span><span class="w">
          </span><span class="err">"</span><span class="n">director</span><span class="err">":</span><span class="w"> </span><span class="err">"</span><span class="n">George</span><span class="w"> </span><span class="n">Lucas</span><span class="err">"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
          </span><span class="err">"</span><span class="n">title</span><span class="err">":</span><span class="w"> </span><span class="err">"</span><span class="n">Attack</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">Clones</span><span class="err">"</span><span class="p">,</span><span class="w">
          </span><span class="err">"</span><span class="n">director</span><span class="err">":</span><span class="w"> </span><span class="err">"</span><span class="n">George</span><span class="w"> </span><span class="n">Lucas</span><span class="err">"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
          </span><span class="err">"</span><span class="n">title</span><span class="err">":</span><span class="w"> </span><span class="err">"</span><span class="n">Revenge</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">Sith</span><span class="err">"</span><span class="p">,</span><span class="w">
          </span><span class="err">"</span><span class="n">director</span><span class="err">":</span><span class="w"> </span><span class="err">"</span><span class="n">George</span><span class="w"> </span><span class="n">Lucas</span><span class="err">"</span><span class="w">
        </span><span class="p">}</span><span class="w">
      </span><span class="err">]</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span><span class="err">"""</span><span class="w">
</span></code></pre></div></div>

<p>Using GraphQL we only get the data that we request. Nothing more.</p>

<h4 id="apollographql">ApolloGraphQL</h4>
<p>ApolloGraphQL is a great framework that allows you easily make GraphQL queries and mutations. ApolloGraphQL iOS framework takes care of caching and code generation. ApolloGraphQL generates Swift types for queries and mutations that you define in your project. It saves your time by generating all the boilerplate for you automatically.</p>

<p>There are a few steps that you need to do to setup ApolloGraphQL in your project:</p>
<ol>
  <li>You should embed ApolloGraphQL into your project using SPM or another package manager.</li>
  <li>Add <a href="https://gist.github.com/mecid/6b19cc006939855748604de16bf12eca">run script</a> to your build phases above the compile sources section. This script downloads the schema and generates Swift types for your queries. You can easily change the GraphQL endpoint in this script to connect to your GraphQL backend.</li>
</ol>

<p>We have prepared the project to use ApolloGraphQL. Now we can add the first query to our project. We should create a file in the project with the .graphql extension and put these lines into the file.</p>

<div class="language-graphql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">query</span><span class="w"> </span><span class="n">AllFilms</span><span class="w"> </span><span class="p">{</span><span class="w">
  </span><span class="n">allFilms</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">films</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="n">title</span><span class="w">
      </span><span class="n">director</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p>Let’s build the project now. ApolloGraphQL generates an API.swift file that you should add to the project. There are all the needed types to make GraphQL queries in a very type-safe way. Every request type defines its response type. ApolloGraphQL generated <em>AllFilmsQuery</em> and <em>Data</em> types that describe the request and response. Now we can use generated code to make GraphQL requests.</p>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">let</span> <span class="nv">url</span> <span class="o">=</span> <span class="kt">URL</span><span class="p">(</span><span class="nv">string</span><span class="p">:</span> <span class="s">"https://swapi-graphql.netlify.app/.netlify/functions/index"</span><span class="p">)</span><span class="o">!</span>
<span class="k">let</span> <span class="nv">client</span> <span class="o">=</span> <span class="kt">ApolloClient</span><span class="p">(</span><span class="nv">url</span><span class="p">:</span> <span class="n">url</span><span class="p">)</span>

<span class="n">client</span><span class="o">.</span><span class="nf">fetch</span><span class="p">(</span><span class="nv">query</span><span class="p">:</span> <span class="kt">AllFilmsQuery</span><span class="p">())</span> <span class="p">{</span> <span class="n">result</span> <span class="k">in</span>
    <span class="k">switch</span> <span class="n">result</span> <span class="p">{</span>
    <span class="k">case</span> <span class="o">.</span><span class="nf">success</span><span class="p">(</span><span class="k">let</span> <span class="nv">response</span><span class="p">):</span>
        <span class="nf">print</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">data</span><span class="p">?</span><span class="o">.</span><span class="n">allFilms</span><span class="p">?</span><span class="o">.</span><span class="n">films</span> <span class="p">??</span> <span class="p">[])</span>
    <span class="k">case</span> <span class="o">.</span><span class="nf">failure</span><span class="p">(</span><span class="k">let</span> <span class="nv">error</span><span class="p">):</span>
        <span class="nf">print</span><span class="p">(</span><span class="n">error</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<h4 id="conclusion">Conclusion</h4>
<p>There are a lot of benefits of GraphQL over REST API. But remember, everything comes with its own set of pros and cons. GraphQL is a great way to build an efficient and type-safe backend for your app. I will try to cover more advanced features of GraphQL in the next posts. I hope you enjoy the post. Feel free to follow me on <a href="https://twitter.com/mecid">Twitter</a> and ask your questions related to this article. Thanks for reading, and see you next week!</p>

</article>


<aside class="related">
  <h4>Recent posts</h4>
  <ul class="related-posts">
    
      <li>
        <a title="Custom accessibility content in SwiftUI" href="/2021/10/06/custom-accessibility-content-in-swiftui/">
          Custom accessibility content in SwiftUI
          <small><time datetime="2021-10-06T00:00:00+08:00">06 Oct 2021</time></small>
        </a>
      </li>
    
      <li>
        <a title="Audio graphs in SwiftUI" href="/2021/09/29/audio-graphs-in-swiftui/">
          Audio graphs in SwiftUI
          <small><time datetime="2021-09-29T00:00:00+08:00">29 Sep 2021</time></small>
        </a>
      </li>
    
      <li>
        <a title="Accessibility focus in SwiftUI" href="/2021/09/23/accessibility-focus-in-swiftui/">
          Accessibility focus in SwiftUI
          <small><time datetime="2021-09-23T00:00:00+08:00">23 Sep 2021</time></small>
        </a>
      </li>
    
  </ul>
</aside>


      </main>

      <footer class="footer">
          <img class="avatar" alt="mecid" width="100" height="100" data-proofer-ignore="true" src="https://avatars2.githubusercontent.com/mecid?v=3&s=100" srcset="https://avatars2.githubusercontent.com/mecid?v=3&s=100 1x, https://avatars2.githubusercontent.com/mecid?v=3&s=200 2x, https://avatars2.githubusercontent.com/mecid?v=3&s=300 3x, https://avatars2.githubusercontent.com/mecid?v=3&s=400 4x" />
          <small>Hi there! I am code4you,I like to program, and do some App.</small>
          <small>I'm a developer</small>
          <small>Feel free to follow me on <a href="https://github.com/code4you2021">Github</a>.</small>
        <small>
          &copy; <time datetime="2021-10-17T11:25:11+08:00">2021</time>. All rights reserved.
        </small>
      </footer>
    </div>

    
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-1WQVZK1CR7"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-18491817-18');
    </script>
    
  </body>
</html>
