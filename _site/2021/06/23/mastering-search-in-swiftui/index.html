<!DOCTYPE html>
<html lang="en">

  <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="keywords" content="swift ios development apple watch iphone ipad swiftui macos uikit dev wwdc tutorial guide redux tea state container" />

  <!-- Begin Jekyll SEO tag v2.7.1 -->
<title>Mastering search in SwiftUI | Code4You</title>
<meta name="generator" content="Jekyll v3.9.0" />
<meta property="og:title" content="Mastering search in SwiftUI" />
<meta name="author" content="Code4You" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="SwiftUI Release 3.0 brought tons of expected features that we missed in previous iterations. One of them is the ability to provide the search feature in our apps. Fortunately, we have a new searchable view modifier. This week, we will learn about the new searchable modifier and how to build a great search experience using it." />
<meta property="og:description" content="SwiftUI Release 3.0 brought tons of expected features that we missed in previous iterations. One of them is the ability to provide the search feature in our apps. Fortunately, we have a new searchable view modifier. This week, we will learn about the new searchable modifier and how to build a great search experience using it." />
<link rel="canonical" href="http://localhost:4000/2021/06/23/mastering-search-in-swiftui/" />
<meta property="og:url" content="http://localhost:4000/2021/06/23/mastering-search-in-swiftui/" />
<meta property="og:site_name" content="Code4You" />
<meta property="og:image" content="http://localhost:4000/public/search.png" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2021-06-23T00:00:00+08:00" />
<meta name="twitter:card" content="summary_large_image" />
<meta property="twitter:image" content="http://localhost:4000/public/search.png" />
<meta property="twitter:title" content="Mastering search in SwiftUI" />
<script type="application/ld+json">
{"@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/2021/06/23/mastering-search-in-swiftui/"},"url":"http://localhost:4000/2021/06/23/mastering-search-in-swiftui/","image":"http://localhost:4000/public/search.png","author":{"@type":"Person","name":"Code4You"},"headline":"Mastering search in SwiftUI","description":"SwiftUI Release 3.0 brought tons of expected features that we missed in previous iterations. One of them is the ability to provide the search feature in our apps. Fortunately, we have a new searchable view modifier. This week, we will learn about the new searchable modifier and how to build a great search experience using it.","dateModified":"2021-06-23T00:00:00+08:00","datePublished":"2021-06-23T00:00:00+08:00","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->


  <link rel="stylesheet" href="/styles.css">
  <link rel="shortcut icon" href="/public/favicon.ico">
  <link rel="alternate" type="application/atom+xml" title="Code4You" href="/feed.xml">
</head>


  <body>

    <div class="container content">
      <header class="masthead">
        <nav>
          <h1 class="masthead-title">
            <a href="/" title="Home">Code4You</a>
          </h1>
          <div>
            <a href="/categories" title="Categories">Categories</a>
            <a href="/archive" title="Archive">Archive</a>
            <a href="/feed.xml" title="Feed">Feed</a>
          </div>
        </nav>
      </header>

      <main>
        <article class="post">
  <h2 class="post-title">Mastering search in SwiftUI</h2>
  <time datetime="2021-06-23T00:00:00+08:00" class="post-date">23 Jun 2021</time>
  <p>SwiftUI Release 3.0 brought tons of expected features that we missed in previous iterations. One of them is the ability to provide the search feature in our apps. Fortunately, we have a new <em>searchable</em> view modifier. This week, we will learn about the new <em>searchable</em> modifier and how to build a great search experience using it.</p>

<!-- <div class="ads">
    <span>
        Why don’t more iOS apps use voice? Machine learning for voice is hard, and using Siri is clunky and rigid. So we open-sourced an iOS library (also Android, Node, Python, & React Native), and built a no-code web tool to make custom wake words, speech recognizers, and AI voices—for all devs! <a href="https://www.spokestack.io/?utm_source=swiftui_weekly&utm_medium=email&utm_campaign=maker_launch_PAID">Try it for free.</a>
    </span>
</div> -->

<h4 id="basics">Basics</h4>
<p>We can mark the content of our view as searchable using the new view modifier. SwiftUI understands the structure of your app and displays the search bar in the appropriate place. Let’s take a look at the quick example.</p>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">struct</span> <span class="kt">RootView</span><span class="p">:</span> <span class="kt">View</span> <span class="p">{</span>
    <span class="kd">@State</span> <span class="kd">private</span> <span class="k">var</span> <span class="nv">query</span><span class="p">:</span> <span class="kt">String</span> <span class="o">=</span> <span class="s">""</span>

    <span class="k">var</span> <span class="nv">body</span><span class="p">:</span> <span class="kd">some</span> <span class="kt">View</span> <span class="p">{</span>
        <span class="kt">NavigationView</span> <span class="p">{</span>
            <span class="kt">Master</span><span class="p">()</span>
            <span class="kt">Details</span><span class="p">()</span>
        <span class="p">}</span>
        <span class="o">.</span><span class="nf">searchable</span><span class="p">(</span><span class="nv">text</span><span class="p">:</span> <span class="err">$</span><span class="n">query</span><span class="p">,</span> <span class="nv">prompt</span><span class="p">:</span> <span class="s">"Search"</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p><img src="/public/search.png" alt="search" /></p>

<p>We attach the <em>searchable</em> view modifier to the <em>NavigationView</em> at the root of our app. SwiftUI can put the search bar in different places depending on the environment. For example, it will put a search bar in the <em>Master</em> view on iOS and iPadOS. On macOS, SwiftUI places the search bar in the toolbar of the trailing column of the <em>NavigationView</em>.</p>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">struct</span> <span class="kt">RootView</span><span class="p">:</span> <span class="kt">View</span> <span class="p">{</span>
    <span class="kd">@State</span> <span class="kd">private</span> <span class="k">var</span> <span class="nv">query</span><span class="p">:</span> <span class="kt">String</span> <span class="o">=</span> <span class="s">""</span>

    <span class="k">var</span> <span class="nv">body</span><span class="p">:</span> <span class="kd">some</span> <span class="kt">View</span> <span class="p">{</span>
        <span class="kt">NavigationView</span> <span class="p">{</span>
            <span class="kt">Master</span><span class="p">()</span>
            <span class="kt">Details</span><span class="p">()</span>
        <span class="p">}</span>
        <span class="o">.</span><span class="nf">searchable</span><span class="p">(</span>
            <span class="s">"Type something..."</span><span class="p">,</span>
            <span class="nv">text</span><span class="p">:</span> <span class="err">$</span><span class="n">query</span><span class="p">,</span>
            <span class="nv">placement</span><span class="p">:</span> <span class="o">.</span><span class="n">toolbar</span>
        <span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>You can also suggest placement for the search bar using the <em>placement</em> parameter, but keep in mind that SwiftUI can ignore it. A few possible placements for the search bar are <em>automatic</em>, which is the default one, <em>sidebar, toolbar, and navigationBarDrawer.</em></p>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">struct</span> <span class="kt">ContentView</span><span class="p">:</span> <span class="kt">View</span> <span class="p">{</span>
    <span class="kd">@StateObject</span> <span class="kd">private</span> <span class="k">var</span> <span class="nv">viewModel</span> <span class="o">=</span> <span class="kt">SearchViewModel</span><span class="p">()</span>
    <span class="kd">@State</span> <span class="kd">private</span> <span class="k">var</span> <span class="nv">query</span> <span class="o">=</span> <span class="s">""</span>

    <span class="k">var</span> <span class="nv">body</span><span class="p">:</span> <span class="kd">some</span> <span class="kt">View</span> <span class="p">{</span>
        <span class="kt">NavigationView</span> <span class="p">{</span>
            <span class="kt">List</span><span class="p">(</span><span class="n">viewModel</span><span class="o">.</span><span class="n">repos</span><span class="p">)</span> <span class="p">{</span> <span class="n">repo</span> <span class="k">in</span>
                <span class="kt">VStack</span><span class="p">(</span><span class="nv">alignment</span><span class="p">:</span> <span class="o">.</span><span class="n">leading</span><span class="p">)</span> <span class="p">{</span>
                    <span class="kt">Text</span><span class="p">(</span><span class="n">repo</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
                        <span class="o">.</span><span class="nf">font</span><span class="p">(</span><span class="o">.</span><span class="n">headline</span><span class="p">)</span>
                    <span class="kt">Text</span><span class="p">(</span><span class="n">repo</span><span class="o">.</span><span class="n">description</span> <span class="p">??</span> <span class="s">""</span><span class="p">)</span>
                        <span class="o">.</span><span class="nf">foregroundColor</span><span class="p">(</span><span class="o">.</span><span class="n">secondary</span><span class="p">)</span>
                <span class="p">}</span>
            <span class="p">}</span>
            <span class="o">.</span><span class="nf">navigationTitle</span><span class="p">(</span><span class="s">"Search"</span><span class="p">)</span>
            <span class="o">.</span><span class="nf">searchable</span><span class="p">(</span><span class="nv">text</span><span class="p">:</span> <span class="err">$</span><span class="n">query</span><span class="p">)</span>
            <span class="o">.</span><span class="nf">onChange</span><span class="p">(</span><span class="nv">of</span><span class="p">:</span> <span class="n">query</span><span class="p">)</span> <span class="p">{</span> <span class="n">newQuery</span> <span class="k">in</span>
                <span class="n">async</span> <span class="p">{</span> <span class="n">await</span> <span class="n">viewModel</span><span class="o">.</span><span class="nf">search</span><span class="p">(</span><span class="nv">matching</span><span class="p">:</span> <span class="n">query</span><span class="p">)</span> <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>Whenever we use the <em>searchable</em> modifier, we should provide a binding to a string value. We can observe changes and filter our content depending on the query term using that binding.</p>

<h4 id="environment">Environment</h4>
<p>SwiftUI provides us <em>isSearching</em> environment value that indicated whether the user is currently interacting with the search bar that has been placed by a surrounding <em>searchable</em> modifier. We can use this value to understand whether to show quick search results.</p>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">struct</span> <span class="kt">StarredReposList</span><span class="p">:</span> <span class="kt">View</span> <span class="p">{</span>
    <span class="kd">@StateObject</span> <span class="k">var</span> <span class="nv">viewModel</span> <span class="o">=</span> <span class="kt">SearchViewModel</span><span class="p">()</span>
    <span class="kd">@Environment</span><span class="p">(\</span><span class="o">.</span><span class="n">dismissSearch</span><span class="p">)</span> <span class="k">var</span> <span class="nv">dismissSearch</span>
    <span class="kd">@Environment</span><span class="p">(\</span><span class="o">.</span><span class="n">isSearching</span><span class="p">)</span> <span class="k">var</span> <span class="nv">isSearching</span>

    <span class="k">let</span> <span class="nv">query</span><span class="p">:</span> <span class="kt">String</span>

    <span class="k">var</span> <span class="nv">body</span><span class="p">:</span> <span class="kd">some</span> <span class="kt">View</span> <span class="p">{</span>
        <span class="kt">List</span><span class="p">(</span><span class="n">viewModel</span><span class="o">.</span><span class="n">repos</span><span class="p">)</span> <span class="p">{</span> <span class="n">repo</span> <span class="k">in</span>
            <span class="kt">RepoView</span><span class="p">(</span><span class="nv">repo</span><span class="p">:</span> <span class="n">repo</span><span class="p">)</span>
        <span class="p">}</span><span class="o">.</span><span class="n">overlay</span> <span class="p">{</span>
            <span class="k">if</span> <span class="n">isSearching</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">query</span><span class="o">.</span><span class="n">isEmpty</span> <span class="p">{</span>
                <span class="kt">VStack</span> <span class="p">{</span>
                    <span class="kt">Button</span><span class="p">(</span><span class="s">"Dismiss search"</span><span class="p">)</span> <span class="p">{</span>
                        <span class="nf">dismissSearch</span><span class="p">()</span>
                    <span class="p">}</span>
                    <span class="kt">SearchResultView</span><span class="p">(</span><span class="nv">query</span><span class="p">:</span> <span class="n">query</span><span class="p">)</span>
                        <span class="o">.</span><span class="nf">environmentObject</span><span class="p">(</span><span class="n">viewModel</span><span class="p">)</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>Another search-related environment value we have is <em>dismissSearch</em>. <em>dismissSearch</em> asks the system to dismiss the current search interaction. Remember that both environment values work only in the views surrounded by the <em>searchable</em> modifier.</p>

<blockquote>
  <p>To learn more about environment in SwiftUI, take a look at my <a href="/2019/08/21/the-power-of-environment-in-swiftui/">“The power of Environment in SwiftUI”</a> post.</p>
</blockquote>

<h4 id="suggestions">Suggestions</h4>
<p>Suggestions are a vital part of the excellent search experience, and SwiftUI gives us a very nice API that we can use to provide search suggestions to our users. The <em>searchable</em> view modifier has the optional <em>suggestions</em> parameter, which is a <em>@ViewBuilder</em> closure. Let’s see how we can use it.</p>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">struct</span> <span class="kt">ContentView</span><span class="p">:</span> <span class="kt">View</span> <span class="p">{</span>
    <span class="kd">@StateObject</span> <span class="kd">private</span> <span class="k">var</span> <span class="nv">viewModel</span> <span class="o">=</span> <span class="kt">SearchViewModel</span><span class="p">()</span>
    <span class="kd">@State</span> <span class="kd">private</span> <span class="k">var</span> <span class="nv">query</span> <span class="o">=</span> <span class="s">""</span>

    <span class="k">let</span> <span class="nv">suggestions</span><span class="p">:</span> <span class="p">[</span><span class="kt">String</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s">"Swift"</span><span class="p">,</span> <span class="s">"SwiftUI"</span><span class="p">,</span> <span class="s">"Obj-C"</span>
    <span class="p">]</span>

    <span class="k">var</span> <span class="nv">body</span><span class="p">:</span> <span class="kd">some</span> <span class="kt">View</span> <span class="p">{</span>
        <span class="kt">NavigationView</span> <span class="p">{</span>
            <span class="kt">List</span><span class="p">(</span><span class="n">viewModel</span><span class="o">.</span><span class="n">repos</span><span class="p">)</span> <span class="p">{</span> <span class="n">repo</span> <span class="k">in</span>
                <span class="kt">VStack</span><span class="p">(</span><span class="nv">alignment</span><span class="p">:</span> <span class="o">.</span><span class="n">leading</span><span class="p">)</span> <span class="p">{</span>
                    <span class="kt">Text</span><span class="p">(</span><span class="n">repo</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
                        <span class="o">.</span><span class="nf">font</span><span class="p">(</span><span class="o">.</span><span class="n">headline</span><span class="p">)</span>
                    <span class="kt">Text</span><span class="p">(</span><span class="n">repo</span><span class="o">.</span><span class="n">description</span> <span class="p">??</span> <span class="s">""</span><span class="p">)</span>
                        <span class="o">.</span><span class="nf">foregroundColor</span><span class="p">(</span><span class="o">.</span><span class="n">secondary</span><span class="p">)</span>
                <span class="p">}</span>
            <span class="p">}</span>
            <span class="o">.</span><span class="nf">navigationTitle</span><span class="p">(</span><span class="s">"Search"</span><span class="p">)</span>
            <span class="o">.</span><span class="nf">searchable</span><span class="p">(</span><span class="nv">text</span><span class="p">:</span> <span class="err">$</span><span class="n">query</span><span class="p">)</span> <span class="p">{</span>
                <span class="kt">ForEach</span><span class="p">(</span><span class="n">suggestions</span><span class="p">,</span> <span class="nv">id</span><span class="p">:</span> <span class="p">\</span><span class="o">.</span><span class="k">self</span><span class="p">)</span> <span class="p">{</span> <span class="n">suggestion</span> <span class="k">in</span>
                    <span class="kt">Text</span><span class="p">(</span><span class="n">suggestion</span><span class="p">)</span>
                        <span class="o">.</span><span class="nf">searchCompletion</span><span class="p">(</span><span class="n">suggestion</span><span class="p">)</span>
                <span class="p">}</span>
            <span class="p">}</span>
            <span class="o">.</span><span class="nf">onChange</span><span class="p">(</span><span class="nv">of</span><span class="p">:</span> <span class="n">query</span><span class="p">)</span> <span class="p">{</span> <span class="n">newQuery</span> <span class="k">in</span>
                <span class="n">async</span> <span class="p">{</span> <span class="n">await</span> <span class="n">viewModel</span><span class="o">.</span><span class="nf">search</span><span class="p">(</span><span class="nv">matching</span><span class="p">:</span> <span class="n">query</span><span class="p">)</span> <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p><img src="/public/search1.png" alt="search-suggestions" /></p>

<p>As you can see in the example above, we use the <em>searchable</em> modifier and provide a <em>@ViewBuilder</em> closure with <em>ForEach</em> view that iterates over an array of suggestions. We also use the <em>searchCompletion</em> view modifier to wrap every text view in a button that assigns its value to the search query binding.</p>

<p>Keep in mind that <em>searchCompletion</em> modifier wraps its content in a <em>Button</em>. It means you should apply it to the view that doesn’t have user interaction like <em>Text</em> or <em>Label</em>.</p>

<h4 id="conclusion">Conclusion</h4>
<p>Today we learned how to build a great search experience using the brand new <em>searchable</em> view modifier. It is incredible how easy you can make things like suggestions, the platform adopted placement using the only <em>searchable</em> view modifier. I hope you enjoy the post. Feel free to follow me on <a href="https://twitter.com/mecid">Twitter</a> and ask your questions related to this post. Thanks for reading, and see you next week!</p>

</article>


<aside class="related">
  <h4>Recent posts</h4>
  <ul class="related-posts">
    
      <li>
        <a title="Custom accessibility content in SwiftUI" href="/2021/10/06/custom-accessibility-content-in-swiftui/">
          Custom accessibility content in SwiftUI
          <small><time datetime="2021-10-06T00:00:00+08:00">06 Oct 2021</time></small>
        </a>
      </li>
    
      <li>
        <a title="Audio graphs in SwiftUI" href="/2021/09/29/audio-graphs-in-swiftui/">
          Audio graphs in SwiftUI
          <small><time datetime="2021-09-29T00:00:00+08:00">29 Sep 2021</time></small>
        </a>
      </li>
    
      <li>
        <a title="Accessibility focus in SwiftUI" href="/2021/09/23/accessibility-focus-in-swiftui/">
          Accessibility focus in SwiftUI
          <small><time datetime="2021-09-23T00:00:00+08:00">23 Sep 2021</time></small>
        </a>
      </li>
    
  </ul>
</aside>


      </main>

      <footer class="footer">
          <img class="avatar" alt="mecid" width="100" height="100" data-proofer-ignore="true" src="https://avatars2.githubusercontent.com/mecid?v=3&s=100" srcset="https://avatars2.githubusercontent.com/mecid?v=3&s=100 1x, https://avatars2.githubusercontent.com/mecid?v=3&s=200 2x, https://avatars2.githubusercontent.com/mecid?v=3&s=300 3x, https://avatars2.githubusercontent.com/mecid?v=3&s=400 4x" />
          <small>Hi there! I am code4you,I like to program, and do some App.</small>
          <small>I'm a developer</small>
          <small>Feel free to follow me on <a href="https://github.com/code4you2021">Github</a>.</small>
        <small>
          &copy; <time datetime="2021-10-17T11:25:11+08:00">2021</time>. All rights reserved.
        </small>
      </footer>
    </div>

    
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-1WQVZK1CR7"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-18491817-18');
    </script>
    
  </body>
</html>
